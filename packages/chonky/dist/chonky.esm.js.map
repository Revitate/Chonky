{"version":3,"file":"chonky.esm.js","sources":["../src/util/hooks-helpers.ts","../src/util/logger.ts","../src/util/file-helper.ts","../src/redux/files-transforms.ts","../src/action-definitions/option-ids.ts","../src/types/sort.types.ts","../src/redux/selectors.ts","../src/redux/thunks/file-actions.thunks.ts","../src/redux/thunks/dispatchers.thunks.ts","../src/types/file-view.types.ts","../src/types/icons.types.ts","../src/util/helpers.ts","../src/redux/thunks/index.ts","../src/action-definitions/essential.ts","../src/action-definitions/default.ts","../src/action-definitions/extra.ts","../src/action-definitions/index.ts","../src/redux/state.ts","../src/redux/reducers.ts","../src/redux/watchers.ts","../src/redux/store.ts","../src/components/internal/ChonkyIconPlaceholder.tsx","../src/util/default-config.ts","../src/util/i18n.ts","../src/util/icon-helper.ts","../src/util/styles.ts","../src/util/file-browser-handle.ts","../src/components/internal/ChonkyBusinessLogic.tsx","../src/util/dnd-fallback.ts","../src/components/external/FileContextMenu-hooks.ts","../src/types/dnd.types.ts","../src/components/file-list/DnDFileListDragLayer.tsx","../src/components/internal/HotkeyListener.tsx","../src/components/internal/ChonkyPresentationLayer.tsx","../src/components/external/FileBrowser.tsx","../src/components/external/FileNavbar-hooks.ts","../src/util/dnd.ts","../src/components/external/TextPlaceholder.tsx","../src/components/file-list/FileEntry-hooks.tsx","../src/types/action.types.ts","../src/util/file-actions.ts","../src/components/external/ToolbarButton.tsx","../src/components/external/FolderChainButton.tsx","../src/components/external/FileNavbar.tsx","../src/components/external/ToolbarDropdownButton.tsx","../src/components/external/ToolbarDropdown.tsx","../src/components/external/ToolbarInfo.tsx","../src/components/external/ToolbarSearch.tsx","../src/components/external/FileToolbar.tsx","../src/components/file-list/FileListEmpty.tsx","../src/components/internal/ClickableWrapper-hooks.tsx","../src/components/internal/ClickableWrapper.tsx","../src/components/file-list/FileEntryName.tsx","../src/components/file-list/CompactEntry.tsx","../src/components/file-list/DnDFileEntry.tsx","../src/components/file-list/FileThumbnail.tsx","../src/components/file-list/GridEntryDndIndicator.tsx","../src/components/file-list/GridEntryPreview.tsx","../src/components/file-list/GridEntry.tsx","../src/components/file-list/ListEntry.tsx","../src/components/file-list/FileEntry.tsx","../src/components/file-list/GridContainer.tsx","../src/components/file-list/ListContainer.tsx","../src/components/file-list/FileList.tsx","../src/components/external/FileContextMenu.tsx","../src/components/external/FullFileBrowser.tsx","../src/extensions/file-map.ts"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\nexport const useDebounce = <T>(\r\n    value: T,\r\n    delay: number\r\n): [T, React.Dispatch<React.SetStateAction<T>>] => {\r\n    const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n    useEffect(() => {\r\n        const handler = setTimeout(() => {\r\n            setDebouncedValue(value);\r\n        }, delay);\r\n\r\n        return () => {\r\n            clearTimeout(handler);\r\n        };\r\n    }, [value, delay]);\r\n\r\n    return [debouncedValue, setDebouncedValue];\r\n};\r\n\r\nconst UNINITIALIZED_SENTINEL = {};\r\nexport const useStaticValue = <T>(factory: () => T): T => {\r\n    const valueRef = useRef<T>(UNINITIALIZED_SENTINEL as T);\r\n    if (valueRef.current === UNINITIALIZED_SENTINEL) valueRef.current = factory();\r\n    return valueRef.current;\r\n};\r\n\r\nexport const useInstanceVariable = <T>(value: T) => {\r\n    const ref = useRef(value);\r\n    useEffect(() => {\r\n        ref.current = value;\r\n    }, [ref, value]);\r\n    return ref;\r\n};\r\n","export class Logger {\r\n    public static error(...args: any[]): void {\r\n        // eslint-disable-next-line no-console\r\n        console.error('[Chonky runtime error]', ...args);\r\n    }\r\n\r\n    public static warn(...args: any[]): void {\r\n        // eslint-disable-next-line no-console\r\n        console.warn('[Chonky runtime warning]', ...args);\r\n    }\r\n\r\n    public static debug(...args: any[]): void {\r\n        // eslint-disable-next-line no-console\r\n        console.debug('[Chonky runtime debug]', ...args);\r\n    }\r\n\r\n    public static formatBullets(bullets: string[]): string {\r\n        return `\\n- ${bullets.join('\\n- ')}`;\r\n    }\r\n}\r\n","import { Nullable } from 'tsdef';\r\n\r\nimport { FileData } from '../types/file.types';\r\nimport { Logger } from './logger';\r\n\r\nexport class FileHelper {\r\n    public static isDirectory(file: Nullable<FileData>): file is FileData {\r\n        // Not a directory by default\r\n        return !!file && file.isDir === true;\r\n    }\r\n\r\n    public static isHidden(file: Nullable<FileData>): file is FileData {\r\n        // Not hidden by default\r\n        return !!file && file.isHidden === true;\r\n    }\r\n\r\n    public static isSymlink(file: Nullable<FileData>): file is FileData {\r\n        // Not a symlink by default\r\n        return !!file && file.isSymlink === true;\r\n    }\r\n\r\n    public static isEncrypted(file: Nullable<FileData>): file is FileData {\r\n        // Not encrypted by default\r\n        return !!file && file.isEncrypted === true;\r\n    }\r\n\r\n    public static isClickable(file: Nullable<FileData>): file is FileData {\r\n        // Clickable by default\r\n        return !!file;\r\n    }\r\n\r\n    public static isOpenable(file: Nullable<FileData>): file is FileData {\r\n        // Openable by default\r\n        return !!file && file.openable !== false;\r\n    }\r\n\r\n    public static isSelectable(file: Nullable<FileData>): file is FileData {\r\n        // Selectable by default\r\n        return !!file && file.selectable !== false;\r\n    }\r\n\r\n    public static isDraggable(file: Nullable<FileData>): file is FileData {\r\n        // File & folders are draggable by default, `null` is not\r\n        return !!file && file.draggable !== false;\r\n    }\r\n\r\n    public static isDroppable(file: Nullable<FileData>): file is FileData {\r\n        // Folders are droppable by default, files are not\r\n        if (!file) return false;\r\n        if (file.isDir && file.droppable !== false) return true;\r\n        return file.droppable === true;\r\n    }\r\n\r\n    public static isDndOpenable(file: Nullable<FileData>): file is FileData {\r\n        // Folders are DnD openable by default, files are not\r\n        if (!FileHelper.isOpenable(file)) return false;\r\n        if (file.isDir && file.dndOpenable !== false) return true;\r\n        return file.dndOpenable === true;\r\n    }\r\n\r\n    public static getModDate(file: Nullable<FileData>): Nullable<Date> {\r\n        if (!file || file.modDate === null || file.modDate === undefined) return null;\r\n        return FileHelper.parseDate(file.modDate);\r\n    }\r\n\r\n    public static parseDate(maybeDate: Date | string | any): Nullable<Date> {\r\n        if (typeof maybeDate === 'string' || typeof maybeDate === 'number') {\r\n            // We allow users to provide string and numerical representations of dates.\r\n            try {\r\n                return new Date(maybeDate);\r\n            } catch (error) {\r\n                Logger.error(\r\n                    `Could not convert provided string/number into a date: ${error.message} `,\r\n                    'Invalid value:',\r\n                    maybeDate\r\n                );\r\n            }\r\n        }\r\n        if (maybeDate instanceof Date && !isNaN(maybeDate.getTime())) {\r\n            // We only allow valid dates objects\r\n            return maybeDate;\r\n        }\r\n\r\n        // If we have an invalid date representation, we just return null.\r\n        Logger.warn('Unsupported date representation:', maybeDate);\r\n        return null;\r\n    }\r\n\r\n    public static getChildrenCount(file: Nullable<FileData>): Nullable<number> {\r\n        if (!file || typeof file.childrenCount !== 'number') return null;\r\n\r\n        return file.childrenCount;\r\n    }\r\n}\r\n","import { Nullable } from 'tsdef';\r\n\r\nimport { FileAction } from '../types/action.types';\r\nimport { FileArray } from '../types/file.types';\r\nimport { Logger } from '../util/logger';\r\n\r\ninterface SanitizeFiles {\r\n    (mode: 'files', rawArray: FileArray | any): {\r\n        sanitizedArray: FileArray;\r\n        errorMessages: string[];\r\n    };\r\n    (mode: 'folderChain', rawArray: Nullable<FileArray> | any): {\r\n        sanitizedArray: FileArray;\r\n        errorMessages: string[];\r\n    };\r\n    (mode: 'fileActions', rawArray: FileAction[] | any): {\r\n        sanitizedArray: FileAction[];\r\n        errorMessages: string[];\r\n    };\r\n}\r\n\r\nexport const sanitizeInputArray: SanitizeFiles = (mode: string, rawArray: any[]) => {\r\n    const sanitizedFiles = [];\r\n    const errorMessages: string[] = [];\r\n\r\n    if ((mode === 'folderChain' || mode === 'fileActions') && !rawArray) {\r\n        // Do nothing, we allow folder chain to be null.\r\n    } else if (!Array.isArray(rawArray)) {\r\n        errorMessages.push(\r\n            `Expected \"${mode}\" prop to be an array, got \"${typeof rawArray}\" instead.`\r\n        );\r\n    } else {\r\n        let nonObjectFileCount = 0;\r\n        let missingFieldFileCount = 0;\r\n        const seenIds = new Set<string>();\r\n        const duplicateIds = new Set<string>();\r\n\r\n        for (let i = 0; i < rawArray.length; ++i) {\r\n            const item = rawArray[i];\r\n            if (!item) {\r\n                if (mode === 'fileActions') nonObjectFileCount++;\r\n                else sanitizedFiles.push(null);\r\n            } else if (typeof item !== 'object') {\r\n                nonObjectFileCount++;\r\n            } else {\r\n                if (!item.id || (mode !== 'fileActions' && !item.name)) {\r\n                    missingFieldFileCount++;\r\n                } else if (seenIds.has(item.id)) {\r\n                    duplicateIds.add(item.id);\r\n                } else {\r\n                    seenIds.add(item.id);\r\n                    sanitizedFiles.push(item);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (nonObjectFileCount) {\r\n            errorMessages.push(\r\n                `Detected ${nonObjectFileCount} file(s) of invalid type. Remember ` +\r\n                    `that \"files\" array should contain either objects or nulls.`\r\n            );\r\n        }\r\n        if (missingFieldFileCount) {\r\n            errorMessages.push(\r\n                `Detected ${missingFieldFileCount} file(s) that are missing the ` +\r\n                    `required fields. Remember that file object should define an ` +\r\n                    `\"id\" and a \"name\".`\r\n            );\r\n        }\r\n        if (duplicateIds.size > 0) {\r\n            const repeatedIdsString = '\"' + Array.from(duplicateIds).join('\", \"') + '\"';\r\n            errorMessages.push(\r\n                `Detected ${duplicateIds.size} file IDs that are used multiple ` +\r\n                    `times. Remember that each file should have a unique IDs. The ` +\r\n                    `following IDs were seen multiple times: ${repeatedIdsString}`\r\n            );\r\n        }\r\n    }\r\n\r\n    if (errorMessages.length > 0) {\r\n        const errorMessageString = '\\n- ' + errorMessages.join('\\n- ');\r\n        let arrayString: string;\r\n        let itemString: string;\r\n        if (mode === 'folderChain') {\r\n            arrayString = 'folder chain';\r\n            itemString = 'files';\r\n        } else if (mode === 'fileActions') {\r\n            arrayString = 'file actions';\r\n            itemString = 'file actions';\r\n        } else {\r\n            // mode === 'files'\r\n            arrayString = 'files';\r\n            itemString = 'files';\r\n        }\r\n\r\n        Logger.error(\r\n            `Errors were detected when sanitizing the ${arrayString} array. ` +\r\n                `Offending ${itemString} were removed from the array. Summary of ` +\r\n                `validation errors: ${errorMessageString}`\r\n        );\r\n    }\r\n\r\n    return {\r\n        sanitizedArray: sanitizedFiles,\r\n        errorMessages,\r\n    };\r\n};\r\n","/**\r\n * We have option IDs in a separate file to avoid circular deps...\r\n */\r\nexport const OptionIds = {\r\n    ShowHiddenFiles: 'show_hidden_files',\r\n    ShowFoldersFirst: 'show_folders_first',\r\n    DarkMode: 'dark_mode',\r\n};\r\n","import { Nullable } from 'tsdef';\r\n\r\nimport { FileData } from './file.types';\r\n\r\nexport type FileSortKeySelector = (file: Nullable<FileData>) => any;\r\n\r\nexport enum SortOrder {\r\n    ASC = 'asc',\r\n    DESC = 'desc',\r\n}\r\n","import sort from 'fast-sort';\r\nimport FuzzySearch from 'fuzzy-search';\r\nimport { Nilable, Nullable } from 'tsdef';\r\n\r\nimport { createSelector } from '@reduxjs/toolkit';\r\n\r\nimport { OptionIds } from '../action-definitions/option-ids';\r\nimport { FileArray, FileData, FileFilter } from '../types/file.types';\r\nimport { RootState } from '../types/redux.types';\r\nimport { FileSortKeySelector, SortOrder } from '../types/sort.types';\r\nimport { FileHelper } from '../util/file-helper';\r\n\r\n// Raw selectors\r\nexport const selectInstanceId = (state: RootState) => state.instanceId;\r\nexport const selectExternalFileActionHandler = (state: RootState) => state.externalFileActionHandler;\r\n\r\nexport const selectFileActionMap = (state: RootState) => state.fileActionMap;\r\nexport const selectFileActionIds = (state: RootState) => state.fileActionIds;\r\nexport const selectFileActionData = (fileActionId: string) => (state: RootState) =>\r\n    selectFileActionMap(state)[fileActionId];\r\nexport const selectToolbarItems = (state: RootState) => state.toolbarItems;\r\nexport const selectContextMenuItems = (state: RootState) => state.contextMenuItems;\r\n\r\nexport const selectFolderChain = (state: RootState) => state.folderChain;\r\nexport const selectCurrentFolder = (state: RootState) => {\r\n    const folderChain = selectFolderChain(state);\r\n    const currentFolder = folderChain.length > 0 ? folderChain[folderChain.length - 1] : null;\r\n    return currentFolder;\r\n};\r\nexport const selectParentFolder = (state: RootState) => {\r\n    const folderChain = selectFolderChain(state);\r\n    const parentFolder = folderChain.length > 1 ? folderChain[folderChain.length - 2] : null;\r\n    return parentFolder;\r\n};\r\n\r\nexport const selectRawFiles = (state: RootState) => state.rawFiles;\r\nexport const selectFileMap = (state: RootState) => state.fileMap;\r\nexport const selectCleanFileIds = (state: RootState) => state.cleanFileIds;\r\nexport const selectFileData = (fileId: Nullable<string>) => (state: RootState) =>\r\n    fileId ? selectFileMap(state)[fileId] : null;\r\n\r\nexport const selectHiddenFileIdMap = (state: RootState) => state.hiddenFileIdMap;\r\nexport const selectHiddenFileCount = (state: RootState) => Object.keys(selectHiddenFileIdMap(state)).length;\r\n\r\nexport const selectFocusSearchInput = (state: RootState) => state.focusSearchInput;\r\nexport const selectSearchString = (state: RootState) => state.searchString;\r\n\r\nexport const selectSelectionMap = (state: RootState) => state.selectionMap;\r\nexport const selectSelectedFileIds = (state: RootState) => Object.keys(selectSelectionMap(state));\r\nexport const selectSelectionSize = (state: RootState) => selectSelectedFileIds(state).length;\r\nexport const selectIsFileSelected = (fileId: Nullable<string>) => (state: RootState) =>\r\n    !!fileId && !!selectSelectionMap(state)[fileId];\r\nexport const selectSelectedFiles = (state: RootState) => {\r\n    const fileMap = selectFileMap(state);\r\n    return Object.keys(selectSelectionMap(state)).map(id => fileMap[id]);\r\n};\r\nexport const selectSelectedFilesForAction = (fileActionId: string) => (state: RootState) => {\r\n    const { fileActionMap } = state;\r\n    const action = fileActionMap[fileActionId];\r\n    if (!action || !action.requiresSelection) return undefined;\r\n\r\n    return getSelectedFiles(state, action.fileFilter);\r\n};\r\nexport const selectSelectedFilesForActionCount = (fileActionId: string) => (state: RootState) =>\r\n    getSelectedFilesForAction(state, fileActionId)?.length;\r\nexport const selectDisableSelection = (state: RootState) => state.disableSelection;\r\n\r\nexport const selectFileViewConfig = (state: RootState) => state.fileViewConfig;\r\n\r\nexport const selectSortActionId = (state: RootState) => state.sortActionId;\r\nexport const selectSortOrder = (state: RootState) => state.sortOrder;\r\n\r\nexport const selectOptionMap = (state: RootState) => state.optionMap;\r\nexport const selectOptionValue = (optionId: string) => (state: RootState) => selectOptionMap(state)[optionId];\r\n\r\nexport const selectThumbnailGenerator = (state: RootState) => state.thumbnailGenerator;\r\nexport const selectDoubleClickDelay = (state: RootState) => state.doubleClickDelay;\r\nexport const selectIsDnDDisabled = (state: RootState) => state.disableDragAndDrop;\r\nexport const selectClearSelectionOnOutsideClick = (state: RootState) => state.clearSelectionOnOutsideClick;\r\n\r\nexport const selectContextMenuMounted = (state: RootState) => state.contextMenuMounted;\r\nexport const selectContextMenuConfig = (state: RootState) => state.contextMenuConfig;\r\nexport const selectContextMenuTriggerFile = (state: RootState) => {\r\n    const config = selectContextMenuConfig(state);\r\n    if (!config || !config.triggerFileId) return null;\r\n    const fileMap = selectFileMap(state);\r\n    return fileMap[config.triggerFileId] ?? null;\r\n};\r\n\r\n// Raw selectors\r\nconst getFileActionMap = (state: RootState) => state.fileActionMap;\r\nconst getOptionMap = (state: RootState) => state.optionMap;\r\nconst getFileMap = (state: RootState) => state.fileMap;\r\nconst getFileIds = (state: RootState) => state.fileIds;\r\nconst getCleanFileIds = (state: RootState) => state.cleanFileIds;\r\nconst getSortActionId = (state: RootState) => state.sortActionId;\r\nconst getSortOrder = (state: RootState) => state.sortOrder;\r\nconst getSearchString = (state: RootState) => state.searchString;\r\nconst _getLastClick = (state: RootState) => state.lastClick;\r\n\r\n// Memoized selectors\r\nconst makeGetAction = (fileActionSelector: (state: RootState) => Nullable<string>) =>\r\n    createSelector([getFileActionMap, fileActionSelector], (fileActionMap, fileActionId) =>\r\n        fileActionId && fileActionMap[fileActionId] ? fileActionMap[fileActionId] : null\r\n    );\r\nconst makeGetOptionValue = (optionId: string, defaultValue: any = undefined) =>\r\n    createSelector([getOptionMap], optionMap => {\r\n        const value = optionMap[optionId];\r\n        if (value === undefined) {\r\n            return defaultValue;\r\n        }\r\n        return value;\r\n    });\r\nconst makeGetFiles = (fileIdsSelector: (state: RootState) => Nullable<string>[]) =>\r\n    createSelector(\r\n        [getFileMap, fileIdsSelector],\r\n        (fileMap, fileIds): FileArray => fileIds.map(fileId => (fileId && fileMap[fileId] ? fileMap[fileId] : null))\r\n    );\r\nconst getSortedFileIds = createSelector(\r\n    [\r\n        getFileIds,\r\n        getSortOrder,\r\n        makeGetFiles(getFileIds),\r\n        makeGetAction(getSortActionId),\r\n        makeGetOptionValue(OptionIds.ShowFoldersFirst, false),\r\n    ],\r\n    (fileIds, sortOrder, files, sortAction, showFolderFirst) => {\r\n        if (!sortAction) {\r\n            // We allow users to set the sort action ID to `null` if they want to use their\r\n            // own sorting mechanisms instead of relying on Chonky built-in sort.\r\n            return fileIds;\r\n        }\r\n\r\n        const prepareSortKeySelector = (selector: FileSortKeySelector) => (file: Nullable<FileData>) => selector(file);\r\n\r\n        const sortFunctions: {\r\n            asc?: (file: FileData) => any;\r\n            desc?: (file: FileData) => any;\r\n        }[] = [];\r\n\r\n        if (showFolderFirst) {\r\n            // If option is undefined (relevant actions is not enabled), we don't show\r\n            // folders first.\r\n            sortFunctions.push({\r\n                desc: prepareSortKeySelector(FileHelper.isDirectory),\r\n            });\r\n        }\r\n        if (sortAction.sortKeySelector) {\r\n            const configKeyName = sortOrder === SortOrder.ASC ? 'asc' : 'desc';\r\n            sortFunctions.push({\r\n                [configKeyName]: prepareSortKeySelector(sortAction.sortKeySelector),\r\n            });\r\n        }\r\n        if (sortFunctions.length === 0) return fileIds;\r\n\r\n        // We copy the array because `fast-sort` mutates it\r\n        const sortedFileIds = sort([...files])\r\n            .by(sortFunctions as any)\r\n            .map(file => (file ? file.id : null));\r\n        return sortedFileIds;\r\n    }\r\n);\r\nconst getSearcher = createSelector(\r\n    [makeGetFiles(getCleanFileIds)],\r\n    cleanFiles => new FuzzySearch(cleanFiles as FileData[], ['name'], { caseSensitive: false })\r\n);\r\nconst getSearchFilteredFileIds = createSelector(\r\n    [getCleanFileIds, getSearchString, getSearcher],\r\n    (cleanFileIds, searchString, searcher) =>\r\n        searchString ? searcher.search(searchString).map(f => f.id) : cleanFileIds\r\n);\r\nconst getHiddenFileIdMap = createSelector(\r\n    [getSearchFilteredFileIds, makeGetFiles(getCleanFileIds), makeGetOptionValue(OptionIds.ShowHiddenFiles)],\r\n    (searchFilteredFileIds, cleanFiles, showHiddenFiles) => {\r\n        const searchFilteredFileIdsSet = new Set(searchFilteredFileIds);\r\n        const hiddenFileIdMap: any = {};\r\n        cleanFiles.forEach(file => {\r\n            if (!file) return;\r\n            else if (!searchFilteredFileIdsSet.has(file.id)) {\r\n                // Hidden by seach\r\n                hiddenFileIdMap[file.id] = true;\r\n            } else if (!showHiddenFiles && FileHelper.isHidden(file)) {\r\n                // Hidden by options\r\n                hiddenFileIdMap[file.id] = true;\r\n            }\r\n        });\r\n        return hiddenFileIdMap;\r\n    }\r\n);\r\nconst getDisplayFileIds = createSelector(\r\n    [getSortedFileIds, getHiddenFileIdMap],\r\n    /** Returns files that will actually be shown to the user. */\r\n    (sortedFileIds, hiddenFileIdMap) => sortedFileIds.filter(id => !id || !hiddenFileIdMap[id])\r\n);\r\nconst getLastClickIndex = createSelector(\r\n    [_getLastClick, getSortedFileIds],\r\n    /** Returns the last click index after ensuring it is actually still valid. */\r\n    (lastClick, displayFileIds) => {\r\n        if (\r\n            !lastClick ||\r\n            lastClick.index > displayFileIds.length - 1 ||\r\n            lastClick.fileId != displayFileIds[lastClick.index]\r\n        ) {\r\n            return null;\r\n        }\r\n        return lastClick.index;\r\n    }\r\n);\r\n\r\nexport const selectors = {\r\n    // Raw selectors\r\n    getFileActionMap,\r\n    getOptionMap,\r\n    getFileMap,\r\n    getFileIds,\r\n    getCleanFileIds,\r\n    getSortActionId,\r\n    getSortOrder,\r\n    getSearchString,\r\n    _getLastClick,\r\n\r\n    // Memoized selectors\r\n    getSortedFileIds,\r\n    getSearcher,\r\n    getSearchFilteredFileIds,\r\n    getHiddenFileIdMap,\r\n    getDisplayFileIds,\r\n    getLastClickIndex,\r\n\r\n    // Parametrized selectors\r\n    makeGetAction,\r\n    makeGetOptionValue,\r\n    makeGetFiles,\r\n};\r\n\r\n// Selectors meant to be used outside of Redux code\r\nexport const getFileData = (state: RootState, fileId: Nullable<string>) =>\r\n    fileId ? selectFileMap(state)[fileId] : null;\r\nexport const getIsFileSelected = (state: RootState, file: FileData) => {\r\n    // !!! We deliberately don't use `FileHelper.isSelectable` here as we want to\r\n    //     reflect the state of Redux store accurately.\r\n    return !!selectSelectionMap(state)[file.id];\r\n};\r\nexport const getSelectedFiles = (state: RootState, ...filters: Nilable<FileFilter>[]) => {\r\n    const { fileMap, selectionMap } = state;\r\n\r\n    const selectedFiles = Object.keys(selectionMap).map(id => fileMap[id]);\r\n    const filteredSelectedFiles = filters.reduce(\r\n        (prevFiles, filter) => (filter ? prevFiles.filter(filter) : prevFiles),\r\n        selectedFiles\r\n    );\r\n    return filteredSelectedFiles;\r\n};\r\nexport const getSelectedFilesForAction = (state: RootState, fileActionId: string) =>\r\n    selectSelectedFilesForAction(fileActionId)(state);\r\n","import { Nilable } from 'tsdef';\r\n\r\nimport { ChonkyActions, DefaultFileActions, EssentialFileActions } from '../../action-definitions/index';\r\nimport { FileActionGroup, FileActionMenuItem } from '../../types/action-menus.types';\r\nimport { FileAction } from '../../types/action.types';\r\nimport { ChonkyThunk } from '../../types/redux.types';\r\nimport { SortOrder } from '../../types/sort.types';\r\nimport { sanitizeInputArray } from '../files-transforms';\r\nimport { reduxActions } from '../reducers';\r\nimport { selectCleanFileIds, selectFileMap, selectHiddenFileIdMap, selectSelectionMap } from '../selectors';\r\n\r\n/**\r\n * Merges multiple file action arrays into one while removing duplicates\r\n */\r\nconst mergeFileActionsArrays = (...fileActionArrays: FileAction[][]): FileAction[] => {\r\n    const seenActionIds = new Set<string>();\r\n    const addToSeen = (a: FileAction) => !!seenActionIds.add(a.id);\r\n    const wasNotSeen = (a: FileAction) => !seenActionIds.has(a.id);\r\n\r\n    const duplicateFreeArrays = fileActionArrays.map(arr => {\r\n        const duplicateFreeArray = arr.filter(wasNotSeen);\r\n        duplicateFreeArray.map(addToSeen);\r\n        return duplicateFreeArray;\r\n    });\r\n    return new Array<FileAction>().concat(...duplicateFreeArrays);\r\n};\r\n\r\nexport const thunkUpdateRawFileActions = (\r\n    rawFileActions: FileAction[] | any,\r\n    disableDefaultFileActions: Nilable<boolean | string[]>\r\n): ChonkyThunk => dispatch => {\r\n    const { sanitizedArray, errorMessages } = sanitizeInputArray('fileActions', rawFileActions);\r\n\r\n    // Add default actions unless user disabled them\r\n    let defaultActionsToAdd: FileAction[];\r\n    if (Array.isArray(disableDefaultFileActions)) {\r\n        const disabledActionIds = new Set(disableDefaultFileActions);\r\n        defaultActionsToAdd = DefaultFileActions.filter(action => !disabledActionIds.has(action.id));\r\n    } else if (disableDefaultFileActions) {\r\n        defaultActionsToAdd = [];\r\n    } else {\r\n        defaultActionsToAdd = DefaultFileActions;\r\n    }\r\n\r\n    const fileActions = mergeFileActionsArrays(sanitizedArray, EssentialFileActions, defaultActionsToAdd);\r\n    const optionDefaults: any = {};\r\n    fileActions.map(a => (a.option ? (optionDefaults[a.option.id] = a.option.defaultValue) : null));\r\n\r\n    dispatch(reduxActions.setRawFileActions(rawFileActions));\r\n    dispatch(reduxActions.setFileActionsErrorMessages(errorMessages));\r\n    dispatch(reduxActions.setFileActions(fileActions));\r\n    dispatch(reduxActions.setOptionDefaults(optionDefaults));\r\n    dispatch(thunkUpdateToolbarNContextMenuItems(fileActions));\r\n};\r\n\r\nexport const thunkUpdateToolbarNContextMenuItems = (fileActions: FileAction[]): ChonkyThunk => dispatch => {\r\n    const excludedToolbarFileActionIds = new Set<string>([\r\n        // TODO: Move decision to exclude actions somewhere else, as users' custom\r\n        //  components might not give these actions special treatment like Chonky does.\r\n        ChonkyActions.OpenParentFolder.id,\r\n    ]);\r\n\r\n    type SeenGroupMap = { [groupName: string]: FileActionGroup };\r\n\r\n    const toolbarItems: FileActionMenuItem[] = [];\r\n    const seenToolbarGroups: SeenGroupMap = {};\r\n\r\n    const contextMenuItems: FileActionMenuItem[] = [];\r\n    const seenContextMenuGroups: SeenGroupMap = {};\r\n\r\n    const getGroup = (itemArray: FileActionMenuItem[], seenMap: SeenGroupMap, groupName: string): FileActionGroup => {\r\n        if (seenMap[groupName]) return seenMap[groupName];\r\n        const group: FileActionGroup = { name: groupName, fileActionIds: [] };\r\n        itemArray.push(group);\r\n        seenMap[groupName] = group;\r\n        return group;\r\n    };\r\n\r\n    for (const action of fileActions) {\r\n        const button = action.button;\r\n        if (!button) continue;\r\n\r\n        if (button.toolbar && !excludedToolbarFileActionIds.has(action.id)) {\r\n            if (button.group) {\r\n                const group = getGroup(toolbarItems, seenToolbarGroups, button.group);\r\n                group.fileActionIds.push(action.id);\r\n            } else {\r\n                toolbarItems.push(action.id);\r\n            }\r\n        }\r\n\r\n        if (button.contextMenu) {\r\n            if (button.group) {\r\n                const group = getGroup(contextMenuItems, seenContextMenuGroups, button.group);\r\n                group.fileActionIds.push(action.id);\r\n            } else {\r\n                contextMenuItems.push(action.id);\r\n            }\r\n        }\r\n    }\r\n\r\n    dispatch(reduxActions.updateFileActionMenuItems([toolbarItems, contextMenuItems]));\r\n};\r\n\r\nexport const thunkUpdateDefaultFileViewActionId = (fileActionId: Nilable<string>): ChonkyThunk => (\r\n    dispatch,\r\n    getState\r\n) => {\r\n    const { fileActionMap } = getState();\r\n    const action = fileActionId ? fileActionMap[fileActionId] : null;\r\n    if (action && action.fileViewConfig) {\r\n        dispatch(reduxActions.setFileViewConfig(action.fileViewConfig));\r\n    }\r\n};\r\n\r\nexport const thunkActivateSortAction = (fileActionId: Nilable<string>): ChonkyThunk => (dispatch, getState) => {\r\n    if (!fileActionId) return;\r\n\r\n    const { sortActionId: oldActionId, sortOrder: oldOrder, fileActionMap } = getState();\r\n    const action = fileActionMap[fileActionId];\r\n    if (!action || !action.sortKeySelector) return;\r\n\r\n    let order = oldOrder === SortOrder.ASC ? SortOrder.DESC : SortOrder.ASC;\r\n    if (oldActionId !== fileActionId) {\r\n        order = SortOrder.ASC;\r\n    }\r\n\r\n    dispatch(reduxActions.setSort({ actionId: fileActionId, order: order }));\r\n};\r\n\r\nexport const thunkApplySelectionTransform = (action: FileAction): ChonkyThunk => (dispatch, getState) => {\r\n    const selectionTransform = action.selectionTransform;\r\n    if (!selectionTransform) return;\r\n\r\n    const state = getState();\r\n    const prevSelection = new Set<string>(Object.keys(selectSelectionMap(state)));\r\n    const hiddenFileIds = new Set<string>(Object.keys(selectHiddenFileIdMap(state)));\r\n\r\n    const newSelection = selectionTransform({\r\n        prevSelection,\r\n        fileIds: selectCleanFileIds(state),\r\n        fileMap: selectFileMap(state),\r\n        hiddenFileIds,\r\n    });\r\n    if (!newSelection) return;\r\n\r\n    if (newSelection.size === 0) {\r\n        dispatch(reduxActions.clearSelection());\r\n    } else {\r\n        dispatch(reduxActions.selectFiles({ fileIds: Array.from(newSelection), reset: true }));\r\n    }\r\n};\r\n","import { MaybePromise, Undefinable } from 'tsdef';\r\n\r\nimport { FileActionData, FileActionState } from '../../types/action-handler.types';\r\nimport { FileAction } from '../../types/action.types';\r\nimport { ChonkyDispatch, ChonkyThunk } from '../../types/redux.types';\r\nimport { Logger } from '../../util/logger';\r\nimport { reduxActions } from '../reducers';\r\nimport {\r\n    selectContextMenuTriggerFile, selectExternalFileActionHandler, selectFileActionMap,\r\n    selectInstanceId, selectSelectedFiles\r\n} from '../selectors';\r\nimport { thunkActivateSortAction, thunkApplySelectionTransform } from './file-actions.thunks';\r\n\r\n/**\r\n * Thunk that dispatches actions to the external (user-provided) action handler.\r\n */\r\nexport const thunkDispatchFileAction = (data: FileActionData<FileAction>): ChonkyThunk => (_dispatch, getState) => {\r\n    Logger.debug(`FILE ACTION DISPATCH: [${data.id}]`, 'data:', data);\r\n    const state = getState();\r\n    const action = selectFileActionMap(state)[data.id];\r\n    const externalFileActionHandler = selectExternalFileActionHandler(state);\r\n    if (action) {\r\n        if (externalFileActionHandler) {\r\n            Promise.resolve(externalFileActionHandler(data)).catch(error =>\r\n                Logger.error(`User-defined file action handler threw an error: ${error.message}`)\r\n            );\r\n        }\r\n    } else {\r\n        Logger.warn(\r\n            `Internal components dispatched the \"${data.id}\" file action, but such ` + `action was not registered.`\r\n        );\r\n    }\r\n};\r\n\r\n/**\r\n * Thunk that is used by internal components (and potentially the user) to \"request\"\r\n * actions. When action is requested, Chonky \"prepares\" the action data by extracting it\r\n * from Redux state. Once action data is ready, Chonky executes some side effect and/or\r\n * dispatches the action to the external action handler.\r\n */\r\nexport const thunkRequestFileAction = <Action extends FileAction>(\r\n    action: Action,\r\n    payload: Action['__payloadType']\r\n): ChonkyThunk => (dispatch, getState) => {\r\n    Logger.debug(`FILE ACTION REQUEST: [${action.id}]`, 'action:', action, 'payload:', payload);\r\n    const state = getState();\r\n    const instanceId = selectInstanceId(state);\r\n\r\n    if (!selectFileActionMap(state)[action.id]) {\r\n        Logger.warn(\r\n            `The action \"${action.id}\" was requested, but it is not registered. The ` +\r\n                `action will still be dispatched, but this might indicate a bug in ` +\r\n                `the code. Please register your actions by passing them to ` +\r\n                `\"fileActions\" prop.`\r\n        );\r\n    }\r\n\r\n    // Determine files for the action if action requires selection\r\n    const selectedFiles = selectSelectedFiles(state);\r\n    const selectedFilesForAction = action.fileFilter ? selectedFiles.filter(action.fileFilter) : selectedFiles;\r\n    if (action.requiresSelection && selectedFilesForAction.length === 0) {\r\n        Logger.warn(\r\n            `Internal components requested the \"${action.id}\" file ` +\r\n                `action, but the selection for this action was empty. This ` +\r\n                `might a bug in the code of the presentational components.`\r\n        );\r\n        return;\r\n    }\r\n\r\n    const contextMenuTriggerFile = selectContextMenuTriggerFile(state);\r\n    const actionState: FileActionState<{}> = {\r\n        instanceId,\r\n        selectedFiles,\r\n        selectedFilesForAction,\r\n        contextMenuTriggerFile,\r\n    };\r\n\r\n    // === Update sort state if necessary\r\n    const sortKeySelector = action.sortKeySelector;\r\n    if (sortKeySelector) dispatch(thunkActivateSortAction(action.id));\r\n\r\n    // === Update file view state if necessary\r\n    const fileViewConfig = action.fileViewConfig;\r\n    if (fileViewConfig) dispatch(reduxActions.setFileViewConfig(fileViewConfig));\r\n\r\n    // === Update option state if necessary\r\n    const option = action.option;\r\n    if (option) dispatch(reduxActions.toggleOption(option.id));\r\n\r\n    // === Apply selection transform if necessary\r\n    const selectionTransform = action.selectionTransform;\r\n    if (selectionTransform) dispatch(thunkApplySelectionTransform(action));\r\n\r\n    // Apply the effect\r\n    const effect = action.effect;\r\n    let maybeEffectPromise: MaybePromise<boolean | undefined> = undefined;\r\n    if (effect) {\r\n        try {\r\n            maybeEffectPromise = effect({\r\n                action,\r\n                payload,\r\n                state: actionState,\r\n                reduxDispatch: dispatch,\r\n                getReduxState: getState,\r\n            }) as MaybePromise<boolean | undefined>;\r\n        } catch (error) {\r\n            Logger.error(`User-defined effect function for action ${action.id} threw an ` + `error: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    // Dispatch the action to user code. Deliberately call it after all other\r\n    // operations are over.\r\n    return Promise.resolve(maybeEffectPromise)\r\n        .then(effectResult => {\r\n            const data: FileActionData<Action> = {\r\n                id: action.id,\r\n                action,\r\n                payload,\r\n                state: actionState,\r\n            };\r\n            triggerDispatchAfterEffect(dispatch, data, effectResult);\r\n        })\r\n        .catch(error => {\r\n            Logger.error(\r\n                `User-defined effect function for action ${action.id} returned a ` +\r\n                    `promise that was rejected: ${error.message}`\r\n            );\r\n            const data: FileActionData<Action> = {\r\n                id: action.id,\r\n                action,\r\n                payload,\r\n                state: actionState,\r\n            };\r\n            triggerDispatchAfterEffect(dispatch, data, undefined);\r\n        });\r\n};\r\n\r\nexport const triggerDispatchAfterEffect = <Action extends FileAction>(\r\n    dispatch: ChonkyDispatch,\r\n    data: FileActionData<Action>,\r\n    effectResult: Undefinable<boolean>\r\n) => {\r\n    const preventDispatch = effectResult === true;\r\n    if (!preventDispatch) dispatch(thunkDispatchFileAction(data));\r\n};\r\n","export enum FileViewMode {\r\n    List = 'list',\r\n    Compact = 'compact',\r\n    Grid = 'grid',\r\n}\r\n\r\nexport type FileViewConfigList = {\r\n    mode: FileViewMode.List;\r\n    entryHeight: number;\r\n};\r\n\r\nexport type FileViewConfigGrid = {\r\n    mode: FileViewMode.Compact | FileViewMode.Grid;\r\n    entryWidth: number;\r\n    entryHeight: number;\r\n};\r\n\r\nexport type FileViewConfig = FileViewConfigList | FileViewConfigGrid;\r\n","import React from 'react';\r\n\r\nexport enum ChonkyIconName {\r\n    // Misc\r\n    loading = 'loading',\r\n    dropdown = 'dropdown',\r\n    placeholder = 'placeholder',\r\n\r\n    // File Actions: Drag & drop\r\n    dndDragging = 'dndDragging',\r\n    dndCanDrop = 'dndCanDrop',\r\n    dndCannotDrop = 'dndCannotDrop',\r\n\r\n    // File Actions: File operations\r\n    openFiles = 'openFiles',\r\n    openParentFolder = 'openParentFolder',\r\n    copy = 'copy',\r\n    paste = 'paste',\r\n    share = 'share',\r\n    search = 'search',\r\n    selectAllFiles = 'selectAllFiles',\r\n    clearSelection = 'clearSelection',\r\n\r\n    // File Actions: Sorting & options\r\n    sortAsc = 'sortAsc',\r\n    sortDesc = 'sortDesc',\r\n    toggleOn = 'toggleOn',\r\n    toggleOff = 'toggleOff',\r\n\r\n    // File Actions: File Views\r\n    list = 'list',\r\n    compact = 'compact',\r\n    smallThumbnail = 'smallThumbnail',\r\n    largeThumbnail = 'largeThumbnail',\r\n\r\n    // File Actions: Unsorted\r\n    folder = 'folder',\r\n    folderCreate = 'folderCreate',\r\n    folderOpen = 'folderOpen',\r\n    folderChainSeparator = 'folderChainSeparator',\r\n    download = 'download',\r\n    upload = 'upload',\r\n    trash = 'trash',\r\n    fallbackIcon = 'fallbackIcon',\r\n\r\n    // File modifiers\r\n    symlink = 'symlink',\r\n    hidden = 'hidden',\r\n\r\n    // Generic file types\r\n    file = 'file',\r\n    license = 'license',\r\n    code = 'code',\r\n    config = 'config',\r\n    model = 'model',\r\n    database = 'database',\r\n    text = 'text',\r\n    archive = 'archive',\r\n    image = 'image',\r\n    video = 'video',\r\n    info = 'info',\r\n    key = 'key',\r\n    lock = 'lock',\r\n    music = 'music',\r\n    terminal = 'terminal',\r\n    users = 'users',\r\n\r\n    // OS file types\r\n    linux = 'linux',\r\n    ubuntu = 'ubuntu',\r\n    windows = 'windows',\r\n\r\n    // Programming language file types\r\n    rust = 'rust',\r\n    python = 'python',\r\n    nodejs = 'nodejs',\r\n    php = 'php',\r\n\r\n    // Development tools file types\r\n    git = 'git',\r\n\r\n    // Brands file types\r\n    adobe = 'adobe',\r\n\r\n    // Other program file types\r\n    pdf = 'pdf',\r\n    excel = 'excel',\r\n    word = 'word',\r\n    flash = 'flash',\r\n}\r\n\r\nexport interface FileIconData {\r\n    icon: ChonkyIconName | string;\r\n    colorCode: number;\r\n}\r\n\r\nexport interface ChonkyIconProps {\r\n    icon: ChonkyIconName | string;\r\n    spin?: boolean;\r\n    className?: string;\r\n    fixedWidth?: boolean;\r\n    style?: React.CSSProperties;\r\n}\r\n","// Used in React hooks to indicate empty deps are intentional.\r\nimport { MaybePromise, Nullable, WritableProps } from 'tsdef';\r\n\r\nimport { FileAction, FileActionEffect } from '../types/action.types';\r\nimport { Logger } from './logger';\r\n\r\n// Used in contexts that need to provide some default value for a function.\r\n// eslint-disable-next-line no-unused-vars,@typescript-eslint/no-unused-vars\r\nexport const NOOP_FUNCTION = (...args: any[]) => {\r\n    Logger.warn(\r\n        `The \"NOOP_FUNCTION\" from the constants module was called. ` +\r\n            `This can indicate a bug in one of the components. Supplied args:`,\r\n        args\r\n    );\r\n};\r\n\r\nexport const isPromise = <T>(value: MaybePromise<T> | any): value is Promise<T> => {\r\n    if (typeof value !== 'object' || !value) return false;\r\n    const then = (value as Promise<T>).then;\r\n    return then && typeof then === 'function';\r\n};\r\n\r\nexport const defineFileAction = <Action extends FileAction>(\r\n    action: Action,\r\n    effect?: FileActionEffect<FileAction>\r\n): WritableProps<Action> => {\r\n    if (action.__payloadType !== undefined && (action.hotkeys || action.button)) {\r\n        const errorMessage =\r\n            `Invalid definition was provided for file action \"${action.id}\". Actions ` +\r\n            `that specify hotkeys or buttons cannot define a payload type. If ` +\r\n            `your application requires this functionality, define two actions ` +\r\n            `and chain them using effects.`;\r\n        Logger.error(errorMessage);\r\n        throw new Error(errorMessage);\r\n    }\r\n\r\n    action.effect = effect;\r\n    return action;\r\n};\r\n\r\n/**\r\n * Recursively check the current element and the parent elements, going bottom-up.\r\n * Returns the first element to match the predicate, otherwise returns null if such\r\n * element is not found.\r\n */\r\nexport const findElementAmongAncestors = (\r\n    maybeElement: HTMLElement | any,\r\n    predicate: (maybeElement: HTMLElement | any) => boolean\r\n): Nullable<HTMLElement> => {\r\n    if (!maybeElement) return maybeElement;\r\n\r\n    if (predicate(maybeElement)) return maybeElement;\r\n\r\n    if (maybeElement.parentElement) {\r\n        return findElementAmongAncestors(maybeElement.parentElement, predicate);\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\nexport const elementIsInsideButton = (buttonCandidate: HTMLElement | any): boolean => {\r\n    return !!findElementAmongAncestors(\r\n        buttonCandidate,\r\n        (element: any) => element.tagName && element.tagName.toLowerCase() === 'button'\r\n    );\r\n};\r\n\r\nexport const getValueOrFallback = <T extends any>(\r\n    value: T | undefined,\r\n    fallback: T,\r\n    desiredType?: 'boolean' | 'string' | 'number'\r\n): NonNullable<T> => {\r\n    if (desiredType) {\r\n        return (typeof value === desiredType ? value : fallback) as NonNullable<T>;\r\n    }\r\n    return (value !== undefined ? value : fallback) as NonNullable<T>;\r\n};\r\n","import { ChonkyThunk } from '../../types/redux.types';\r\nimport { FileHelper } from '../../util/file-helper';\r\nimport { reduxActions } from '../reducers';\r\nimport { selectors } from '../selectors';\r\n\r\nexport const reduxThunks = {\r\n    selectRange: (params: {\r\n        rangeStart: number;\r\n        rangeEnd: number;\r\n        reset?: boolean;\r\n    }): ChonkyThunk => (dispatch, getState) => {\r\n        const state = getState();\r\n        if (state.disableSelection) return;\r\n        const displayFileIds = selectors.getDisplayFileIds(state);\r\n        const fileIdsToSelect = displayFileIds\r\n            .slice(params.rangeStart, params.rangeEnd + 1)\r\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id])) as string[];\r\n        dispatch(\r\n            reduxActions.selectFiles({\r\n                fileIds: fileIdsToSelect,\r\n                reset: !!params.reset,\r\n            })\r\n        );\r\n    },\r\n};\r\n","import { reduxActions } from '../redux/reducers';\r\nimport {\r\n    getFileData, getIsFileSelected, selectDisableSelection, selectors, selectParentFolder,\r\n    selectSelectionSize\r\n} from '../redux/selectors';\r\nimport { reduxThunks } from '../redux/thunks';\r\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\r\nimport {\r\n    ChangeSelectionPayload, EndDragNDropPayload, KeyboardClickFilePayload, MouseClickFilePayload,\r\n    MoveFilesPayload, OpenFileContextMenuPayload, OpenFilesPayload, StartDragNDropPayload\r\n} from '../types/action-payloads.types';\r\nimport { ChonkyIconName } from '../types/icons.types';\r\nimport { FileHelper } from '../util/file-helper';\r\nimport { defineFileAction } from '../util/helpers';\r\nimport { Logger } from '../util/logger';\r\nimport { ChonkyActions } from './index';\r\n\r\nexport const EssentialActions = {\r\n    /**\r\n     * Action that is dispatched when the user clicks on a file entry using their mouse.\r\n     * Both single clicks and double clicks trigger this action.\r\n     */\r\n    MouseClickFile: defineFileAction(\r\n        {\r\n            id: 'mouse_click_file',\r\n            __payloadType: {} as MouseClickFilePayload,\r\n        } as const,\r\n        ({ payload, reduxDispatch, getReduxState }) => {\r\n            if (payload.clickType === 'double') {\r\n                if (FileHelper.isOpenable(payload.file)) {\r\n                    reduxDispatch(\r\n                        thunkRequestFileAction(ChonkyActions.OpenFiles, {\r\n                            targetFile: payload.file,\r\n\r\n                            // To simulate Windows Explorer and Nautilus behaviour,\r\n                            // a double click on a file only opens that file even if\r\n                            // there is a selection.\r\n                            files: [payload.file],\r\n                        })\r\n                    );\r\n                }\r\n            } else {\r\n                // We're dealing with a single click\r\n\r\n                const disableSelection = selectDisableSelection(getReduxState());\r\n                if (FileHelper.isSelectable(payload.file) && !disableSelection) {\r\n                    if (payload.ctrlKey) {\r\n                        // Multiple selection\r\n                        reduxDispatch(\r\n                            reduxActions.toggleSelection({\r\n                                fileId: payload.file.id,\r\n                                exclusive: false,\r\n                            })\r\n                        );\r\n                        reduxDispatch(\r\n                            reduxActions.setLastClickIndex({\r\n                                index: payload.fileDisplayIndex,\r\n                                fileId: payload.file.id,\r\n                            })\r\n                        );\r\n                    } else if (payload.shiftKey) {\r\n                        // Range selection\r\n                        const lastClickIndex = selectors.getLastClickIndex(getReduxState());\r\n                        if (typeof lastClickIndex === 'number') {\r\n                            // We have the index of the previous click\r\n                            let rangeStart = lastClickIndex;\r\n                            let rangeEnd = payload.fileDisplayIndex;\r\n                            if (rangeStart > rangeEnd) {\r\n                                [rangeStart, rangeEnd] = [rangeEnd, rangeStart];\r\n                            }\r\n\r\n                            reduxDispatch(reduxThunks.selectRange({ rangeStart, rangeEnd }));\r\n                        } else {\r\n                            // Since we can't do a range selection, do a\r\n                            // multiple selection\r\n                            reduxDispatch(\r\n                                reduxActions.toggleSelection({\r\n                                    fileId: payload.file.id,\r\n                                    exclusive: false,\r\n                                })\r\n                            );\r\n                            reduxDispatch(\r\n                                reduxActions.setLastClickIndex({\r\n                                    index: payload.fileDisplayIndex,\r\n                                    fileId: payload.file.id,\r\n                                })\r\n                            );\r\n                        }\r\n                    } else {\r\n                        // Exclusive selection\r\n                        reduxDispatch(\r\n                            reduxActions.toggleSelection({\r\n                                fileId: payload.file.id,\r\n                                exclusive: true,\r\n                            })\r\n                        );\r\n                        reduxDispatch(\r\n                            reduxActions.setLastClickIndex({\r\n                                index: payload.fileDisplayIndex,\r\n                                fileId: payload.file.id,\r\n                            })\r\n                        );\r\n                    }\r\n                } else {\r\n                    if (!payload.ctrlKey && !disableSelection) {\r\n                        reduxDispatch(reduxActions.clearSelection());\r\n                    }\r\n                    reduxDispatch(\r\n                        reduxActions.setLastClickIndex({\r\n                            index: payload.fileDisplayIndex,\r\n                            fileId: payload.file.id,\r\n                        })\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    ),\r\n    /**\r\n     * Action that is dispatched when the user \"clicks\" on a file using their keyboard.\r\n     * Using Space and Enter keys counts as clicking.\r\n     */\r\n    KeyboardClickFile: defineFileAction(\r\n        {\r\n            id: 'keyboard_click_file',\r\n            __payloadType: {} as KeyboardClickFilePayload,\r\n        } as const,\r\n        ({ payload, reduxDispatch, getReduxState }) => {\r\n            reduxDispatch(\r\n                reduxActions.setLastClickIndex({\r\n                    index: payload.fileDisplayIndex,\r\n                    fileId: payload.file.id,\r\n                })\r\n            );\r\n            if (payload.enterKey) {\r\n                // We only dispatch the Open Files action here when the selection is\r\n                // empty. Otherwise, `Enter` key presses are handled by the\r\n                // hotkey manager for the Open Files action.\r\n                if (selectSelectionSize(getReduxState()) === 0) {\r\n                    reduxDispatch(\r\n                        thunkRequestFileAction(ChonkyActions.OpenFiles, {\r\n                            targetFile: payload.file,\r\n                            files: [payload.file],\r\n                        })\r\n                    );\r\n                }\r\n            } else if (payload.spaceKey && FileHelper.isSelectable(payload.file)) {\r\n                reduxDispatch(\r\n                    reduxActions.toggleSelection({\r\n                        fileId: payload.file.id,\r\n                        exclusive: payload.ctrlKey,\r\n                    })\r\n                );\r\n            }\r\n        }\r\n    ),\r\n    /**\r\n     * Action that is dispatched when user starts dragging some file.\r\n     */\r\n    StartDragNDrop: defineFileAction(\r\n        {\r\n            id: 'start_drag_n_drop',\r\n            __payloadType: {} as StartDragNDropPayload,\r\n        } as const,\r\n        ({ payload, reduxDispatch, getReduxState }) => {\r\n            const file = payload.draggedFile;\r\n            if (!getIsFileSelected(getReduxState(), file)) {\r\n                if (FileHelper.isSelectable(file)) {\r\n                    reduxDispatch(\r\n                        reduxActions.selectFiles({\r\n                            fileIds: [file.id],\r\n                            reset: true,\r\n                        })\r\n                    );\r\n                }\r\n            }\r\n        }\r\n    ),\r\n    /**\r\n     * Action that is dispatched when user either cancels the drag & drop interaction,\r\n     * or drops a file somewhere.\r\n     */\r\n    EndDragNDrop: defineFileAction(\r\n        {\r\n            id: 'end_drag_n_drop',\r\n            __payloadType: {} as EndDragNDropPayload,\r\n        } as const,\r\n        ({ payload, reduxDispatch, getReduxState }) => {\r\n            if (getIsFileSelected(getReduxState(), payload.destination)) {\r\n                // Can't drop a selection into itself\r\n                return;\r\n            }\r\n\r\n            const { draggedFile, selectedFiles } = payload as EndDragNDropPayload;\r\n            const droppedFiles = selectedFiles.length > 0 ? selectedFiles : [draggedFile];\r\n            reduxDispatch(\r\n                thunkRequestFileAction(ChonkyActions.MoveFiles, {\r\n                    ...payload,\r\n                    files: droppedFiles,\r\n                })\r\n            );\r\n        }\r\n    ),\r\n    /**\r\n     * Action that is dispatched when user moves files from one folder to another,\r\n     * usually by dragging & dropping some files into the folder.\r\n     */\r\n    MoveFiles: defineFileAction({\r\n        id: 'move_files',\r\n        __payloadType: {} as MoveFilesPayload,\r\n    } as const),\r\n    /**\r\n     * Action that is dispatched when the selection changes for any reason.\r\n     */\r\n    ChangeSelection: defineFileAction({\r\n        id: 'change_selection',\r\n        __payloadType: {} as ChangeSelectionPayload,\r\n    } as const),\r\n    /**\r\n     * Action that is dispatched when user wants to open some files. This action is\r\n     * often triggered by other actions.\r\n     */\r\n    OpenFiles: defineFileAction({\r\n        id: 'open_files',\r\n        __payloadType: {} as OpenFilesPayload,\r\n    } as const),\r\n    /**\r\n     * Action that is triggered when user wants to go up a directory.\r\n     */\r\n    OpenParentFolder: defineFileAction(\r\n        {\r\n            id: 'open_parent_folder',\r\n            hotkeys: ['backspace'],\r\n            button: {\r\n                name: 'Go up a directory',\r\n                toolbar: true,\r\n                contextMenu: false,\r\n                icon: ChonkyIconName.openParentFolder,\r\n                iconOnly: true,\r\n            },\r\n        } as const,\r\n        ({ reduxDispatch, getReduxState }) => {\r\n            const parentFolder = selectParentFolder(getReduxState());\r\n            if (FileHelper.isOpenable(parentFolder)) {\r\n                reduxDispatch(\r\n                    thunkRequestFileAction(ChonkyActions.OpenFiles, {\r\n                        targetFile: parentFolder,\r\n                        files: [parentFolder],\r\n                    })\r\n                );\r\n            } else {\r\n                Logger.warn(\r\n                    'Open parent folder effect was triggered  even though the parent folder' +\r\n                        ' is not openable. This indicates a bug in presentation components.'\r\n                );\r\n            }\r\n        }\r\n    ),\r\n    /**\r\n     * Action that is dispatched when user opens the context menu, either by right click\r\n     * on something or using the context menu button on their keyboard.\r\n     */\r\n    OpenFileContextMenu: defineFileAction(\r\n        {\r\n            id: 'open_file_context_menu',\r\n            __payloadType: {} as OpenFileContextMenuPayload,\r\n        } as const,\r\n        ({ payload, reduxDispatch, getReduxState }) => {\r\n            // TODO: Check if the context menu component is actually enabled. There is a\r\n            //  chance it doesn't matter if it is enabled or not - if it is not mounted,\r\n            //  the action will simply have no effect. It also allows users to provide\r\n            //  their own components - however, users could also flip the \"context menu\r\n            //  component mounted\" switch...\r\n            const triggerFile = getFileData(getReduxState(), payload.triggerFileId);\r\n            if (triggerFile) {\r\n                const fileSelected = getIsFileSelected(getReduxState(), triggerFile);\r\n                if (!fileSelected) {\r\n                    // If file is selected, we leave the selection as is. If it is not\r\n                    // selected, it means user right clicked the file with no selection.\r\n                    // We simulate the Windows Explorer/Nautilus behaviour of moving\r\n                    // selection to this file.\r\n                    if (FileHelper.isSelectable(triggerFile)) {\r\n                        reduxDispatch(\r\n                            reduxActions.selectFiles({\r\n                                fileIds: [payload.triggerFileId],\r\n                                reset: true,\r\n                            })\r\n                        );\r\n                    } else {\r\n                        reduxDispatch(reduxActions.clearSelection());\r\n                    }\r\n                }\r\n            }\r\n\r\n            reduxDispatch(\r\n                reduxActions.showContextMenu({\r\n                    triggerFileId: payload.triggerFileId,\r\n                    mouseX: payload.clientX - 2,\r\n                    mouseY: payload.clientY - 4,\r\n                })\r\n            );\r\n        }\r\n    ),\r\n};\r\n","import { Nullable } from 'tsdef';\r\n\r\nimport { selectFocusSearchInput } from '../redux/selectors';\r\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\r\nimport { FileSelectionTransform } from '../types/action.types';\r\nimport { FileViewMode } from '../types/file-view.types';\r\nimport { FileData } from '../types/file.types';\r\nimport { ChonkyIconName } from '../types/icons.types';\r\nimport { FileHelper } from '../util/file-helper';\r\nimport { defineFileAction } from '../util/helpers';\r\nimport { EssentialActions } from './essential';\r\nimport { OptionIds } from './option-ids';\r\n\r\nexport const DefaultActions = {\r\n    /**\r\n     * Action that can be used to open currently selected files.\r\n     */\r\n    OpenSelection: defineFileAction(\r\n        {\r\n            id: 'open_selection',\r\n            hotkeys: ['enter'],\r\n            requiresSelection: true,\r\n            fileFilter: FileHelper.isOpenable,\r\n            button: {\r\n                name: 'Open selection',\r\n                toolbar: true,\r\n                contextMenu: true,\r\n                group: 'Actions',\r\n                icon: ChonkyIconName.openFiles,\r\n            },\r\n        } as const,\r\n        ({ state, reduxDispatch }) => {\r\n            reduxDispatch(\r\n                thunkRequestFileAction(EssentialActions.OpenFiles, {\r\n                    files: state.selectedFilesForAction!,\r\n                })\r\n            );\r\n            return undefined;\r\n        }\r\n    ),\r\n    /**\r\n     * Action that selects all files.\r\n     */\r\n    SelectAllFiles: defineFileAction({\r\n        id: 'select_all_files',\r\n        hotkeys: ['ctrl+a'],\r\n        button: {\r\n            name: 'Select all files',\r\n            toolbar: true,\r\n            contextMenu: true,\r\n            group: 'Actions',\r\n            icon: ChonkyIconName.selectAllFiles,\r\n        },\r\n        selectionTransform: (({ fileIds, hiddenFileIds }) => {\r\n            const newSelection = new Set<string>();\r\n            fileIds.map(fileId => {\r\n                // We don't need to check if file is selectable because Chonky does\r\n                // it own checks internally.\r\n                if (!hiddenFileIds.has(fileId)) newSelection.add(fileId);\r\n            });\r\n            return newSelection;\r\n        }) as FileSelectionTransform,\r\n    } as const),\r\n    /**\r\n     * Action that clear the file selection.\r\n     */\r\n    ClearSelection: defineFileAction({\r\n        id: 'clear_selection',\r\n        hotkeys: ['escape'],\r\n        button: {\r\n            name: 'Clear selection',\r\n            toolbar: true,\r\n            contextMenu: true,\r\n            group: 'Actions',\r\n            icon: ChonkyIconName.clearSelection,\r\n        },\r\n        selectionTransform: (({ prevSelection }) => {\r\n            if (prevSelection.size === 0) return null;\r\n            return new Set<string>();\r\n        }) as FileSelectionTransform,\r\n    } as const),\r\n    /**\r\n     * Action that enables List view.\r\n     */\r\n    EnableListView: defineFileAction({\r\n        id: 'enable_list_view',\r\n        fileViewConfig: {\r\n            mode: FileViewMode.List,\r\n            entryHeight: 30,\r\n        },\r\n        button: {\r\n            name: 'Switch to List view',\r\n            toolbar: true,\r\n            icon: ChonkyIconName.list,\r\n            iconOnly: true,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that enables Compact view. Note that compact view is still\r\n     * experimental and should not be used in production.\r\n     */\r\n    EnableCompactView: defineFileAction({\r\n        // TODO: Don't enable until compact view is fully supported\r\n        id: 'enable_compact_view',\r\n        fileViewConfig: {\r\n            mode: FileViewMode.Compact,\r\n            entryHeight: 40,\r\n            entryWidth: 220,\r\n        },\r\n        button: {\r\n            name: 'Switch to Compact view',\r\n            toolbar: true,\r\n            icon: ChonkyIconName.compact,\r\n            iconOnly: true,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that enables Grid view.\r\n     */\r\n    EnableGridView: defineFileAction({\r\n        id: 'enable_grid_view',\r\n        fileViewConfig: { mode: FileViewMode.Grid, entryWidth: 165, entryHeight: 130 },\r\n        button: {\r\n            name: 'Switch to Grid view',\r\n            toolbar: true,\r\n            icon: ChonkyIconName.smallThumbnail,\r\n            iconOnly: true,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that sorts files by `file.name`.\r\n     */\r\n    SortFilesByName: defineFileAction({\r\n        id: 'sort_files_by_name',\r\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.name.toLowerCase() : undefined),\r\n        button: {\r\n            name: 'Sort by name',\r\n            toolbar: true,\r\n            group: 'Options',\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that sorts files by `file.size`.\r\n     */\r\n    SortFilesBySize: defineFileAction({\r\n        id: 'sort_files_by_size',\r\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.size : undefined),\r\n        button: {\r\n            name: 'Sort by size',\r\n            toolbar: true,\r\n            group: 'Options',\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that sorts files by `file.modDate`.\r\n     */\r\n    SortFilesByDate: defineFileAction({\r\n        id: 'sort_files_by_date',\r\n        sortKeySelector: (file: Nullable<FileData>) => (file ? file.modDate : undefined),\r\n        button: {\r\n            name: 'Sort by date',\r\n            toolbar: true,\r\n            group: 'Options',\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that toggles whether hidden files are shown to the user or not.\r\n     */\r\n    ToggleHiddenFiles: defineFileAction({\r\n        id: 'toggle_hidden_files',\r\n        hotkeys: ['ctrl+h'],\r\n        option: {\r\n            id: OptionIds.ShowHiddenFiles,\r\n            defaultValue: true,\r\n        },\r\n        button: {\r\n            name: 'Show hidden files',\r\n            toolbar: true,\r\n            group: 'Options',\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that toggles whether folders should appear before files regardless of\r\n     * current sort function.\r\n     */\r\n    ToggleShowFoldersFirst: defineFileAction({\r\n        id: 'toggle_show_folders_first',\r\n        option: {\r\n            id: OptionIds.ShowFoldersFirst,\r\n            defaultValue: true,\r\n        },\r\n        button: {\r\n            name: 'Show folders first',\r\n            toolbar: true,\r\n            group: 'Options',\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that focuses the search input when it is dispatched.\r\n     */\r\n    FocusSearchInput: defineFileAction(\r\n        {\r\n            id: 'focus_search_input',\r\n            hotkeys: ['ctrl+f'],\r\n        } as const,\r\n        ({ getReduxState }) => {\r\n            const focusSearchInput = selectFocusSearchInput(getReduxState());\r\n            if (focusSearchInput) focusSearchInput();\r\n        }\r\n    ),\r\n    /**\r\n     * Action that enables List view.\r\n     */\r\n    ToggleDarkMode: defineFileAction({\r\n        id: 'enable_dark_mode',\r\n        option: {\r\n            id: OptionIds.DarkMode,\r\n            defaultValue: false,\r\n        },\r\n        button: {\r\n            name: 'Enable dark mode',\r\n            toolbar: true,\r\n            icon: ChonkyIconName.list,\r\n            iconOnly: true,\r\n        },\r\n    } as const),\r\n};\r\n","import { ChonkyIconName } from '../types/icons.types';\r\nimport { defineFileAction } from '../util/helpers';\r\n\r\nexport const ExtraActions = {\r\n    /**\r\n     * Action that adds a button and shortcut to copy files.\r\n     */\r\n    CopyFiles: defineFileAction({\r\n        id: 'copy_files',\r\n        requiresSelection: true,\r\n        hotkeys: ['ctrl+c'],\r\n        button: {\r\n            name: 'Copy selection',\r\n            toolbar: true,\r\n            contextMenu: true,\r\n            group: 'Actions',\r\n            icon: ChonkyIconName.copy,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that adds a button to create a new folder.\r\n     */\r\n    CreateFolder: defineFileAction({\r\n        id: 'create_folder',\r\n        button: {\r\n            name: 'Create folder',\r\n            toolbar: true,\r\n            tooltip: 'Create a folder',\r\n            icon: ChonkyIconName.folderCreate,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that adds a button to upload files.\r\n     */\r\n    UploadFiles: defineFileAction({\r\n        id: 'upload_files',\r\n        button: {\r\n            name: 'Upload files',\r\n            toolbar: true,\r\n            tooltip: 'Upload files',\r\n            icon: ChonkyIconName.upload,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that adds a button to download files.\r\n     */\r\n    DownloadFiles: defineFileAction({\r\n        id: 'download_files',\r\n        requiresSelection: true,\r\n        button: {\r\n            name: 'Download files',\r\n            toolbar: true,\r\n            contextMenu: true,\r\n            group: 'Actions',\r\n            icon: ChonkyIconName.download,\r\n        },\r\n    } as const),\r\n    /**\r\n     * Action that adds a button and shortcut to delete files.\r\n     */\r\n    DeleteFiles: defineFileAction({\r\n        id: 'delete_files',\r\n        requiresSelection: true,\r\n        hotkeys: ['delete'],\r\n        button: {\r\n            name: 'Delete files',\r\n            toolbar: true,\r\n            contextMenu: true,\r\n            group: 'Actions',\r\n            icon: ChonkyIconName.trash,\r\n        },\r\n    } as const),\r\n};\r\n","import { DefaultActions } from './default';\r\nimport { EssentialActions } from './essential';\r\nimport { ExtraActions } from './extra';\r\n\r\nexport { OptionIds } from './option-ids';\r\n\r\nexport const ChonkyActions = {\r\n    ...EssentialActions,\r\n    ...DefaultActions,\r\n    ...ExtraActions,\r\n};\r\n\r\nexport const EssentialFileActions = [\r\n    ChonkyActions.MouseClickFile,\r\n    ChonkyActions.KeyboardClickFile,\r\n    ChonkyActions.StartDragNDrop,\r\n    ChonkyActions.EndDragNDrop,\r\n    ChonkyActions.MoveFiles,\r\n    ChonkyActions.ChangeSelection,\r\n    ChonkyActions.OpenFiles,\r\n    ChonkyActions.OpenParentFolder,\r\n    ChonkyActions.OpenFileContextMenu,\r\n];\r\n\r\nexport const DefaultFileActions = [\r\n    ChonkyActions.OpenSelection,\r\n    ChonkyActions.SelectAllFiles,\r\n    ChonkyActions.ClearSelection,\r\n    ChonkyActions.EnableListView,\r\n    // TODO: Don't enable until compact view is fully supported\r\n    // ChonkyActions.EnableCompactView,\r\n    ChonkyActions.EnableGridView,\r\n    ChonkyActions.SortFilesByName,\r\n    ChonkyActions.SortFilesBySize,\r\n    ChonkyActions.SortFilesByDate,\r\n    ChonkyActions.ToggleHiddenFiles,\r\n    ChonkyActions.ToggleShowFoldersFirst,\r\n    ChonkyActions.FocusSearchInput,\r\n];\r\n","import { ChonkyActions } from '../action-definitions/index';\r\nimport { RootState } from '../types/redux.types';\r\nimport { SortOrder } from '../types/sort.types';\r\n\r\nexport const initialRootState: RootState = {\r\n    instanceId: 'CHONKY_INVALID_ID', // should be overwritten by preloaded state\r\n\r\n    externalFileActionHandler: null,\r\n\r\n    rawFileActions: [],\r\n    fileActionsErrorMessages: [],\r\n    fileActionMap: {},\r\n    fileActionIds: [],\r\n    toolbarItems: [],\r\n    contextMenuItems: [],\r\n\r\n    rawFolderChain: null,\r\n    folderChainErrorMessages: [],\r\n    folderChain: [],\r\n\r\n    rawFiles: [],\r\n    filesErrorMessages: [],\r\n    fileMap: {},\r\n    fileIds: [],\r\n    cleanFileIds: [],\r\n\r\n    sortedFileIds: [],\r\n    hiddenFileIdMap: {},\r\n\r\n    focusSearchInput: null,\r\n    searchString: '',\r\n    searchMode: 'currentFolder',\r\n\r\n    selectionMap: {},\r\n    disableSelection: false,\r\n\r\n    fileViewConfig: ChonkyActions.EnableGridView.fileViewConfig,\r\n\r\n    sortActionId: null,\r\n    sortOrder: SortOrder.ASC,\r\n\r\n    optionMap: {},\r\n\r\n    thumbnailGenerator: null,\r\n    doubleClickDelay: 300,\r\n    disableDragAndDrop: false,\r\n    clearSelectionOnOutsideClick: true,\r\n\r\n    lastClick: null,\r\n\r\n    contextMenuMounted: false,\r\n    contextMenuConfig: null,\r\n};\r\n","import { Nilable, Nullable } from 'tsdef';\r\n\r\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\r\n\r\nimport { GenericFileActionHandler } from '../types/action-handler.types';\r\nimport { FileActionMenuItem } from '../types/action-menus.types';\r\nimport { FileAction, FileActionMap } from '../types/action.types';\r\nimport { ContextMenuConfig } from '../types/context-menu.types';\r\nimport { FileViewConfig } from '../types/file-view.types';\r\nimport { FileArray, FileIdTrueMap, FileMap } from '../types/file.types';\r\nimport { OptionMap } from '../types/options.types';\r\nimport { RootState } from '../types/redux.types';\r\nimport { SortOrder } from '../types/sort.types';\r\nimport { ThumbnailGenerator } from '../types/thumbnails.types';\r\nimport { FileHelper } from '../util/file-helper';\r\nimport { sanitizeInputArray } from './files-transforms';\r\nimport { initialRootState } from './state';\r\n\r\nconst reducers = {\r\n    setExternalFileActionHandler(\r\n        state: RootState,\r\n        action: PayloadAction<Nilable<GenericFileActionHandler<FileAction>>>\r\n    ) {\r\n        state.externalFileActionHandler = action.payload ?? null;\r\n    },\r\n    setRawFileActions(state: RootState, action: PayloadAction<FileAction[] | any>) {\r\n        state.rawFileActions = action.payload;\r\n    },\r\n    setFileActionsErrorMessages(state: RootState, action: PayloadAction<string[]>) {\r\n        state.fileActionsErrorMessages = action.payload;\r\n    },\r\n    setFileActions(state: RootState, action: PayloadAction<FileAction[]>) {\r\n        const fileActionMap: FileActionMap = {};\r\n        action.payload.map(a => (fileActionMap[a.id] = a));\r\n        const fileIds = action.payload.map(a => a.id);\r\n\r\n        state.fileActionMap = fileActionMap as FileMap;\r\n        state.fileActionIds = fileIds;\r\n    },\r\n    updateFileActionMenuItems(state: RootState, action: PayloadAction<[FileActionMenuItem[], FileActionMenuItem[]]>) {\r\n        [state.toolbarItems, state.contextMenuItems] = action.payload;\r\n    },\r\n    setRawFolderChain(state: RootState, action: PayloadAction<FileArray | any>) {\r\n        const rawFolderChain = action.payload;\r\n        const { sanitizedArray: folderChain, errorMessages } = sanitizeInputArray('folderChain', rawFolderChain);\r\n        state.rawFolderChain = rawFolderChain;\r\n        state.folderChain = folderChain;\r\n        state.folderChainErrorMessages = errorMessages;\r\n    },\r\n    setRawFiles(state: RootState, action: PayloadAction<FileArray | any>) {\r\n        const rawFiles = action.payload;\r\n        const { sanitizedArray: files, errorMessages } = sanitizeInputArray('files', rawFiles);\r\n        state.rawFiles = rawFiles;\r\n        state.filesErrorMessages = errorMessages;\r\n\r\n        const fileMap: FileMap = {};\r\n        files.forEach(f => {\r\n            if (f) fileMap[f.id] = f;\r\n        });\r\n        const fileIds = files.map(f => (f ? f.id : null));\r\n        const cleanFileIds = fileIds.filter(f => !!f) as string[];\r\n\r\n        state.fileMap = fileMap;\r\n        state.fileIds = fileIds;\r\n        state.cleanFileIds = cleanFileIds;\r\n\r\n        // Cleanup selection\r\n        for (const selectedFileId of Object.keys(state.selectionMap)) {\r\n            if (!fileMap[selectedFileId]) {\r\n                delete state.selectionMap[selectedFileId];\r\n            }\r\n        }\r\n    },\r\n    setSortedFileIds(state: RootState, action: PayloadAction<Nullable<string>[]>) {\r\n        state.sortedFileIds = action.payload;\r\n    },\r\n    setHiddenFileIds(state: RootState, action: PayloadAction<FileIdTrueMap>) {\r\n        state.hiddenFileIdMap = action.payload;\r\n\r\n        // Cleanup selection\r\n        for (const selectedFileId of Object.keys(state.selectionMap)) {\r\n            if (state.hiddenFileIdMap[selectedFileId]) {\r\n                delete state.selectionMap[selectedFileId];\r\n            }\r\n        }\r\n    },\r\n    setFocusSearchInput(state: RootState, action: PayloadAction<Nullable<() => void>>) {\r\n        state.focusSearchInput = action.payload;\r\n    },\r\n    setSearchString(state: RootState, action: PayloadAction<string>) {\r\n        state.searchString = action.payload;\r\n    },\r\n    selectAllFiles(state: RootState) {\r\n        state.fileIds\r\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id]))\r\n            .map(id => (id ? (state.selectionMap[id] = true) : null));\r\n    },\r\n    selectFiles(state: RootState, action: PayloadAction<{ fileIds: string[]; reset: boolean }>) {\r\n        if (state.disableSelection) return;\r\n        if (action.payload.reset) state.selectionMap = {};\r\n        action.payload.fileIds\r\n            .filter(id => id && FileHelper.isSelectable(state.fileMap[id]))\r\n            .map(id => (state.selectionMap[id] = true));\r\n    },\r\n    toggleSelection(state: RootState, action: PayloadAction<{ fileId: string; exclusive: boolean }>) {\r\n        if (state.disableSelection) return;\r\n        const oldValue = !!state.selectionMap[action.payload.fileId];\r\n        if (action.payload.exclusive) state.selectionMap = {};\r\n        if (oldValue) delete state.selectionMap[action.payload.fileId];\r\n        else if (FileHelper.isSelectable(state.fileMap[action.payload.fileId])) {\r\n            state.selectionMap[action.payload.fileId] = true;\r\n        }\r\n    },\r\n    clearSelection(state: RootState) {\r\n        if (state.disableSelection) return;\r\n        if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\r\n    },\r\n    setSelectionDisabled(state: RootState, action: PayloadAction<boolean>) {\r\n        state.disableSelection = action.payload;\r\n        if (Object.keys(state.selectionMap).length !== 0) state.selectionMap = {};\r\n    },\r\n    setFileViewConfig(state: RootState, action: PayloadAction<FileViewConfig>) {\r\n        state.fileViewConfig = action.payload;\r\n    },\r\n    setSort(state: RootState, action: PayloadAction<{ actionId: string; order: SortOrder }>) {\r\n        state.sortActionId = action.payload.actionId;\r\n        state.sortOrder = action.payload.order;\r\n    },\r\n    setOptionDefaults(state: RootState, action: PayloadAction<OptionMap>) {\r\n        for (const optionId of Object.keys(action.payload)) {\r\n            if (optionId in state.optionMap) continue;\r\n            state.optionMap[optionId] = action.payload[optionId];\r\n        }\r\n    },\r\n    toggleOption(state: RootState, action: PayloadAction<string>) {\r\n        state.optionMap[action.payload] = !state.optionMap[action.payload];\r\n    },\r\n    setThumbnailGenerator(state: RootState, action: PayloadAction<Nullable<ThumbnailGenerator>>) {\r\n        state.thumbnailGenerator = action.payload;\r\n    },\r\n    setDoubleClickDelay(state: RootState, action: PayloadAction<number>) {\r\n        state.doubleClickDelay = action.payload;\r\n    },\r\n    setDisableDragAndDrop(state: RootState, action: PayloadAction<boolean>) {\r\n        state.disableDragAndDrop = action.payload;\r\n    },\r\n    setClearSelectionOnOutsideClick(state: RootState, action: PayloadAction<boolean>) {\r\n        state.clearSelectionOnOutsideClick = action.payload;\r\n    },\r\n    setLastClickIndex(state: RootState, action: PayloadAction<Nullable<{ index: number; fileId: string }>>) {\r\n        state.lastClick = action.payload;\r\n    },\r\n    setContextMenuMounted(state: RootState, action: PayloadAction<boolean>) {\r\n        state.contextMenuMounted = action.payload;\r\n    },\r\n    showContextMenu(state: RootState, action: PayloadAction<ContextMenuConfig>) {\r\n        state.contextMenuConfig = action.payload;\r\n    },\r\n    hideContextMenu(state: RootState) {\r\n        if (!state.contextMenuConfig) return;\r\n        state.contextMenuConfig = null;\r\n    },\r\n};\r\n\r\nexport const { actions: reduxActions, reducer: rootReducer } = createSlice({\r\n    name: 'root',\r\n    initialState: initialRootState,\r\n    reducers,\r\n});\r\n","import { useEffect } from 'react';\r\nimport watch from 'redux-watch';\r\n\r\nimport { Store } from '@reduxjs/toolkit';\r\n\r\nimport { ChonkyActions } from '../action-definitions';\r\nimport { RootState } from '../types/redux.types';\r\nimport { FileSelection } from '../types/selection.types';\r\nimport { selectSelectedFileIds, selectSelectionMap } from './selectors';\r\nimport { thunkRequestFileAction } from './thunks/dispatchers.thunks';\r\n\r\nexport const useStoreWatchers = (store: Store<RootState>) => {\r\n    useEffect(() => {\r\n        const selectionWatcher = watch(() => selectSelectionMap(store.getState()));\r\n        const onSelectionChange = (\r\n            newSelection: FileSelection,\r\n            oldSelection: FileSelection\r\n        ) => {\r\n            // We don't check for deep equality here as we expect the\r\n            // reducers to prevent all unnecessary updates.\r\n            if (newSelection === oldSelection) return;\r\n\r\n            // Notify users the selection has changed.\r\n            const selectedFilesIds = selectSelectedFileIds(store.getState());\r\n            const selection = new Set<string>(selectedFilesIds);\r\n            store.dispatch(\r\n                thunkRequestFileAction(ChonkyActions.ChangeSelection, {\r\n                    selection,\r\n                }) as any\r\n            );\r\n        };\r\n\r\n        const unsubscribeCallbacks = [\r\n            store.subscribe(selectionWatcher(onSelectionChange)),\r\n        ];\r\n        return () => {\r\n            for (const unsubscribe of unsubscribeCallbacks) unsubscribe();\r\n        };\r\n    }, [store]);\r\n};\r\n","import { useCallback, useEffect } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { configureStore } from '@reduxjs/toolkit';\r\n\r\nimport { RootState } from '../types/redux.types';\r\nimport { useStaticValue } from '../util/hooks-helpers';\r\nimport { rootReducer } from './reducers';\r\nimport { initialRootState } from './state';\r\nimport { useStoreWatchers } from './watchers';\r\n\r\nexport const useChonkyStore = (chonkyInstanceId: string) => {\r\n    const store = useStaticValue(() => {\r\n        const preloadedState: RootState = {\r\n            ...initialRootState,\r\n            instanceId: chonkyInstanceId,\r\n        };\r\n\r\n        return configureStore({\r\n            preloadedState: preloadedState as any,\r\n            reducer: rootReducer,\r\n            middleware: getDefaultMiddleware =>\r\n                getDefaultMiddleware({\r\n                    serializableCheck: false,\r\n                }),\r\n            devTools: { name: `chonky_${chonkyInstanceId}` },\r\n        });\r\n    });\r\n    useStoreWatchers(store);\r\n    return store;\r\n};\r\n\r\n/**\r\n * Hook that can be used with parametrized selectors.\r\n */\r\nexport const useParamSelector = <Args extends Array<any>, Value>(\r\n    parametrizedSelector: (...args: Args) => (state: RootState) => Value,\r\n    ...selectorParams: Args\r\n) => {\r\n    const selector = useCallback(\r\n        (state: RootState) => parametrizedSelector(...selectorParams)(state),\r\n        // eslint-disable-next-line\r\n        [parametrizedSelector, ...selectorParams]\r\n    );\r\n    return useSelector(selector);\r\n};\r\n\r\n/**\r\n * DTE - DispatchThunkEffect. This method is used to decrease code duplication in\r\n * main Chonky method.\r\n */\r\nexport const useDTE = <Args extends Array<any>>(actionCreator: (...args: Args) => any, ...selectorParams: Args) => {\r\n    const dispatch = useDispatch();\r\n    useEffect(\r\n        () => {\r\n            dispatch(actionCreator(...selectorParams));\r\n        },\r\n        // eslint-disable-next-line\r\n        [dispatch, actionCreator, ...selectorParams]\r\n    );\r\n};\r\n\r\nexport const usePropReduxUpdate = <Payload extends any>(actionCreator: (payload: Payload) => any, payload: Payload) => {\r\n    const dispatch = useDispatch();\r\n    useEffect(() => {\r\n        dispatch(actionCreator(payload));\r\n    }, [dispatch, actionCreator, payload]);\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport { ChonkyIconProps } from '../../types/icons.types';\r\n\r\nexport const ChonkyIconPlaceholder: React.FC<ChonkyIconProps> = () => {\r\n    // This component should not be rendered unless the user has misconfigured Chonky\r\n    const title =\r\n        'No icon component found. Please follow Chonky installation instructions to ' +\r\n        'provide a pre-made icon component (or a custom icon).';\r\n    return <span title={title}></span>;\r\n};\r\n","import { ChonkyActions } from '../action-definitions/index';\r\nimport { ChonkyIconPlaceholder } from '../components/internal/ChonkyIconPlaceholder';\r\nimport { FileBrowserProps } from '../types/file-browser.types';\r\n\r\nexport type ChonkyConfig = Pick<\r\n    FileBrowserProps,\r\n    | 'fileActions'\r\n    | 'onFileAction'\r\n    | 'thumbnailGenerator'\r\n    | 'doubleClickDelay'\r\n    | 'disableSelection'\r\n    | 'disableDefaultFileActions'\r\n    | 'disableDragAndDrop'\r\n    | 'disableDragAndDropProvider'\r\n    | 'defaultSortActionId'\r\n    | 'defaultFileViewActionId'\r\n    | 'clearSelectionOnOutsideClick'\r\n    | 'iconComponent'\r\n    | 'darkMode'\r\n    | 'i18n'\r\n>;\r\n\r\nexport const defaultConfig: ChonkyConfig = {\r\n    fileActions: null,\r\n    onFileAction: null,\r\n    thumbnailGenerator: null,\r\n    doubleClickDelay: 300,\r\n    disableSelection: false,\r\n    disableDefaultFileActions: false,\r\n    disableDragAndDrop: false,\r\n    disableDragAndDropProvider: false,\r\n    defaultSortActionId: ChonkyActions.SortFilesByName.id,\r\n    defaultFileViewActionId: ChonkyActions.EnableGridView.id,\r\n    clearSelectionOnOutsideClick: true,\r\n    iconComponent: ChonkyIconPlaceholder,\r\n    darkMode: false,\r\n    i18n: {},\r\n};\r\n\r\nexport const setChonkyDefaults = (config: Partial<ChonkyConfig>) => {\r\n    for (const key of Object.keys(defaultConfig)) {\r\n        if (key in config) {\r\n            defaultConfig[key as keyof ChonkyConfig] = config[\r\n                key as keyof ChonkyConfig\r\n            ] as any;\r\n        }\r\n    }\r\n};\r\n","import filesize from 'filesize';\r\nimport { createContext, useContext, useMemo } from 'react';\r\nimport { IntlShape, useIntl } from 'react-intl';\r\nimport { Nullable, Undefinable } from 'tsdef';\r\n\r\nimport { FileAction } from '../types/action.types';\r\nimport { FileData } from '../types/file.types';\r\nimport { ChonkyFormatters } from '../types/i18n.types';\r\nimport { FileHelper } from './file-helper';\r\n\r\nexport enum I18nNamespace {\r\n    Toolbar = 'toolbar',\r\n    FileList = 'fileList',\r\n    FileEntry = 'fileEntry',\r\n    FileContextMenu = 'contextMenu',\r\n\r\n    FileActions = 'actions',\r\n    FileActionGroups = 'actionGroups',\r\n}\r\n\r\nexport const getI18nId = (namespace: I18nNamespace, stringId: string): string =>\r\n    `chonky.${namespace}.${stringId}`;\r\n\r\nexport const getActionI18nId = (actionId: string, stringId: string): string =>\r\n    `chonky.${I18nNamespace.FileActions}.${actionId}.${stringId}`;\r\n\r\nexport const useLocalizedFileActionGroup = (groupName: string) => {\r\n    const intl = useIntl();\r\n    return useMemo(() => {\r\n        return intl.formatMessage({\r\n            id: getI18nId(I18nNamespace.FileActionGroups, groupName),\r\n            defaultMessage: groupName,\r\n        });\r\n    }, [groupName, intl]);\r\n};\r\n\r\nexport const useLocalizedFileActionStrings = (action: Nullable<FileAction>) => {\r\n    const intl = useIntl();\r\n    return useMemo(() => {\r\n        if (!action) {\r\n            return {\r\n                buttonName: '',\r\n                buttonTooltip: undefined,\r\n            };\r\n        }\r\n\r\n        const buttonName = intl.formatMessage({\r\n            id: getActionI18nId(action.id, 'button.name'),\r\n            defaultMessage: action.button?.name,\r\n        });\r\n\r\n        let buttonTooltip: Undefinable<string> = undefined;\r\n        if (action.button?.tooltip) {\r\n            // We only translate the tooltip if the original action has a tooltip.\r\n            buttonTooltip = intl.formatMessage({\r\n                id: getActionI18nId(action.id, 'button.tooltip'),\r\n                defaultMessage: action.button?.tooltip,\r\n            });\r\n        }\r\n\r\n        return {\r\n            buttonName,\r\n            buttonTooltip,\r\n        };\r\n    }, [action, intl]);\r\n};\r\n\r\nexport const useLocalizedFileEntryStrings = (file: Nullable<FileData>) => {\r\n    const intl = useIntl();\r\n    const formatters = useContext(ChonkyFormattersContext);\r\n    return useMemo(() => {\r\n        return {\r\n            fileModDateString: formatters.formatFileModDate(intl, file),\r\n            fileSizeString: formatters.formatFileSize(intl, file),\r\n        };\r\n    }, [file, formatters, intl]);\r\n};\r\n\r\nexport const defaultFormatters: ChonkyFormatters = {\r\n    formatFileModDate: (\r\n        intl: IntlShape,\r\n        file: Nullable<FileData>\r\n    ): Nullable<string> => {\r\n        const safeModDate = FileHelper.getModDate(file);\r\n        if (safeModDate) {\r\n            return intl.formatDate(safeModDate, {\r\n                dateStyle: 'medium',\r\n                timeStyle: 'short',\r\n            } as any);\r\n        } else {\r\n            return null;\r\n        }\r\n    },\r\n    formatFileSize: (_intl: IntlShape, file: Nullable<FileData>): Nullable<string> => {\r\n        if (!file || typeof file.size !== 'number') return null;\r\n\r\n        const size = file.size;\r\n        const sizeData = filesize(size, { bits: false, output: 'object' }) as any;\r\n        if (sizeData.symbol === 'B') {\r\n            return `${Math.round(sizeData.value / 10) / 100.0} KB`;\r\n        } else if (sizeData.symbol === 'KB') {\r\n            return `${Math.round(sizeData.value)} ${sizeData.symbol}`;\r\n        }\r\n        return `${sizeData.value} ${sizeData.symbol}`;\r\n    },\r\n};\r\n\r\nexport const ChonkyFormattersContext = createContext(defaultFormatters);\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2019\r\n * @license MIT\r\n */\r\n\r\nimport { createContext, ElementType, useMemo } from 'react';\r\n\r\nimport ExactTrie from 'exact-trie';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { ChonkyIconPlaceholder } from '../components/internal/ChonkyIconPlaceholder';\r\nimport { FileData } from '../types/file.types';\r\nimport { ChonkyIconName, ChonkyIconProps, FileIconData } from '../types/icons.types';\r\n\r\nexport const ChonkyIconContext = createContext<ElementType<ChonkyIconProps>>(ChonkyIconPlaceholder);\r\n\r\nexport const VideoExtensions: string[] = [\r\n    '3g2',\r\n    '3gp',\r\n    '3gpp',\r\n    'asf',\r\n    'asx',\r\n    'avi',\r\n    'dvb',\r\n    'f4v',\r\n    'fli',\r\n    'flv',\r\n    'fvt',\r\n    'h261',\r\n    'h263',\r\n    'h264',\r\n    'jpgm',\r\n    'jpgv',\r\n    'jpm',\r\n    'm1v',\r\n    'm2v',\r\n    'm4u',\r\n    'm4v',\r\n    'mj2',\r\n    'mjp2',\r\n    'mk3d',\r\n    'mks',\r\n    'mkv',\r\n    'mng',\r\n    'mov',\r\n    'movie',\r\n    'mp4',\r\n    'mp4v',\r\n    'mpe',\r\n    'mpeg',\r\n    'mpg',\r\n    'mpg4',\r\n    'mxu',\r\n    'ogv',\r\n    'pyv',\r\n    'qt',\r\n    'smv',\r\n    'ts',\r\n    'uvh',\r\n    'uvm',\r\n    'uvp',\r\n    'uvs',\r\n    'uvu',\r\n    'uvv',\r\n    'uvvh',\r\n    'uvvm',\r\n    'uvvp',\r\n    'uvvs',\r\n    'uvvu',\r\n    'uvvv',\r\n    'viv',\r\n    'vob',\r\n    'webm',\r\n    'wm',\r\n    'wmv',\r\n    'wmx',\r\n    'wvx',\r\n];\r\nexport const ImageExtensions: string[] = [\r\n    '3ds',\r\n    'apng',\r\n    'azv',\r\n    'bmp',\r\n    'bmp',\r\n    'btif',\r\n    'cgm',\r\n    'cmx',\r\n    'djv',\r\n    'djvu',\r\n    'drle',\r\n    'dwg',\r\n    'dxf',\r\n    'emf',\r\n    'exr',\r\n    'fbs',\r\n    'fh',\r\n    'fh4',\r\n    'fh5',\r\n    'fh7',\r\n    'fhc',\r\n    'fits',\r\n    'fpx',\r\n    'fst',\r\n    'g3',\r\n    'gif',\r\n    'heic',\r\n    'heics',\r\n    'heif',\r\n    'heifs',\r\n    'ico',\r\n    'ico',\r\n    'ief',\r\n    'jls',\r\n    'jng',\r\n    'jp2',\r\n    'jpe',\r\n    'jpeg',\r\n    'jpf',\r\n    'jpg',\r\n    'jpg2',\r\n    'jpm',\r\n    'jpx',\r\n    'jxr',\r\n    'ktx',\r\n    'mdi',\r\n    'mmr',\r\n    'npx',\r\n    'pbm',\r\n    'pct',\r\n    'pcx',\r\n    'pcx',\r\n    'pgm',\r\n    'pic',\r\n    'png',\r\n    'pnm',\r\n    'ppm',\r\n    'psd',\r\n    'pti',\r\n    'ras',\r\n    'rgb',\r\n    'rlc',\r\n    'sgi',\r\n    'sid',\r\n    'sub',\r\n    'svg',\r\n    'svgz',\r\n    't38',\r\n    'tap',\r\n    'tfx',\r\n    'tga',\r\n    'tif',\r\n    'tiff',\r\n    'uvg',\r\n    'uvi',\r\n    'uvvg',\r\n    'uvvi',\r\n    'vtf',\r\n    'wbmp',\r\n    'wdp',\r\n    'webp',\r\n    'wmf',\r\n    'xbm',\r\n    'xif',\r\n    'xpm',\r\n    'xwd',\r\n];\r\nexport const AudioExtensions: string[] = [\r\n    '3gpp',\r\n    'aac',\r\n    'adp',\r\n    'aif',\r\n    'aifc',\r\n    'aiff',\r\n    'au',\r\n    'caf',\r\n    'dra',\r\n    'dts',\r\n    'dtshd',\r\n    'ecelp4800',\r\n    'ecelp7470',\r\n    'ecelp9600',\r\n    'eol',\r\n    'flac',\r\n    'kar',\r\n    'lvp',\r\n    'm2a',\r\n    'm3a',\r\n    'm3u',\r\n    'm4a',\r\n    'm4a',\r\n    'mid',\r\n    'midi',\r\n    'mka',\r\n    'mp2',\r\n    'mp2a',\r\n    'mp3',\r\n    'mp3',\r\n    'mp4a',\r\n    'mpga',\r\n    'oga',\r\n    'ogg',\r\n    'pya',\r\n    'ra',\r\n    'ra',\r\n    'ram',\r\n    'rip',\r\n    'rmi',\r\n    'rmp',\r\n    's3m',\r\n    'sil',\r\n    'snd',\r\n    'spx',\r\n    'uva',\r\n    'uvva',\r\n    'wav',\r\n    'wav',\r\n    'wav',\r\n    'wax',\r\n    'weba',\r\n    'wma',\r\n    'xm',\r\n];\r\nexport const ColorsLight: string[] = [\r\n    '#bbbbbb',\r\n    '#d65c5c',\r\n    '#d6665c',\r\n    '#d6705c',\r\n    '#d67a5c',\r\n    '#d6855c',\r\n    '#d68f5c',\r\n    '#d6995c',\r\n    '#d6a35c',\r\n    '#d6ad5c',\r\n    '#d6b85c',\r\n    '#d6c25c',\r\n    '#d6cc5c',\r\n    '#d6d65c',\r\n    '#ccd65c',\r\n    '#c2d65c',\r\n    '#b8d65c',\r\n    '#add65c',\r\n    '#a3d65c',\r\n    '#99d65c',\r\n    '#8fd65c',\r\n    '#85d65c',\r\n    '#7ad65c',\r\n    '#70d65c',\r\n    '#66d65c',\r\n    '#5cd65c',\r\n    '#5cd666',\r\n    '#5cd670',\r\n    '#5cd67a',\r\n    '#5cd685',\r\n    '#5cd68f',\r\n    '#5cd699',\r\n    '#5cd6a3',\r\n    '#5cd6ad',\r\n    '#5cd6b8',\r\n    '#5cd6c2',\r\n    '#5cd6cc',\r\n    '#5cd6d6',\r\n    '#5cccd6',\r\n    '#5cc2d6',\r\n    '#5cb8d6',\r\n    '#5cadd6',\r\n    '#5ca3d6',\r\n    '#5c99d6',\r\n    '#5c8fd6',\r\n    '#5c85d6',\r\n    '#5c7ad6',\r\n    '#5c70d6',\r\n    '#5c66d6',\r\n    '#5c5cd6',\r\n    '#665cd6',\r\n    '#705cd6',\r\n    '#7a5cd6',\r\n    '#855cd6',\r\n    '#8f5cd6',\r\n    '#995cd6',\r\n    '#a35cd6',\r\n    '#ad5cd6',\r\n    '#b85cd6',\r\n    '#c25cd6',\r\n    '#cc5cd6',\r\n    '#d65cd6',\r\n    '#d65ccc',\r\n    '#d65cc2',\r\n    '#d65cb8',\r\n    '#d65cad',\r\n    '#d65ca3',\r\n    '#d65c99',\r\n    '#d65c8f',\r\n    '#d65c85',\r\n    '#d65c7a',\r\n    '#d65c70',\r\n    '#d65c66',\r\n];\r\nexport const ColorsDark: string[] = [\r\n    '#777',\r\n    '#8f3d3d',\r\n    '#8f443d',\r\n    '#8f4b3d',\r\n    '#8f523d',\r\n    '#8f583d',\r\n    '#8f5f3d',\r\n    '#8f663d',\r\n    '#8f6d3d',\r\n    '#8f743d',\r\n    '#8f7a3d',\r\n    '#8f813d',\r\n    '#8f883d',\r\n    '#8f8f3d',\r\n    '#888f3d',\r\n    '#818f3d',\r\n    '#7a8f3d',\r\n    '#748f3d',\r\n    '#6d8f3d',\r\n    '#668f3d',\r\n    '#5f8f3d',\r\n    '#588f3d',\r\n    '#528f3d',\r\n    '#4b8f3d',\r\n    '#448f3d',\r\n    '#3d8f3d',\r\n    '#3d8f44',\r\n    '#3d8f4b',\r\n    '#3d8f52',\r\n    '#3d8f58',\r\n    '#3d8f5f',\r\n    '#3d8f66',\r\n    '#3d8f6d',\r\n    '#3d8f74',\r\n    '#3d8f7a',\r\n    '#3d8f81',\r\n    '#3d8f88',\r\n    '#3d8f8f',\r\n    '#3d888f',\r\n    '#3d818f',\r\n    '#3d7a8f',\r\n    '#3d748f',\r\n    '#3d6d8f',\r\n    '#3d668f',\r\n    '#3d5f8f',\r\n    '#3d588f',\r\n    '#3d528f',\r\n    '#3d4b8f',\r\n    '#3d448f',\r\n    '#3d3d8f',\r\n    '#443d8f',\r\n    '#4b3d8f',\r\n    '#523d8f',\r\n    '#583d8f',\r\n    '#5f3d8f',\r\n    '#663d8f',\r\n    '#6d3d8f',\r\n    '#743d8f',\r\n    '#7a3d8f',\r\n    '#813d8f',\r\n    '#883d8f',\r\n    '#8f3d8f',\r\n    '#8f3d88',\r\n    '#8f3d81',\r\n    '#8f3d7a',\r\n    '#8f3d74',\r\n    '#8f3d6d',\r\n    '#8f3d66',\r\n    '#8f3d5f',\r\n    '#8f3d58',\r\n    '#8f3d52',\r\n    '#8f3d4b',\r\n    '#8f3d44',\r\n];\r\n\r\nconst getIconTrie = () => {\r\n    let colourIndex = 0;\r\n    const step = 5;\r\n\r\n    const IconsToExtensions = [\r\n        // Generic file types\r\n        [ChonkyIconName.license, ['license']],\r\n        [ChonkyIconName.config, ['sfk', 'ini', 'yml', 'toml', 'iml']],\r\n        [ChonkyIconName.model, ['3ds', 'obj', 'ply', 'fbx']],\r\n        [ChonkyIconName.database, ['csv', 'json', 'sql', 'sqlite', 'sqlite3', 'npy', 'npz', 'rec', 'idx', 'hdf5']],\r\n        [ChonkyIconName.text, ['txt', 'md', 'mdx']],\r\n        [ChonkyIconName.archive, ['zip', 'rar', 'tar', 'tar.gz', '7z']],\r\n        [ChonkyIconName.image, ImageExtensions],\r\n        [ChonkyIconName.video, VideoExtensions],\r\n        [ChonkyIconName.code, ['html', 'php', 'css', 'sass', 'scss', 'less', 'cpp', 'h', 'hpp', 'c', 'xml']],\r\n        [ChonkyIconName.info, ['bib', 'readme', 'nfo']],\r\n        [ChonkyIconName.key, ['pem', 'pub']],\r\n        [ChonkyIconName.lock, ['lock', 'lock.json', 'shrinkwrap.json']],\r\n        [ChonkyIconName.music, AudioExtensions],\r\n        [ChonkyIconName.terminal, ['run', 'sh']],\r\n        [ChonkyIconName.trash, ['.Trashes']],\r\n        [ChonkyIconName.users, ['authors', 'contributors']],\r\n\r\n        // OS file types\r\n        [ChonkyIconName.linux, ['AppImage']],\r\n        [ChonkyIconName.ubuntu, ['deb']],\r\n        [ChonkyIconName.windows, ['exe']],\r\n\r\n        // Programming language file types\r\n        [ChonkyIconName.rust, ['rs', 'rlib']],\r\n        [ChonkyIconName.python, ['py', 'ipynb']],\r\n        [ChonkyIconName.nodejs, ['js', 'jsx', 'ts', 'tsx', 'd.ts']],\r\n        [ChonkyIconName.php, ['php']],\r\n\r\n        // Development tools file types\r\n        [ChonkyIconName.git, ['.gitignore']],\r\n\r\n        // Brands file types\r\n        [ChonkyIconName.adobe, ['psd']],\r\n\r\n        // Other program file types\r\n        [ChonkyIconName.pdf, ['pdf']],\r\n        [ChonkyIconName.excel, ['xls', 'xlsx']],\r\n        [ChonkyIconName.word, ['doc', 'docx', 'odt']],\r\n        [ChonkyIconName.flash, ['swf']],\r\n    ] as const;\r\n\r\n    const exactTrie = new ExactTrie({ ignoreCase: true });\r\n    for (const pair of IconsToExtensions) {\r\n        const [icon, extensions] = pair;\r\n\r\n        for (let i = 0; i < extensions.length; ++i) {\r\n            colourIndex += step;\r\n            const colorCode = (colourIndex % (ColorsLight.length - 1)) + 1;\r\n            const iconData: FileIconData = {\r\n                icon,\r\n                colorCode,\r\n            };\r\n            exactTrie.put(extensions[i], iconData, true);\r\n        }\r\n    }\r\n\r\n    return exactTrie;\r\n};\r\n\r\nconst iconTrie = getIconTrie();\r\n\r\nexport const useIconData = (file: Nullable<FileData>): FileIconData => {\r\n    return useMemo(() => {\r\n        if (!file) return { icon: ChonkyIconName.loading, colorCode: 0 };\r\n        if (file.isDir === true) return { icon: ChonkyIconName.folder, colorCode: 0 };\r\n\r\n        const match = iconTrie.getWithCheckpoints(file.name, '.', true);\r\n        return match ? match : { icon: ChonkyIconName.file, colorCode: 32 };\r\n    }, [file]);\r\n};\r\n","import { Theme as MuiTheme } from '@mui/material/styles';\r\nimport useMediaQuery from '@mui/material/useMediaQuery';\r\nimport classnames from 'classnames';\r\nimport { createUseStyles } from 'react-jss';\r\nimport { DeepPartial } from 'tsdef';\r\n\r\nexport const lightTheme = {\r\n    colors: {\r\n        debugRed: '#fabdbd',\r\n        debugBlue: '#bdd8fa',\r\n        debugGreen: '#d2fabd',\r\n        debugPurple: '#d2bdfa',\r\n        debugYellow: '#fae9bd',\r\n\r\n        textActive: '#09f',\r\n    },\r\n\r\n    fontSizes: {\r\n        rootPrimary: 15,\r\n    },\r\n\r\n    margins: {\r\n        rootLayoutMargin: 8,\r\n    },\r\n\r\n    toolbar: {\r\n        size: 30,\r\n        lineHeight: '30px', // `px` suffix is required for `line-height` fields to work\r\n        fontSize: 15,\r\n        buttonRadius: 4,\r\n    },\r\n\r\n    dnd: {\r\n        canDropColor: 'green',\r\n        cannotDropColor: 'red',\r\n        canDropMask: 'rgba(180, 235, 180, 0.75)',\r\n        cannotDropMask: 'rgba(235, 180, 180, 0.75)',\r\n        fileListCanDropMaskOne: 'rgba(180, 235, 180, 0.1)',\r\n        fileListCanDropMaskTwo: 'rgba(180, 235, 180, 0.2)',\r\n        fileListCannotDropMaskOne: 'rgba(235, 180, 180, 0.1)',\r\n        fileListCannotDropMaskTwo: 'rgba(235, 180, 180, 0.2)',\r\n    },\r\n\r\n    dragLayer: {\r\n        border: 'solid 2px #09f',\r\n        padding: '7px 10px',\r\n        borderRadius: 2,\r\n    },\r\n\r\n    fileList: {\r\n        desktopGridGutter: 8,\r\n        mobileGridGutter: 5,\r\n    },\r\n\r\n    gridFileEntry: {\r\n        childrenCountSize: '1.6em',\r\n        iconColorFocused: '#000',\r\n        iconSize: '2.4em',\r\n        iconColor: '#fff',\r\n        borderRadius: 5,\r\n        fontSize: 14,\r\n\r\n        fileColorTint: 'rgba(255, 255, 255, 0.4)',\r\n        folderBackColorTint: 'rgba(255, 255, 255, 0.1)',\r\n        folderFrontColorTint: 'rgba(255, 255, 255, 0.4)',\r\n    },\r\n\r\n    listFileEntry: {\r\n        propertyFontSize: 14,\r\n        iconFontSize: '1.1em',\r\n        iconBorderRadius: 5,\r\n        fontSize: 14,\r\n    },\r\n};\r\n\r\nexport type ChonkyTheme = typeof lightTheme;\r\n\r\nexport const darkThemeOverride: DeepPartial<ChonkyTheme> = {\r\n    gridFileEntry: {\r\n        fileColorTint: 'rgba(50, 50, 50, 0.4)',\r\n        folderBackColorTint: 'rgba(50, 50, 50, 0.4)',\r\n        folderFrontColorTint: 'rgba(50, 50, 50, 0.15)',\r\n    },\r\n};\r\n\r\nexport const mobileThemeOverride: DeepPartial<ChonkyTheme> = {\r\n    fontSizes: {\r\n        rootPrimary: 13,\r\n    },\r\n    margins: {\r\n        rootLayoutMargin: 4,\r\n    },\r\n    toolbar: {\r\n        size: 28,\r\n        lineHeight: '28px',\r\n        fontSize: 13,\r\n    },\r\n    gridFileEntry: {\r\n        fontSize: 13,\r\n    },\r\n    listFileEntry: {\r\n        propertyFontSize: 12,\r\n        iconFontSize: '1em',\r\n        fontSize: 13,\r\n    },\r\n};\r\n\r\nexport const useIsMobileBreakpoint = () => {\r\n    return useMediaQuery('(max-width:480px)');\r\n};\r\n\r\nexport const getStripeGradient = (colorOne: string, colorTwo: string) =>\r\n    'repeating-linear-gradient(' +\r\n    '45deg,' +\r\n    `${colorOne},` +\r\n    `${colorOne} 10px,` +\r\n    `${colorTwo} 0,` +\r\n    `${colorTwo} 20px` +\r\n    ')';\r\n\r\nexport const makeLocalChonkyStyles = <C extends string = string>(\r\n    styles: (theme: ChonkyTheme & MuiTheme) => any\r\n    // @ts-ignore\r\n): any => createUseStyles<ChonkyTheme, C>(styles);\r\n\r\nexport const makeGlobalChonkyStyles = <C extends string = string>(\r\n    makeStyles: (theme: ChonkyTheme & MuiTheme) => any\r\n) => {\r\n    const selectorMapping = {};\r\n    const makeGlobalStyles = (theme: ChonkyTheme) => {\r\n        const localStyles = makeStyles(theme as any);\r\n        const globalStyles = {};\r\n        const localSelectors = Object.keys(localStyles);\r\n        localSelectors.map(localSelector => {\r\n            const globalSelector = `chonky-${localSelector}`;\r\n            const jssSelector = `@global .${globalSelector}`;\r\n            // @ts-ignore\r\n            globalStyles[jssSelector] = localStyles[localSelector];\r\n            // @ts-ignore\r\n            selectorMapping[localSelector] = globalSelector;\r\n        });\r\n        return globalStyles;\r\n    };\r\n\r\n    // @ts-ignore\r\n    const useStyles = createUseStyles<ChonkyTheme, C>(makeGlobalStyles as any);\r\n    return (...args: any[]): any => {\r\n        const styles = useStyles(...args);\r\n        const classes = {};\r\n        Object.keys(selectorMapping).map(localSelector => {\r\n            // @ts-ignore\r\n            classes[localSelector] = selectorMapping[localSelector];\r\n        });\r\n        return { ...classes, ...styles };\r\n    };\r\n};\r\n\r\nexport const important = <T>(value: T) => [value, '!important'];\r\n\r\nexport const c = classnames;\r\n","import React, { useImperativeHandle } from 'react';\r\nimport { useDispatch, useStore } from 'react-redux';\r\n\r\nimport { reduxActions } from '../redux/reducers';\r\nimport { selectSelectionMap } from '../redux/selectors';\r\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\r\nimport { FileAction } from '../types/action.types';\r\nimport { FileBrowserHandle } from '../types/file-browser.types';\r\nimport { RootState } from '../types/redux.types';\r\n\r\nexport const useFileBrowserHandle = (ref: React.Ref<FileBrowserHandle>) => {\r\n    const store = useStore<RootState>();\r\n    const dispatch = useDispatch();\r\n\r\n    useImperativeHandle(\r\n        ref,\r\n        () => ({\r\n            getFileSelection(): Set<string> {\r\n                const selectionMap = selectSelectionMap(store.getState());\r\n                const selectionSet = new Set(Object.keys(selectionMap));\r\n                return selectionSet;\r\n            },\r\n            setFileSelection(selection, reset = true): void {\r\n                const fileIds = Array.from(selection);\r\n                dispatch(reduxActions.selectFiles({ fileIds, reset }));\r\n            },\r\n            requestFileAction<Action extends FileAction>(\r\n                action: Action,\r\n                payload: Action['__payloadType']\r\n            ): Promise<void> {\r\n                return Promise.resolve(\r\n                    dispatch(thunkRequestFileAction(action, payload))\r\n                ).then();\r\n            },\r\n        }),\r\n        [store, dispatch]\r\n    );\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport { reduxActions } from '../../redux/reducers';\r\nimport { initialRootState } from '../../redux/state';\r\nimport { useDTE, usePropReduxUpdate } from '../../redux/store';\r\nimport {\r\n    thunkActivateSortAction, thunkUpdateDefaultFileViewActionId, thunkUpdateRawFileActions\r\n} from '../../redux/thunks/file-actions.thunks';\r\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\r\nimport { defaultConfig } from '../../util/default-config';\r\nimport { useFileBrowserHandle } from '../../util/file-browser-handle';\r\nimport { getValueOrFallback } from '../../util/helpers';\r\n\r\nexport const ChonkyBusinessLogicInner = React.memo(\r\n    React.forwardRef<FileBrowserHandle, FileBrowserProps>((props, ref) => {\r\n        // ==== Update Redux state\r\n        usePropReduxUpdate(reduxActions.setRawFiles, props.files ?? initialRootState.rawFiles);\r\n        usePropReduxUpdate(reduxActions.setRawFolderChain, props.folderChain);\r\n        useDTE(\r\n            thunkUpdateRawFileActions,\r\n            getValueOrFallback(props.fileActions, defaultConfig.fileActions),\r\n            getValueOrFallback(props.disableDefaultFileActions, defaultConfig.disableDefaultFileActions)\r\n        );\r\n        useDTE(\r\n            reduxActions.setExternalFileActionHandler,\r\n            getValueOrFallback(props.onFileAction, defaultConfig.onFileAction) as any\r\n        );\r\n        useDTE(\r\n            reduxActions.setSelectionDisabled,\r\n            getValueOrFallback(props.disableSelection, defaultConfig.disableSelection, 'boolean')\r\n        );\r\n        useDTE(\r\n            thunkActivateSortAction,\r\n            getValueOrFallback(props.defaultSortActionId, defaultConfig.defaultSortActionId)\r\n        );\r\n        useDTE(\r\n            thunkUpdateDefaultFileViewActionId,\r\n            getValueOrFallback(props.defaultFileViewActionId, defaultConfig.defaultFileViewActionId, 'string')\r\n        );\r\n\r\n        useDTE(\r\n            reduxActions.setThumbnailGenerator,\r\n            getValueOrFallback(props.thumbnailGenerator, defaultConfig.thumbnailGenerator)\r\n        );\r\n        useDTE(\r\n            reduxActions.setDoubleClickDelay,\r\n            getValueOrFallback(props.doubleClickDelay, defaultConfig.doubleClickDelay, 'number')\r\n        );\r\n        useDTE(\r\n            reduxActions.setDisableDragAndDrop,\r\n            getValueOrFallback(props.disableDragAndDrop, defaultConfig.disableDragAndDrop, 'boolean')\r\n        );\r\n        useDTE(\r\n            reduxActions.setClearSelectionOnOutsideClick,\r\n            getValueOrFallback(\r\n                props.clearSelectionOnOutsideClick,\r\n                defaultConfig.clearSelectionOnOutsideClick,\r\n                'boolean'\r\n            )\r\n        );\r\n\r\n        // ==== Setup the imperative handle for external use\r\n        useFileBrowserHandle(ref);\r\n\r\n        return null;\r\n    })\r\n);\r\nChonkyBusinessLogicInner.displayName = 'ChonkyBusinessLogicInner';\r\n\r\nexport const ChonkyBusinessLogic = React.memo(ChonkyBusinessLogicInner);\r\nChonkyBusinessLogic.displayName = 'ChonkyBusinessLogic';\r\n","import { useCallback, useContext } from 'react';\r\nimport { DndContext, useDrag, useDrop } from 'react-dnd';\r\n\r\nexport const useDndContextAvailable = () => {\r\n    const dndContext = useContext(DndContext);\r\n    const { dragDropManager } = dndContext;\r\n    return !!dragDropManager;\r\n};\r\n\r\nexport const useDragIfAvailable: typeof useDrag = (...args) => {\r\n    // This is an ugly hack to make `useDrag` not throw if a `DndContext` is not available.\r\n    // See: https://github.com/react-dnd/react-dnd/issues/2212\r\n    const dndContextAvailable = useDndContextAvailable();\r\n    const mockHook = useCallback(() => [{} as any, () => null, () => null], []);\r\n    // @ts-ignore\r\n    const useHook: typeof useDrag = dndContextAvailable ? useDrag : mockHook;\r\n    return useHook(...args);\r\n};\r\n\r\nexport const useDropIfAvailable: typeof useDrop = (...args) => {\r\n    const dndContextAvailable = useDndContextAvailable();\r\n    const mockHook = useCallback(() => [{} as any, () => null], []);\r\n    // @ts-ignore\r\n    const useHook: typeof useDrop = dndContextAvailable ? useDrop : mockHook;\r\n    return useHook(...args);\r\n};\r\n","import React, { useCallback } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { ChonkyActions } from '../../action-definitions/index';\r\nimport { reduxActions } from '../../redux/reducers';\r\nimport { selectContextMenuMounted } from '../../redux/selectors';\r\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\r\nimport { findElementAmongAncestors } from '../../util/helpers';\r\nimport { useInstanceVariable } from '../../util/hooks-helpers';\r\n\r\nexport const findClosestChonkyFileId = (\r\n    element: HTMLElement | any\r\n): Nullable<string> => {\r\n    const fileEntryWrapperDiv = findElementAmongAncestors(\r\n        element,\r\n        (element: any) =>\r\n            element.tagName &&\r\n            element.tagName.toLowerCase() === 'div' &&\r\n            element.dataset &&\r\n            element.dataset.chonkyFileId\r\n    );\r\n    return fileEntryWrapperDiv ? fileEntryWrapperDiv.dataset.chonkyFileId! : null;\r\n};\r\n\r\nexport const useContextMenuTrigger = () => {\r\n    const dispatch = useDispatch();\r\n    const contextMenuMountedRef = useInstanceVariable(\r\n        useSelector(selectContextMenuMounted)\r\n    );\r\n    return useCallback(\r\n        (event: React.MouseEvent<HTMLDivElement>) => {\r\n            // Use default browser context menu when Chonky context menu component\r\n            // is not mounted.\r\n            if (!contextMenuMountedRef.current) return;\r\n            // Users can use Alt+Right Click to bring up browser's default\r\n            // context menu instead of Chonky's context menu.\r\n            if (event.altKey) return;\r\n\r\n            event.preventDefault();\r\n\r\n            const triggerFileId = findClosestChonkyFileId(event.target);\r\n            dispatch(\r\n                thunkRequestFileAction(ChonkyActions.OpenFileContextMenu, {\r\n                    clientX: event.clientX,\r\n                    clientY: event.clientY,\r\n                    triggerFileId,\r\n                })\r\n            );\r\n        },\r\n        [contextMenuMountedRef, dispatch]\r\n    );\r\n};\r\n\r\nexport const useContextMenuDismisser = () => {\r\n    const dispatch = useDispatch();\r\n    return useCallback(() => dispatch(reduxActions.hideContextMenu()), [dispatch]);\r\n};\r\n","import { DragObjectWithType } from 'react-dnd';\r\nimport { Nilable } from 'tsdef';\r\n\r\nimport { StartDragNDropPayload } from './action-payloads.types';\r\nimport { FileData } from './file.types';\r\n\r\nexport interface ChonkyDndDropResult {\r\n    dropTarget: Nilable<FileData> | any;\r\n    dropEffect: 'move' | 'copy';\r\n}\r\n\r\nexport type ChonkyDndFileEntryItem = DragObjectWithType & {\r\n    payload: StartDragNDropPayload;\r\n};\r\nexport const ChonkyDndFileEntryType = 'dnd-chonky-file-entry';\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\nimport { useDragLayer } from 'react-dnd';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { ChonkyDndFileEntryItem, ChonkyDndFileEntryType } from '../../types/dnd.types';\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface DnDFileListDragLayerProps {}\r\n\r\nconst layerStyles: React.CSSProperties = {\r\n    position: 'fixed',\r\n    pointerEvents: 'none',\r\n    zIndex: 100,\r\n    left: 0,\r\n    top: 0,\r\n    width: '100%',\r\n    height: '100%',\r\n};\r\nconst getItemStyles = (\r\n    initialCursorOffset: Nullable<{ x: number; y: number }>,\r\n    initialFileOffset: Nullable<{ x: number; y: number }>,\r\n    currentFileOffset: Nullable<{ x: number; y: number }>\r\n) => {\r\n    if (!initialCursorOffset || !initialFileOffset || !currentFileOffset) {\r\n        return {\r\n            display: 'none',\r\n        };\r\n    }\r\n    const x = initialCursorOffset.x + (currentFileOffset.x - initialFileOffset.x);\r\n    const y = initialCursorOffset.y + (currentFileOffset.y - initialFileOffset.y);\r\n    const transform = `translate(${x}px, ${y}px)`;\r\n    return {\r\n        transform,\r\n        WebkitTransform: transform,\r\n    };\r\n};\r\n\r\nexport const DnDFileListDragLayer: React.FC<DnDFileListDragLayerProps> = () => {\r\n    const classes = useStyles();\r\n\r\n    const {\r\n        itemType,\r\n        item,\r\n        initialCursorOffset,\r\n        initialFileOffset,\r\n        currentFileOffset,\r\n        isDragging,\r\n    } = useDragLayer(monitor => ({\r\n        item: monitor.getItem() as ChonkyDndFileEntryItem,\r\n        itemType: monitor.getItemType(),\r\n        initialCursorOffset: monitor.getInitialClientOffset(),\r\n        initialFileOffset: monitor.getInitialSourceClientOffset(),\r\n        currentFileOffset: monitor.getSourceClientOffset(),\r\n        isDragging: monitor.isDragging(),\r\n    }));\r\n    if (!isDragging || itemType !== ChonkyDndFileEntryType || !item.payload) {\r\n        return null;\r\n    }\r\n\r\n    const selectionSize = item.payload.selectedFiles.length;\r\n    return (\r\n        <div style={layerStyles}>\r\n            <div\r\n                style={getItemStyles(\r\n                    initialCursorOffset,\r\n                    initialFileOffset,\r\n                    currentFileOffset\r\n                )}\r\n            >\r\n                <div className={classes.fileDragPreview}>\r\n                    <b>{item.payload.draggedFile.name}</b>\r\n                    {selectionSize > 1 && (\r\n                        <>\r\n                            {' and '}\r\n                            <strong>\r\n                                {selectionSize - 1} other file\r\n                                {selectionSize - 1 !== 1 ? 's' : ''}\r\n                            </strong>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    fileDragPreview: {\r\n        boxShadow: `2px 2px 5px ${theme.palette.divider}`,\r\n        backgroundColor: theme.palette.background.default,\r\n        borderRadius: theme.dragLayer.borderRadius,\r\n        fontSize: theme.fontSizes.rootPrimary,\r\n        color: theme.palette.text.primary,\r\n        padding: theme.dragLayer.padding,\r\n        border: theme.dragLayer.border,\r\n        display: 'inline-block',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport hotkeys from 'hotkeys-js';\r\nimport React, { useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\n\r\nimport { selectFileActionData } from '../../redux/selectors';\r\nimport { useParamSelector } from '../../redux/store';\r\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\r\n\r\nexport interface HotkeyListenerProps {\r\n    fileActionId: string;\r\n}\r\n\r\nexport const HotkeyListener: React.FC<HotkeyListenerProps> = React.memo(props => {\r\n    const { fileActionId } = props;\r\n\r\n    const dispatch = useDispatch();\r\n    const fileAction = useParamSelector(selectFileActionData, fileActionId);\r\n\r\n    useEffect(() => {\r\n        if (!fileAction || !fileAction.hotkeys || fileAction.hotkeys.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const hotkeysStr = fileAction.hotkeys.join(',');\r\n        const hotkeyCallback = (event: KeyboardEvent) => {\r\n            event.preventDefault();\r\n            dispatch(thunkRequestFileAction(fileAction, undefined));\r\n        };\r\n        hotkeys(hotkeysStr, hotkeyCallback);\r\n        return () => hotkeys.unbind(hotkeysStr, hotkeyCallback);\r\n    }, [dispatch, fileAction]);\r\n\r\n    return null;\r\n});\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport Box from '@mui/material/Box';\r\nimport ClickAwayListener from '@mui/material/ClickAwayListener';\r\nimport React, { useCallback, useMemo } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport { reduxActions } from '../../redux/reducers';\r\nimport {\r\n    selectClearSelectionOnOutsideClick,\r\n    selectFileActionIds,\r\n    selectIsDnDDisabled,\r\n} from '../../redux/selectors';\r\nimport { useDndContextAvailable } from '../../util/dnd-fallback';\r\nimport { elementIsInsideButton } from '../../util/helpers';\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { useContextMenuTrigger } from '../external/FileContextMenu-hooks';\r\nimport { DnDFileListDragLayer } from '../file-list/DnDFileListDragLayer';\r\nimport { HotkeyListener } from './HotkeyListener';\r\n\r\nexport interface ChonkyPresentationLayerProps {}\r\n\r\nexport const ChonkyPresentationLayer: React.FC<ChonkyPresentationLayerProps> = ({\r\n    children,\r\n}) => {\r\n    const dispatch = useDispatch();\r\n    const fileActionIds = useSelector(selectFileActionIds);\r\n    const dndDisabled = useSelector(selectIsDnDDisabled);\r\n    const clearSelectionOnOutsideClick = useSelector(\r\n        selectClearSelectionOnOutsideClick\r\n    );\r\n\r\n    // Deal with clicks outside of Chonky\r\n    const handleClickAway = useCallback(\r\n        (event: MouseEvent | TouchEvent) => {\r\n            if (!clearSelectionOnOutsideClick || elementIsInsideButton(event.target)) {\r\n                // We only clear out the selection on outside click if the click target\r\n                // was not a button. We don't want to clear out the selection when a\r\n                // button is clicked because Chonky users might want to trigger some\r\n                // selection-related action on that button click.\r\n                return;\r\n            }\r\n            dispatch(reduxActions.clearSelection());\r\n        },\r\n        [dispatch, clearSelectionOnOutsideClick]\r\n    );\r\n\r\n    // Generate necessary components\r\n    const hotkeyListenerComponents = useMemo(\r\n        () =>\r\n            fileActionIds.map(actionId => (\r\n                <HotkeyListener\r\n                    key={`file-action-listener-${actionId}`}\r\n                    fileActionId={actionId}\r\n                />\r\n            )),\r\n        [fileActionIds]\r\n    );\r\n\r\n    const dndContextAvailable = useDndContextAvailable();\r\n    const showContextMenu = useContextMenuTrigger();\r\n\r\n    const classes = useStyles();\r\n    return (\r\n        <ClickAwayListener onClickAway={handleClickAway}>\r\n            <Box className={classes.chonkyRoot} onContextMenu={showContextMenu}>\r\n                {!dndDisabled && dndContextAvailable && <DnDFileListDragLayer />}\r\n                {hotkeyListenerComponents}\r\n                {children ? children : null}\r\n            </Box>\r\n        </ClickAwayListener>\r\n    );\r\n};\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    chonkyRoot: {\r\n        backgroundColor: theme.palette.background.paper,\r\n        border: `solid 1px ${theme.palette.divider}`,\r\n        padding: theme.margins.rootLayoutMargin,\r\n        fontSize: theme.fontSizes.rootPrimary,\r\n        color: theme.palette.text.primary,\r\n        touchAction: 'manipulation', // Disabling zoom on double tap\r\n        fontFamily: 'sans-serif',\r\n        flexDirection: 'column',\r\n        boxSizing: 'border-box',\r\n        textAlign: 'left',\r\n        borderRadius: 4,\r\n        display: 'flex',\r\n        height: '100%',\r\n\r\n        // Disabling select\r\n        webkitTouchCallout: 'none',\r\n        webkitUserSelect: 'none',\r\n        mozUserSelect: 'none',\r\n        msUserSelect: 'none',\r\n        userSelect: 'none',\r\n    },\r\n}));\r\n","import {\r\n    createTheme,\r\n    ThemeProvider as MuiThemeProvider,\r\n    StyledEngineProvider,\r\n} from '@mui/material/styles';\r\nimport merge from 'deepmerge';\r\nimport React, { ReactNode, useMemo } from 'react';\r\nimport { DndProvider } from 'react-dnd';\r\nimport { HTML5Backend } from 'react-dnd-html5-backend';\r\nimport { IntlProvider } from 'react-intl';\r\nimport { ThemeProvider } from 'react-jss';\r\nimport { Provider as ReduxProvider } from 'react-redux';\r\nimport shortid from 'shortid';\r\n\r\nimport { useChonkyStore } from '../../redux/store';\r\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\r\nimport { defaultConfig } from '../../util/default-config';\r\nimport { getValueOrFallback } from '../../util/helpers';\r\nimport { useStaticValue } from '../../util/hooks-helpers';\r\nimport { ChonkyFormattersContext, defaultFormatters } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport {\r\n    darkThemeOverride,\r\n    lightTheme,\r\n    mobileThemeOverride,\r\n    useIsMobileBreakpoint,\r\n} from '../../util/styles';\r\nimport { ChonkyBusinessLogic } from '../internal/ChonkyBusinessLogic';\r\nimport { ChonkyIconPlaceholder } from '../internal/ChonkyIconPlaceholder';\r\nimport { ChonkyPresentationLayer } from '../internal/ChonkyPresentationLayer';\r\n\r\n\r\n// if (process.env.NODE_ENV === 'development') {\r\n//     const whyDidYouRender = require('@welldone-software/why-did-you-render');\r\n//     whyDidYouRender(React, {\r\n//         trackAllPureComponents: true,\r\n//     });\r\n// }\r\n\r\nexport const FileBrowser = React.forwardRef<\r\n    FileBrowserHandle,\r\n    FileBrowserProps & { children?: ReactNode }\r\n>((props, ref) => {\r\n    const { instanceId, iconComponent, children } = props;\r\n    const disableDragAndDrop = getValueOrFallback(\r\n        props.disableDragAndDrop,\r\n        defaultConfig.disableDragAndDrop,\r\n        'boolean'\r\n    );\r\n    const disableDragAndDropProvider = getValueOrFallback(\r\n        props.disableDragAndDropProvider,\r\n        defaultConfig.disableDragAndDropProvider,\r\n        'boolean'\r\n    );\r\n    const darkMode = getValueOrFallback(\r\n        props.darkMode,\r\n        defaultConfig.darkMode,\r\n        'boolean'\r\n    );\r\n    const i18n = getValueOrFallback(props.i18n, defaultConfig.i18n);\r\n    const formatters = useMemo(() => ({ ...defaultFormatters, ...i18n?.formatters }), [\r\n        i18n,\r\n    ]);\r\n\r\n    const chonkyInstanceId = useStaticValue(() => instanceId ?? shortid.generate());\r\n    const store = useChonkyStore(chonkyInstanceId);\r\n\r\n    const isMobileBreakpoint = useIsMobileBreakpoint();\r\n    const theme = useMemo(() => {\r\n        const muiTheme = createTheme({\r\n            palette: {\r\n                mode: darkMode ? 'dark' : 'light',\r\n                background: {\r\n                    default: darkMode ? '#424242' : '#fff',\r\n                    paper:  darkMode ? '#424242' : '#fff'\r\n                }\r\n            }\r\n        });\r\n        const combinedTheme = merge(\r\n            muiTheme,\r\n            merge(lightTheme, darkMode ? darkThemeOverride : {})\r\n        );\r\n        return isMobileBreakpoint\r\n            ? merge(combinedTheme, mobileThemeOverride)\r\n            : combinedTheme;\r\n    }, [darkMode, isMobileBreakpoint]);\r\n\r\n    const chonkyComps = (\r\n        <>\r\n            <ChonkyBusinessLogic ref={ref} {...props} />\r\n            <ChonkyPresentationLayer>{children}</ChonkyPresentationLayer>\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <IntlProvider locale=\"en\" defaultLocale=\"en\" {...i18n}>\r\n            <ChonkyFormattersContext.Provider value={formatters}>\r\n                <ReduxProvider store={store}>\r\n                    <ThemeProvider theme={theme}>\r\n                        <StyledEngineProvider injectFirst>\r\n                            <MuiThemeProvider theme={theme}>\r\n                                <ChonkyIconContext.Provider\r\n                                    value={\r\n                                        iconComponent ??\r\n                                        defaultConfig.iconComponent ??\r\n                                        ChonkyIconPlaceholder\r\n                                    }\r\n                                >\r\n                                    {disableDragAndDrop || disableDragAndDropProvider ? (\r\n                                        chonkyComps\r\n                                    ) : (\r\n                                        <DndProvider backend={HTML5Backend}>\r\n                                            {chonkyComps}\r\n                                        </DndProvider>\r\n                                    )}\r\n                                </ChonkyIconContext.Provider>\r\n                            </MuiThemeProvider>\r\n                        </StyledEngineProvider>\r\n                    </ThemeProvider>\r\n                </ReduxProvider>\r\n            </ChonkyFormattersContext.Provider>\r\n        </IntlProvider>\r\n    );\r\n});\r\nFileBrowser.displayName = 'FileBrowser';\r\n","import { useMemo } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { ChonkyActions } from '../../action-definitions/index';\r\nimport { selectFolderChain } from '../../redux/selectors';\r\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\r\nimport { FileData } from '../../types/file.types';\r\nimport { FileHelper } from '../../util/file-helper';\r\n\r\nexport interface FolderChainItem {\r\n    file: Nullable<FileData>;\r\n    disabled: boolean;\r\n    onClick?: () => void;\r\n}\r\n\r\nexport const useFolderChainItems = (): FolderChainItem[] => {\r\n    const folderChain = useSelector(selectFolderChain);\r\n    const dispatch = useDispatch();\r\n\r\n    const folderChainItems = useMemo(() => {\r\n        const items: FolderChainItem[] = [];\r\n        if (!folderChain) return items;\r\n\r\n        for (let i = 0; i < folderChain.length; ++i) {\r\n            const file = folderChain[i];\r\n            items.push({\r\n                file,\r\n                disabled: !file,\r\n                onClick:\r\n                    !FileHelper.isOpenable(file) || i === folderChain.length - 1\r\n                        ? undefined\r\n                        : () =>\r\n                              dispatch(\r\n                                  thunkRequestFileAction(ChonkyActions.OpenFiles, {\r\n                                      targetFile: file,\r\n                                      files: [file],\r\n                                  })\r\n                              ),\r\n            });\r\n        }\r\n        return items;\r\n    }, [dispatch, folderChain]);\r\n    return folderChainItems;\r\n};\r\n","import { useCallback, useEffect, useMemo } from 'react';\r\nimport { DragSourceMonitor, DropTargetMonitor } from 'react-dnd';\r\nimport { getEmptyImage } from 'react-dnd-html5-backend';\r\nimport { useDispatch, useSelector, useStore } from 'react-redux';\r\nimport { ExcludeKeys, Nullable } from 'tsdef';\r\n\r\nimport { EssentialActions } from '../action-definitions/essential';\r\nimport { ChonkyActions } from '../action-definitions/index';\r\nimport {\r\n    selectCurrentFolder,\r\n    selectFolderChain,\r\n    selectInstanceId,\r\n    selectSelectedFiles,\r\n} from '../redux/selectors';\r\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\r\nimport { StartDragNDropPayload } from '../types/action-payloads.types';\r\nimport {\r\n    ChonkyDndDropResult,\r\n    ChonkyDndFileEntryItem,\r\n    ChonkyDndFileEntryType,\r\n} from '../types/dnd.types';\r\nimport { DndEntryState } from '../types/file-list.types';\r\nimport { FileData } from '../types/file.types';\r\nimport { useDragIfAvailable, useDropIfAvailable } from './dnd-fallback';\r\nimport { FileHelper } from './file-helper';\r\nimport { useInstanceVariable } from './hooks-helpers';\r\n\r\nexport const useFileDrag = (file: Nullable<FileData>) => {\r\n    // Prepare the dnd payload\r\n    const store = useStore();\r\n    const fileRef = useInstanceVariable(file);\r\n    const getDndStartPayload = useCallback<() => StartDragNDropPayload>(() => {\r\n        const reduxState = store.getState();\r\n        return {\r\n            sourceInstanceId: selectInstanceId(reduxState),\r\n            source: selectCurrentFolder(reduxState),\r\n            // We force non-null type below because by convention, if drag & drop for\r\n            // this file was possible, it must have been non-null.\r\n            draggedFile: fileRef.current!,\r\n            selectedFiles: selectSelectedFiles(reduxState),\r\n        };\r\n    }, [store, fileRef]);\r\n\r\n    // For drag source\r\n    const dispatch = useDispatch();\r\n    const canDrag = useCallback(() => FileHelper.isDraggable(fileRef.current), [\r\n        fileRef,\r\n    ]);\r\n    const onDragStart = useCallback((): ChonkyDndFileEntryItem => {\r\n        const item: ChonkyDndFileEntryItem = {\r\n            type: ChonkyDndFileEntryType,\r\n            payload: getDndStartPayload(),\r\n        };\r\n        dispatch(thunkRequestFileAction(ChonkyActions.StartDragNDrop, item.payload));\r\n        return item;\r\n    }, [dispatch, getDndStartPayload]);\r\n    const onDragEnd = useCallback(\r\n        (item: ChonkyDndFileEntryItem, monitor: DragSourceMonitor) => {\r\n            const dropResult = monitor.getDropResult() as ChonkyDndDropResult;\r\n            if (\r\n                !FileHelper.isDraggable(item.payload.draggedFile) ||\r\n                !dropResult ||\r\n                !dropResult.dropTarget\r\n            ) {\r\n                return;\r\n            }\r\n\r\n            dispatch(\r\n                thunkRequestFileAction(ChonkyActions.EndDragNDrop, {\r\n                    ...item.payload,\r\n                    destination: dropResult.dropTarget,\r\n                    copy: dropResult.dropEffect === 'copy',\r\n                })\r\n            );\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    // Create refs for react-dnd hooks\r\n    const item = useMemo<ChonkyDndFileEntryItem>(\r\n        () => ({\r\n            type: ChonkyDndFileEntryType,\r\n            // Payload is actually added in `onDragStart`\r\n            payload: {} as StartDragNDropPayload,\r\n        }),\r\n        []\r\n    );\r\n    const collect = useCallback(monitor => ({ isDragging: monitor.isDragging() }), []);\r\n    const [{ isDragging: dndIsDragging }, drag, preview] = useDragIfAvailable({\r\n        item,\r\n        canDrag,\r\n        begin: onDragStart,\r\n        // @ts-ignore\r\n        end: onDragEnd,\r\n        collect,\r\n    });\r\n\r\n    useEffect(() => {\r\n        // Set drag preview to an empty image because `DnDFileListDragLayer` will\r\n        // provide its own preview.\r\n        preview(getEmptyImage(), { captureDraggingState: true });\r\n    }, [preview]);\r\n\r\n    return { dndIsDragging, drag };\r\n};\r\n\r\ninterface UseFileDropParams {\r\n    file: Nullable<FileData>;\r\n    forceDisableDrop?: boolean;\r\n    includeChildrenDrops?: boolean;\r\n}\r\n\r\nexport const useFileDrop = ({\r\n    file,\r\n    forceDisableDrop,\r\n    includeChildrenDrops,\r\n}: UseFileDropParams) => {\r\n    const folderChainRef = useInstanceVariable(useSelector(selectFolderChain));\r\n    const onDrop = useCallback(\r\n        (_item: ChonkyDndFileEntryItem, monitor) => {\r\n            if (!monitor.canDrop()) return;\r\n            const customDropResult: ExcludeKeys<ChonkyDndDropResult, 'dropEffect'> = {\r\n                dropTarget: file,\r\n            };\r\n            return customDropResult;\r\n        },\r\n        [file]\r\n    );\r\n    const canDrop = useCallback(\r\n        (item: ChonkyDndFileEntryItem, monitor: DropTargetMonitor) => {\r\n            if (\r\n                forceDisableDrop ||\r\n                !FileHelper.isDroppable(file) ||\r\n                (!monitor.isOver({ shallow: true }) && !includeChildrenDrops)\r\n            ) {\r\n                return false;\r\n            }\r\n            const { source, draggedFile, selectedFiles } = item.payload;\r\n\r\n            // We prevent folders from being dropped into themselves. We also prevent\r\n            // any folder from current folder chain being moved - we can't move the\r\n            // folder that we are currently in.\r\n            const prohibitedFileIds = new Set<string>();\r\n            prohibitedFileIds.add(file.id);\r\n            folderChainRef.current.map(folder => {\r\n                if (folder) prohibitedFileIds.add(folder.id);\r\n            });\r\n            const movedFiles: FileData[] = [draggedFile, ...selectedFiles];\r\n            for (const currFile of movedFiles) {\r\n                if (prohibitedFileIds.has(currFile.id)) return false;\r\n            }\r\n\r\n            // Finally, prohibit files from being moved into their parent folder\r\n            // (which is a no-op).\r\n            return file.id !== source?.id;\r\n        },\r\n        [forceDisableDrop, file, includeChildrenDrops, folderChainRef]\r\n    );\r\n    const collect = useCallback(\r\n        monitor => ({\r\n            isOver: monitor.isOver(),\r\n            isOverCurrent: monitor.isOver({ shallow: true }),\r\n            canDrop: monitor.canDrop(),\r\n        }),\r\n        []\r\n    );\r\n    const [\r\n        { isOver: dndIsOver, isOverCurrent: dndIsOverCurrent, canDrop: dndCanDrop },\r\n        drop,\r\n    ] = useDropIfAvailable({\r\n        accept: ChonkyDndFileEntryType,\r\n        drop: onDrop,\r\n        canDrop,\r\n        collect,\r\n    });\r\n    return { dndIsOver, dndIsOverCurrent, dndCanDrop, drop };\r\n};\r\n\r\nexport const useFileEntryDnD = (file: Nullable<FileData>) => {\r\n    const { dndIsDragging, drag } = useFileDrag(file);\r\n    const { dndIsOver, dndCanDrop, drop } = useFileDrop({ file });\r\n    const dndState = useMemo<DndEntryState>(\r\n        () => ({\r\n            dndIsDragging,\r\n            dndIsOver,\r\n            dndCanDrop,\r\n        }),\r\n        [dndCanDrop, dndIsDragging, dndIsOver]\r\n    );\r\n    return {\r\n        drop,\r\n        drag,\r\n        dndState,\r\n    };\r\n};\r\n\r\nexport const useDndHoverOpen = (file: Nullable<FileData>, dndState: DndEntryState) => {\r\n    const dispatch = useDispatch();\r\n    const currentFolderRef = useInstanceVariable(useSelector(selectCurrentFolder));\r\n    useEffect(() => {\r\n        let timeout: Nullable<any> = null;\r\n        if (\r\n            dndState.dndIsOver &&\r\n            FileHelper.isDndOpenable(file) &&\r\n            file.id !== currentFolderRef.current?.id\r\n        ) {\r\n            timeout = setTimeout(\r\n                () =>\r\n                    dispatch(\r\n                        thunkRequestFileAction(EssentialActions.OpenFiles, {\r\n                            targetFile: file,\r\n                            files: [file],\r\n                        })\r\n                    ),\r\n                // TODO: Make this timeout configurable\r\n                1500\r\n            );\r\n        }\r\n        return () => {\r\n            if (timeout) clearTimeout(timeout);\r\n        };\r\n    }, [dispatch, file, dndState.dndIsOver, currentFolderRef]);\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport { makeLocalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface TextPlaceholderProps {\r\n    minLength: number;\r\n    maxLength: number;\r\n}\r\n\r\nconst getRandomInt = (min: number, max: number) => {\r\n    return min + Math.floor(Math.random() * Math.floor(max - min));\r\n};\r\nexport const TextPlaceholder: React.FC<TextPlaceholderProps> = React.memo(props => {\r\n    const { minLength, maxLength } = props;\r\n\r\n    const placeholderLength = getRandomInt(minLength, maxLength);\r\n    const whitespace = '&nbsp;'.repeat(placeholderLength);\r\n\r\n    const classes = useStyles();\r\n    return (\r\n        <span\r\n            className={classes.textPlaceholder}\r\n            dangerouslySetInnerHTML={{ __html: whitespace }}\r\n        />\r\n    );\r\n});\r\n\r\nconst useStyles = makeLocalChonkyStyles(() => ({\r\n    '@keyframes loading-placeholder': {\r\n        '0%': { opacity: 0.2 },\r\n        '50%': { opacity: 0.4 },\r\n        '100%': { opacity: 0.2 },\r\n    },\r\n    textPlaceholder: {\r\n        animationName: '$loading-placeholder',\r\n        animationIterationCount: 'infinite',\r\n        animationTimingFunction: 'linear',\r\n        animationDuration: '1.5s',\r\n        backgroundColor: '#ccc',\r\n        whiteSpace: 'nowrap',\r\n        overflow: 'hidden',\r\n        borderRadius: 4,\r\n        maxWidth: '40%',\r\n        minWidth: 20,\r\n    },\r\n}));\r\n","import React, {\r\n    HTMLProps, useCallback, useContext, useEffect, useMemo, useRef, useState\r\n} from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Nullable, Undefinable } from 'tsdef';\r\n\r\nimport { ChonkyActions } from '../../action-definitions/index';\r\nimport { selectThumbnailGenerator } from '../../redux/selectors';\r\nimport { thunkRequestFileAction } from '../../redux/thunks/dispatchers.thunks';\r\nimport { DndEntryState } from '../../types/file-list.types';\r\nimport { FileData } from '../../types/file.types';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { FileHelper } from '../../util/file-helper';\r\nimport { ChonkyIconContext, ColorsDark, ColorsLight, useIconData } from '../../util/icon-helper';\r\nimport { Logger } from '../../util/logger';\r\nimport { TextPlaceholder } from '../external/TextPlaceholder';\r\nimport { KeyboardClickEvent, MouseClickEvent } from '../internal/ClickableWrapper';\r\nimport { FileEntryState } from './GridEntryPreview';\r\n\r\nexport const useFileEntryHtmlProps = (file: Nullable<FileData>): HTMLProps<HTMLDivElement> => {\r\n    return useMemo(() => {\r\n        const dataProps: { [prop: string]: Undefinable<string> } = {\r\n            'data-test-id': 'file-entry',\r\n            'data-chonky-file-id': file ? file.id : undefined,\r\n        };\r\n\r\n        return {\r\n            role: 'listitem',\r\n            ...dataProps,\r\n        };\r\n    }, [file]);\r\n};\r\n\r\nexport const useFileEntryState = (file: Nullable<FileData>, selected: boolean, focused: boolean) => {\r\n    const iconData = useIconData(file);\r\n    const { thumbnailUrl, thumbnailLoading } = useThumbnailUrl(file);\r\n\r\n    return useMemo<FileEntryState>(() => {\r\n        const fileColor = thumbnailUrl ? ColorsDark[iconData.colorCode] : ColorsLight[iconData.colorCode];\r\n        const iconSpin = thumbnailLoading || !file;\r\n        const icon = thumbnailLoading ? ChonkyIconName.loading : iconData.icon;\r\n\r\n        return {\r\n            childrenCount: FileHelper.getChildrenCount(file),\r\n            icon: file && file.icon !== undefined ? file.icon : icon,\r\n            iconSpin: iconSpin,\r\n            thumbnailUrl: thumbnailUrl,\r\n            color: file && file.color !== undefined ? file.color : fileColor,\r\n            selected: selected,\r\n            focused: !!focused,\r\n        };\r\n    }, [file, focused, iconData, selected, thumbnailLoading, thumbnailUrl]);\r\n};\r\n\r\nexport const useDndIcon = (dndState: DndEntryState) => {\r\n    let dndIconName: Nullable<ChonkyIconName> = null;\r\n    if (dndState.dndIsOver) {\r\n        const showDropIcon = dndState.dndCanDrop;\r\n        dndIconName = showDropIcon ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop;\r\n    } else if (dndState.dndIsDragging) {\r\n        dndIconName = ChonkyIconName.dndDragging;\r\n    }\r\n\r\n    return dndIconName;\r\n};\r\n\r\nexport const useModifierIconComponents = (file: Nullable<FileData>) => {\r\n    const modifierIcons: ChonkyIconName[] = useMemo(() => {\r\n        const modifierIcons: ChonkyIconName[] = [];\r\n        if (FileHelper.isHidden(file)) modifierIcons.push(ChonkyIconName.hidden);\r\n        if (FileHelper.isSymlink(file)) modifierIcons.push(ChonkyIconName.symlink);\r\n        if (FileHelper.isEncrypted(file)) modifierIcons.push(ChonkyIconName.lock);\r\n        return modifierIcons;\r\n    }, [file]);\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n    const modifierIconComponents = useMemo(\r\n        () => modifierIcons.map((icon, index) => <ChonkyIcon key={`file-modifier-${index}`} icon={icon} />),\r\n        // For some reason ESLint marks `ChonkyIcon` as an unnecessary dependency,\r\n        // but we expect it can change at runtime so we disable the check.\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n        [ChonkyIcon, modifierIcons]\r\n    );\r\n    return modifierIconComponents;\r\n};\r\n\r\nconst _extname = (fileName: string) => {\r\n    const parts = fileName.split('.');\r\n    if (parts.length) {\r\n        return `.${parts[parts.length - 1]}`;\r\n    }\r\n    return '';\r\n};\r\n\r\nexport const useFileNameComponent = (file: Nullable<FileData>) => {\r\n    return useMemo(() => {\r\n        if (!file) return <TextPlaceholder minLength={15} maxLength={20} />;\r\n\r\n        let name;\r\n        let extension = null;\r\n\r\n        const isDir = FileHelper.isDirectory(file);\r\n        if (isDir) {\r\n            name = file.name;\r\n        } else {\r\n            extension = file.ext ?? _extname(file.name);\r\n            name = file.name.substr(0, file.name.length - extension.length);\r\n        }\r\n\r\n        return (\r\n            <>\r\n                {name}\r\n                {extension && <span className=\"chonky-file-entry-description-title-extension\">{extension}</span>}\r\n            </>\r\n        );\r\n    }, [file]);\r\n};\r\n\r\nexport const useThumbnailUrl = (file: Nullable<FileData>) => {\r\n    const thumbnailGenerator = useSelector(selectThumbnailGenerator);\r\n    const [thumbnailUrl, setThumbnailUrl] = useState<Nullable<string>>(null);\r\n    const [thumbnailLoading, setThumbnailLoading] = useState<boolean>(false);\r\n    const loadingAttempts = useRef(0);\r\n\r\n    useEffect(() => {\r\n        let loadingCancelled = false;\r\n\r\n        if (file) {\r\n            if (thumbnailGenerator) {\r\n                if (loadingAttempts.current === 0) {\r\n                    setThumbnailLoading(true);\r\n                }\r\n                loadingAttempts.current++;\r\n                Promise.resolve()\r\n                    .then(() => thumbnailGenerator(file))\r\n                    .then((thumbnailUrl: any) => {\r\n                        if (loadingCancelled) return;\r\n                        setThumbnailLoading(false);\r\n\r\n                        if (thumbnailUrl && typeof thumbnailUrl === 'string') {\r\n                            setThumbnailUrl(thumbnailUrl);\r\n                        }\r\n                    })\r\n                    .catch(error => {\r\n                        if (!loadingCancelled) setThumbnailLoading(false);\r\n                        Logger.error(`User-defined \"thumbnailGenerator\" handler threw an error: ${error.message}`);\r\n                    });\r\n            } else if (file.thumbnailUrl) {\r\n                setThumbnailUrl(file.thumbnailUrl);\r\n            }\r\n        }\r\n\r\n        return () => {\r\n            loadingCancelled = true;\r\n        };\r\n    }, [file, setThumbnailUrl, setThumbnailLoading, thumbnailGenerator]);\r\n\r\n    return { thumbnailUrl, thumbnailLoading };\r\n};\r\n\r\nexport const useFileClickHandlers = (file: Nullable<FileData>, displayIndex: number) => {\r\n    const dispatch = useDispatch();\r\n\r\n    // Prepare base handlers\r\n    const onMouseClick = useCallback(\r\n        (event: MouseClickEvent, clickType: 'single' | 'double') => {\r\n            if (!file) return;\r\n\r\n            dispatch(\r\n                thunkRequestFileAction(ChonkyActions.MouseClickFile, {\r\n                    clickType,\r\n                    file,\r\n                    fileDisplayIndex: displayIndex,\r\n                    altKey: event.altKey,\r\n                    ctrlKey: event.ctrlKey,\r\n                    shiftKey: event.shiftKey,\r\n                })\r\n            );\r\n        },\r\n        [dispatch, file, displayIndex]\r\n    );\r\n    const onKeyboardClick = useCallback(\r\n        (event: KeyboardClickEvent) => {\r\n            if (!file) return;\r\n\r\n            dispatch(\r\n                thunkRequestFileAction(ChonkyActions.KeyboardClickFile, {\r\n                    file,\r\n                    fileDisplayIndex: displayIndex,\r\n                    enterKey: event.enterKey,\r\n                    spaceKey: event.spaceKey,\r\n                    altKey: event.altKey,\r\n                    ctrlKey: event.ctrlKey,\r\n                    shiftKey: event.shiftKey,\r\n                })\r\n            );\r\n        },\r\n        [dispatch, file, displayIndex]\r\n    );\r\n\r\n    // Prepare single/double click handlers\r\n    const onSingleClick = useCallback((event: MouseClickEvent) => onMouseClick(event, 'single'), [onMouseClick]);\r\n    const onDoubleClick = useCallback((event: MouseClickEvent) => onMouseClick(event, 'double'), [onMouseClick]);\r\n\r\n    return {\r\n        onSingleClick,\r\n        onDoubleClick,\r\n        onKeyboardClick,\r\n    };\r\n};\r\n","import { MaybePromise, Nullable } from 'tsdef';\r\n\r\nimport { FileActionState } from './action-handler.types';\r\nimport { FileViewConfig } from './file-view.types';\r\nimport { FileFilter, FileMap } from './file.types';\r\nimport { ChonkyIconName } from './icons.types';\r\nimport { ChonkyDispatch, RootState } from './redux.types';\r\nimport { FileSortKeySelector } from './sort.types';\r\n\r\nexport interface FileAction {\r\n    /**\r\n     * Unique file action ID. If you set the action ID to one of the built-in Chonky\r\n     * action action IDs, you custom action definition will override the built-in\r\n     * definition.\r\n     */\r\n    id: string;\r\n    /**\r\n     * When set to `true`, the action will only be active (dispatchable) when user\r\n     * selects one or more files. If `fileFilter` is defined, it will be applied to\r\n     * selection before checking if its empty.\r\n     */\r\n    requiresSelection?: boolean; // Requires selection of 1+ files\r\n    /**\r\n     * A predicate that determines whether a file should be included in the selection\r\n     * for this action.\r\n     */\r\n    fileFilter?: FileFilter;\r\n    /**\r\n     * List of hotkeys that should trigger this action, defined using `hotkey-js`\r\n     * notation.\r\n     * @see https://www.npmjs.com/package/hotkeys-js\r\n     */\r\n    hotkeys?: string[] | readonly string[];\r\n    /**\r\n     * When button is defined and `toolbar` or `contextMenu` is set to `true`, a\r\n     * button will be added to the relevant UI component. Clicking on this button\r\n     * will active this action. The appearance of the button will change based on\r\n     * the action definition and the current Chonky state.\r\n     */\r\n    button?: FileActionButton;\r\n    /**\r\n     * When `sortKeySelector` is specified, the action becomes a sorting toggle. When\r\n     * this action is activated, it will sort files using the key selector, toggling\r\n     * between Ascending and Descending orders.\r\n     */\r\n    sortKeySelector?: FileSortKeySelector;\r\n    /**\r\n     * When `fileViewConfig` is specified, triggering this action will apply the\r\n     * provided config to Chonky's file view.\r\n     */\r\n    fileViewConfig?: FileViewConfig;\r\n    /**\r\n     * When `option` is specified, the action becomes an option toggle. When the action\r\n     * is activated, the boolean value of the option will be toggled.\r\n     */\r\n    option?: FileActionOption;\r\n    /**\r\n     * When selection transform is defined, activating this action will update the file\r\n     * selection. If the transform function returns `null`, selection will be left\r\n     * untouched.\r\n     */\r\n    selectionTransform?: FileSelectionTransform;\r\n    /**\r\n     * When effect is defined, it will be called right before dispatching the action to\r\n     * the user defined action handler. If the effect function returns a promise, Chonky\r\n     * will wait for the promise to resolve or fail before dispatching the action to the\r\n     * handler. If this function returns `true`, the file action will NOT be dispatched\r\n     * the the handler.\r\n     */\r\n    effect?: FileActionEffect;\r\n    /**\r\n     * When customVisibility is defined, it will change the display state of the file action\r\n     * The function must return the visibility as one of the CustomVisibilityState values:\r\n     *  - Hidden\r\n     *  - Disabled\r\n     *  - Default\r\n     *  - Active\r\n     */\r\n    customVisibility?: () => CustomVisibilityState;\r\n    /**\r\n     * Field used to infer the type of action payload. It is used solely for Typescript\r\n     * type inference and action validation.\r\n     */\r\n    __payloadType?: any;\r\n    /**\r\n     * Field used to infer the type of extra state for this action. It is used solely\r\n     * for Typescript type inference and action validation.\r\n     */\r\n    __extraStateType?: any;\r\n}\r\n\r\nexport interface FileActionButton {\r\n    name: string; // Button name\r\n    toolbar?: boolean; // Whether to show the button in the toolbar\r\n    contextMenu?: boolean; // Whether to show the button in the context menu\r\n    group?: string; // Button group (dropdown in toolbar or section in context menu)\r\n    tooltip?: string; // Help tooltip text\r\n    icon?: ChonkyIconName | string | any; // Icon name\r\n    iconOnly?: boolean; // Whether to only display the icon\r\n}\r\n\r\nexport interface FileActionOption {\r\n    id: string; // Unique option ID\r\n    defaultValue: boolean; // Whether the option is enabled by default (required)\r\n}\r\n\r\nexport type FileSelectionTransform = (data: {\r\n    prevSelection: Set<string>;\r\n    fileIds: ReadonlyArray<string>;\r\n    fileMap: Readonly<FileMap>;\r\n    hiddenFileIds: Set<string>;\r\n}) => Nullable<Set<string>>;\r\n\r\nexport type FileActionEffect<Action extends FileAction = any> = (data: {\r\n    action: Action;\r\n    payload: Action['__payloadType'];\r\n    state: FileActionState<{}>; // extra state is empty on purpose\r\n    reduxDispatch: ChonkyDispatch;\r\n    getReduxState: () => RootState;\r\n}) => MaybePromise<undefined | boolean | void>;\r\n\r\nexport type FileActionMap = { [actonId: string]: FileAction };\r\n\r\nexport enum CustomVisibilityState {\r\n    Hidden, \r\n    Disabled, \r\n    Default,\r\n    Active\r\n};\r\n","import { useCallback, useMemo } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { ChonkyActions } from '../action-definitions/index';\r\nimport {\r\n    selectFileActionData,\r\n    selectFileViewConfig,\r\n    selectOptionValue,\r\n    selectParentFolder,\r\n    selectSelectedFilesForActionCount,\r\n    selectSortActionId,\r\n    selectSortOrder,\r\n} from '../redux/selectors';\r\nimport { useParamSelector } from '../redux/store';\r\nimport { thunkRequestFileAction } from '../redux/thunks/dispatchers.thunks';\r\nimport { ChonkyIconName } from '../types/icons.types';\r\nimport { CustomVisibilityState } from '../types/action.types';\r\nimport { SortOrder } from '../types/sort.types';\r\nimport { FileHelper } from './file-helper';\r\n\r\nexport const useFileActionTrigger = (fileActionId: string) => {\r\n    const dispatch = useDispatch();\r\n    const fileAction = useParamSelector(selectFileActionData, fileActionId);\r\n    return useCallback(() => dispatch(thunkRequestFileAction(fileAction, undefined)), [\r\n        dispatch,\r\n        fileAction,\r\n    ]);\r\n};\r\n\r\nexport const useFileActionProps = (\r\n    fileActionId: string\r\n): { icon: Nullable<ChonkyIconName | string>; active: boolean; disabled: boolean } => {\r\n    const parentFolder = useSelector(selectParentFolder);\r\n    const fileViewConfig = useSelector(selectFileViewConfig);\r\n\r\n    const sortActionId = useSelector(selectSortActionId);\r\n    const sortOrder = useSelector(selectSortOrder);\r\n\r\n    const action = useParamSelector(selectFileActionData, fileActionId);\r\n    // @ts-ignore\r\n    const optionValue = useParamSelector(selectOptionValue, action?.option?.id);\r\n\r\n    const actionSelectionSize = useParamSelector(\r\n        selectSelectedFilesForActionCount,\r\n        fileActionId\r\n    );\r\n\r\n    const actionSelectionEmpty = actionSelectionSize === 0;\r\n\r\n    return useMemo(() => {\r\n        if (!action) return { icon: null, active: false, disabled: true };\r\n\r\n        let icon = action.button?.icon ?? null;\r\n        if (action.sortKeySelector) {\r\n            if (sortActionId === action.id) {\r\n                if (sortOrder === SortOrder.ASC) {\r\n                    icon = ChonkyIconName.sortAsc;\r\n                } else {\r\n                    icon = ChonkyIconName.sortDesc;\r\n                }\r\n            } else {\r\n                icon = ChonkyIconName.placeholder;\r\n            }\r\n        } else if (action.option) {\r\n            if (optionValue) {\r\n                icon = ChonkyIconName.toggleOn;\r\n            } else {\r\n                icon = ChonkyIconName.toggleOff;\r\n            }\r\n        }\r\n\r\n        const isSortButtonAndCurrentSort = action.id === sortActionId;\r\n        const isFileViewButtonAndCurrentView = action.fileViewConfig === fileViewConfig;\r\n        const isOptionAndEnabled = action.option ? !!optionValue : false;\r\n\r\n        let customDisabled = false;\r\n        let customActive = false;\r\n        if (action.customVisibility !== undefined) {\r\n            customDisabled = action.customVisibility() === CustomVisibilityState.Disabled;\r\n            customActive = action.customVisibility() === CustomVisibilityState.Active;\r\n        }\r\n        const active =\r\n            isSortButtonAndCurrentSort ||\r\n            isFileViewButtonAndCurrentView ||\r\n            isOptionAndEnabled ||\r\n            customActive;\r\n        \r\n        let disabled: boolean = (!!action.requiresSelection && actionSelectionEmpty) || customDisabled;\r\n\r\n        if (action.id === ChonkyActions.OpenParentFolder.id) {\r\n            // We treat `open_parent_folder` file action as a special case as it\r\n            // requires the parent folder to be present to work...\r\n            disabled = disabled || !FileHelper.isOpenable(parentFolder);\r\n        }\r\n\r\n        return { icon, active, disabled };\r\n    }, [\r\n        parentFolder,\r\n        fileViewConfig,\r\n        sortActionId,\r\n        sortOrder,\r\n        action,\r\n        optionValue,\r\n        actionSelectionEmpty,\r\n    ]);\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport Button from '@mui/material/Button';\r\nimport React, { useContext } from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { selectFileActionData } from '../../redux/selectors';\r\nimport { useParamSelector } from '../../redux/store';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { CustomVisibilityState } from '../../types/action.types';\r\nimport { useFileActionProps, useFileActionTrigger } from '../../util/file-actions';\r\nimport { useLocalizedFileActionStrings } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, important, makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface ToolbarButtonProps {\r\n    className?: string;\r\n    text: string;\r\n    tooltip?: string;\r\n    active?: boolean;\r\n    icon?: Nullable<ChonkyIconName | string>;\r\n    iconOnly?: boolean;\r\n    onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n    disabled?: boolean;\r\n    dropdown?: boolean;\r\n}\r\n\r\nexport const ToolbarButton: React.FC<ToolbarButtonProps> = React.memo(props => {\r\n    const {\r\n        className: externalClassName,\r\n        text,\r\n        tooltip,\r\n        active,\r\n        icon,\r\n        iconOnly,\r\n        onClick,\r\n        disabled,\r\n        dropdown,\r\n    } = props;\r\n    const classes = useStyles();\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n\r\n    const iconComponent =\r\n        icon || iconOnly ? (\r\n            <div className={iconOnly ? '' : classes.iconWithText}>\r\n                <ChonkyIcon\r\n                    icon={icon ? icon : ChonkyIconName.fallbackIcon}\r\n                    fixedWidth={true}\r\n                />\r\n            </div>\r\n        ) : null;\r\n\r\n    const className = c({\r\n        [externalClassName ?? '']: true,\r\n        [classes.baseButton]: true,\r\n        [classes.iconOnlyButton]: iconOnly,\r\n        [classes.activeButton]: !!active,\r\n    });\r\n    return (\r\n        <Button\r\n            className={className}\r\n            onClick={onClick}\r\n            title={tooltip ? tooltip : text}\r\n            disabled={disabled || !onClick}\r\n        >\r\n            {iconComponent}\r\n            {text && !iconOnly && <span>{text}</span>}\r\n            {dropdown && (\r\n                <div className={classes.iconDropdown}>\r\n                    <ChonkyIcon\r\n                        icon={icon ? icon : ChonkyIconName.dropdown}\r\n                        fixedWidth={true}\r\n                    />\r\n                </div>\r\n            )}\r\n        </Button>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    baseButton: {\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        textTransform: important('none'),\r\n        letterSpacing: important(0),\r\n        minWidth: important('auto'),\r\n        lineHeight: theme.toolbar.lineHeight,\r\n        height: theme.toolbar.size,\r\n        paddingBottom: important(0),\r\n        paddingTop: important(0),\r\n    },\r\n    iconWithText: {\r\n        marginRight: 8,\r\n    },\r\n    iconOnlyButton: {\r\n        width: theme.toolbar.size,\r\n        textAlign: 'center',\r\n    },\r\n    iconDropdown: {\r\n        fontSize: '0.7em',\r\n        marginLeft: 2,\r\n        marginTop: 1,\r\n    },\r\n    activeButton: {\r\n        color: important(theme.colors.textActive),\r\n    },\r\n}));\r\n\r\nexport interface SmartToolbarButtonProps {\r\n    fileActionId: string;\r\n}\r\n\r\nexport const SmartToolbarButton: React.FC<SmartToolbarButtonProps> = React.memo(\r\n    props => {\r\n        const { fileActionId } = props;\r\n\r\n        const action = useParamSelector(selectFileActionData, fileActionId);\r\n        const triggerAction = useFileActionTrigger(fileActionId);\r\n        const { icon, active, disabled } = useFileActionProps(fileActionId);\r\n        const { buttonName, buttonTooltip } = useLocalizedFileActionStrings(action);\r\n\r\n        if (!action) return null;\r\n        const { button } = action;\r\n        if (!button) return null;\r\n        if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\r\n\r\n        return (\r\n            <ToolbarButton\r\n                text={buttonName}\r\n                tooltip={buttonTooltip}\r\n                icon={icon}\r\n                iconOnly={button.iconOnly}\r\n                active={active}\r\n                onClick={triggerAction}\r\n                disabled={disabled}\r\n            />\r\n        );\r\n    }\r\n);\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useContext, useMemo } from 'react';\r\n\r\nimport { DndEntryState } from '../../types/file-list.types';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { useDndHoverOpen, useFileDrop } from '../../util/dnd';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, important, makeLocalChonkyStyles } from '../../util/styles';\r\nimport { useDndIcon } from '../file-list/FileEntry-hooks';\r\nimport { FolderChainItem } from './FileNavbar-hooks';\r\nimport { ToolbarButton } from './ToolbarButton';\r\n\r\nexport interface FolderChainButtonProps {\r\n    first: boolean;\r\n    current: boolean;\r\n    item: FolderChainItem;\r\n}\r\n\r\nexport const FolderChainButton: React.FC<FolderChainButtonProps> = React.memo(\r\n    ({ first, current, item }) => {\r\n        const { file, disabled, onClick } = item;\r\n        const { dndIsOver, dndCanDrop, drop } = useFileDrop({\r\n            file,\r\n            forceDisableDrop: !file || current,\r\n        });\r\n        const dndState = useMemo<DndEntryState>(\r\n            () => ({\r\n                dndIsOver,\r\n                dndCanDrop,\r\n                dndIsDragging: false,\r\n            }),\r\n            [dndCanDrop, dndIsOver]\r\n        );\r\n        useDndHoverOpen(file, dndState);\r\n        const dndIconName = useDndIcon(dndState);\r\n        const ChonkyIcon = useContext(ChonkyIconContext);\r\n\r\n        const classes = useStyles(dndState);\r\n        const className = c({\r\n            [classes.baseBreadcrumb]: true,\r\n            [classes.disabledBreadcrumb]: disabled,\r\n            [classes.currentBreadcrumb]: current,\r\n        });\r\n        const text = file ? file.name : 'Loading...';\r\n        const icon =\r\n            first && file?.folderChainIcon === undefined\r\n                ? ChonkyIconName.folder\r\n                : file?.folderChainIcon;\r\n\r\n        return (\r\n            <div className={classes.buttonContainer} ref={file ? drop : null}>\r\n                {file && dndIconName && (\r\n                    <div className={classes.dndIndicator}>\r\n                        <ChonkyIcon icon={dndIconName} fixedWidth={true} />\r\n                    </div>\r\n                )}\r\n                <ToolbarButton\r\n                    icon={icon}\r\n                    className={className}\r\n                    text={text}\r\n                    disabled={disabled}\r\n                    onClick={onClick}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    buttonContainer: {\r\n        position: 'relative',\r\n    },\r\n    baseBreadcrumb: {\r\n        color: (dndState: DndEntryState) => {\r\n            let color = theme.palette.text.primary;\r\n            if (dndState.dndIsOver) {\r\n                color = dndState.dndCanDrop\r\n                    ? theme.dnd.canDropColor\r\n                    : theme.dnd.cannotDropColor;\r\n            }\r\n            return important(color);\r\n        },\r\n    },\r\n    disabledBreadcrumb: {\r\n        // Constant function here is on purpose. Without the function, the color here\r\n        // does not override the `baseBreadcrumb` color from above.\r\n        color: () => important(theme.palette.text.disabled),\r\n    },\r\n    currentBreadcrumb: {\r\n        textDecoration: important('underline'),\r\n    },\r\n    dndIndicator: {\r\n        color: (dndState: DndEntryState) =>\r\n            dndState.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor,\r\n        backgroundColor: (dndState: DndEntryState) =>\r\n            dndState.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask,\r\n        lineHeight: `calc(${theme.toolbar.lineHeight} - 6px)`,\r\n        transform: 'translateX(-50%) translateY(-50%)',\r\n        borderRadius: theme.toolbar.buttonRadius,\r\n        height: theme.toolbar.size - 6,\r\n        width: theme.toolbar.size - 6,\r\n        boxSizing: 'border-box',\r\n        position: 'absolute',\r\n        textAlign: 'center',\r\n        left: '50%',\r\n        top: '50%',\r\n        zIndex: 5,\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Breadcrumbs from '@mui/material/Breadcrumbs';\r\nimport React, { ReactElement, useMemo } from 'react';\r\n\r\nimport { ChonkyActions } from '../../action-definitions/index';\r\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { useFolderChainItems } from './FileNavbar-hooks';\r\nimport { FolderChainButton } from './FolderChainButton';\r\nimport { SmartToolbarButton } from './ToolbarButton';\r\n\r\nexport interface FileNavbarProps {}\r\n\r\nexport const FileNavbar: React.FC<FileNavbarProps> = React.memo(() => {\r\n    const classes = useStyles();\r\n    const folderChainItems = useFolderChainItems();\r\n\r\n    const folderChainComponents = useMemo(() => {\r\n        const components: ReactElement[] = [];\r\n        for (let i = 0; i < folderChainItems.length; ++i) {\r\n            const key = `folder-chain-${i}`;\r\n            const component = (\r\n                <FolderChainButton\r\n                    key={key}\r\n                    first={i === 0}\r\n                    current={i === folderChainItems.length - 1}\r\n                    item={folderChainItems[i]}\r\n                />\r\n            );\r\n            components.push(component);\r\n        }\r\n        return components;\r\n    }, [folderChainItems]);\r\n\r\n    return (\r\n        <Box className={classes.navbarWrapper}>\r\n            <Box className={classes.navbarContainer}>\r\n                <SmartToolbarButton fileActionId={ChonkyActions.OpenParentFolder.id} />\r\n                <Breadcrumbs\r\n                    className={classes.navbarBreadcrumbs}\r\n                    classes={{ separator: classes.separator }}\r\n                >\r\n                    {folderChainComponents}\r\n                </Breadcrumbs>\r\n            </Box>\r\n        </Box>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    navbarWrapper: {\r\n        paddingBottom: theme.margins.rootLayoutMargin,\r\n    },\r\n    navbarContainer: {\r\n        display: 'flex',\r\n    },\r\n    upDirectoryButton: {\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        height: theme.toolbar.size,\r\n        width: theme.toolbar.size,\r\n        padding: '0px !important',\r\n    },\r\n    navbarBreadcrumbs: {\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        flexGrow: 100,\r\n    },\r\n    separator: {\r\n        marginRight: important(4),\r\n        marginLeft: important(4),\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport ListItemIcon from '@mui/material/ListItemIcon';\r\nimport ListItemText from '@mui/material/ListItemText';\r\nimport MenuItem from '@mui/material/MenuItem';\r\nimport React, { useCallback, useContext } from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { selectFileActionData } from '../../redux/selectors';\r\nimport { useParamSelector } from '../../redux/store';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { CustomVisibilityState } from '../../types/action.types';\r\nimport { useFileActionProps, useFileActionTrigger } from '../../util/file-actions';\r\nimport { useLocalizedFileActionStrings } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, important, makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface ToolbarDropdownButtonProps {\r\n    text: string;\r\n    active?: boolean;\r\n    icon?: Nullable<ChonkyIconName | string>;\r\n    onClick?: () => void;\r\n    disabled?: boolean;\r\n}\r\n\r\nexport const ToolbarDropdownButton = React.forwardRef(\r\n    (props: ToolbarDropdownButtonProps, ref: React.Ref<HTMLLIElement>) => {\r\n        const { text, active, icon, onClick, disabled } = props;\r\n        const classes = useStyles();\r\n        const ChonkyIcon = useContext(ChonkyIconContext);\r\n\r\n        const className = c({\r\n            [classes.baseButton]: true,\r\n            [classes.activeButton]: active,\r\n        });\r\n        return (\r\n            <MenuItem\r\n                ref={ref}\r\n                className={className}\r\n                onClick={onClick}\r\n                disabled={disabled}\r\n            >\r\n                {icon && (\r\n                    <ListItemIcon className={classes.icon}>\r\n                        <ChonkyIcon icon={icon} fixedWidth={true} />\r\n                    </ListItemIcon>\r\n                )}\r\n                <ListItemText primaryTypographyProps={{ className: classes.text }}>\r\n                    {text}\r\n                </ListItemText>\r\n            </MenuItem>\r\n        );\r\n    }\r\n);\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    baseButton: {\r\n        lineHeight: important(theme.toolbar.lineHeight),\r\n        height: important(theme.toolbar.size),\r\n        minHeight: important('auto'),\r\n        minWidth: important('auto'),\r\n        padding: important(20),\r\n    },\r\n    icon: {\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        minWidth: important('auto'),\r\n        color: important('inherit'),\r\n        marginRight: 8,\r\n    },\r\n    text: {\r\n        fontSize: important(theme.toolbar.fontSize),\r\n    },\r\n    activeButton: {\r\n        color: important(theme.colors.textActive),\r\n    },\r\n}));\r\n\r\nexport interface SmartToolbarDropdownButtonProps {\r\n    fileActionId: string;\r\n    onClickFollowUp?: () => void;\r\n}\r\n\r\nexport const SmartToolbarDropdownButton = React.forwardRef(\r\n    (props: SmartToolbarDropdownButtonProps, ref: React.Ref<HTMLLIElement>) => {\r\n        const { fileActionId, onClickFollowUp } = props;\r\n\r\n        const action = useParamSelector(selectFileActionData, fileActionId);\r\n        const triggerAction = useFileActionTrigger(fileActionId);\r\n        const { icon, active, disabled } = useFileActionProps(fileActionId);\r\n        const { buttonName } = useLocalizedFileActionStrings(action);\r\n\r\n        // Combine external click handler with internal one\r\n        const handleClick = useCallback(() => {\r\n            triggerAction();\r\n            if (onClickFollowUp) onClickFollowUp();\r\n        }, [onClickFollowUp, triggerAction]);\r\n\r\n        if (!action) return null;\r\n        const { button } = action;\r\n        if (!button) return null;\r\n        if (action.customVisibility !== undefined && action.customVisibility() === CustomVisibilityState.Hidden) return null;\r\n\r\n        return (\r\n            <ToolbarDropdownButton\r\n                ref={ref}\r\n                text={buttonName}\r\n                icon={icon}\r\n                onClick={handleClick}\r\n                active={active}\r\n                disabled={disabled}\r\n            />\r\n        );\r\n    }\r\n);\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport Menu from '@mui/material/Menu';\r\nimport React, { useCallback, useMemo } from 'react';\r\n\r\nimport { FileActionGroup } from '../../types/action-menus.types';\r\nimport { useLocalizedFileActionGroup } from '../../util/i18n';\r\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { ToolbarButton } from './ToolbarButton';\r\nimport { SmartToolbarDropdownButton } from './ToolbarDropdownButton';\r\n\r\nexport type ToolbarDropdownProps = FileActionGroup;\r\n\r\nexport const ToolbarDropdown: React.FC<ToolbarDropdownProps> = React.memo(props => {\r\n    const { name, fileActionIds } = props;\r\n    const [anchor, setAnchor] = React.useState<null | HTMLElement>(null);\r\n\r\n    const handleClick = useCallback(\r\n        (event: React.MouseEvent<HTMLButtonElement>) => setAnchor(event.currentTarget),\r\n        [setAnchor]\r\n    );\r\n    const handleClose = useCallback(() => setAnchor(null), [setAnchor]);\r\n\r\n    const menuItemComponents = useMemo(\r\n        () =>\r\n            fileActionIds.map(id => (\r\n                <SmartToolbarDropdownButton\r\n                    key={`menu-item-${id}`}\r\n                    fileActionId={id}\r\n                    onClickFollowUp={handleClose}\r\n                />\r\n            )),\r\n        [fileActionIds, handleClose]\r\n    );\r\n\r\n    const localizedName = useLocalizedFileActionGroup(name);\r\n    const classes = useStyles();\r\n    return (\r\n        <>\r\n            <ToolbarButton text={localizedName} onClick={handleClick} dropdown={true} />\r\n            <Menu\r\n                autoFocus\r\n                keepMounted\r\n                elevation={2}\r\n                anchorEl={anchor}\r\n                onClose={handleClose}\r\n                open={Boolean(anchor)}\r\n                transitionDuration={150}\r\n                classes={{ list: classes.dropdownList }}\r\n            >\r\n                {menuItemComponents}\r\n            </Menu>\r\n        </>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    dropdownList: {\r\n        paddingBottom: important(0),\r\n        paddingTop: important(0),\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { useSelector } from 'react-redux';\r\n\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { selectHiddenFileCount, selectors, selectSelectionSize } from '../../redux/selectors';\r\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\r\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface ToolbarInfoProps {}\r\n\r\nexport const ToolbarInfo: React.FC<ToolbarInfoProps> = React.memo(() => {\r\n    const classes = useStyles();\r\n\r\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\r\n    const selectionSize = useSelector(selectSelectionSize);\r\n    const hiddenCount = useSelector(selectHiddenFileCount);\r\n\r\n    const intl = useIntl();\r\n    const fileCountString = intl.formatMessage(\r\n        {\r\n            id: getI18nId(I18nNamespace.Toolbar, 'visibleFileCount'),\r\n            defaultMessage: `{fileCount, plural,\r\n                =0 {# items}\r\n                one {# item}\r\n                other {# items}\r\n            }`,\r\n        },\r\n        { fileCount: displayFileIds.length }\r\n    );\r\n    const selectedString = intl.formatMessage(\r\n        {\r\n            id: getI18nId(I18nNamespace.Toolbar, 'selectedFileCount'),\r\n            defaultMessage: `{fileCount, plural,\r\n                =0 {}\r\n                other {# selected}\r\n            }`,\r\n        },\r\n        { fileCount: selectionSize }\r\n    );\r\n    const hiddenString = intl.formatMessage(\r\n        {\r\n            id: getI18nId(I18nNamespace.Toolbar, 'hiddenFileCount'),\r\n            defaultMessage: `{fileCount, plural,\r\n                =0 {}\r\n                other {# hidden}\r\n            }`,\r\n        },\r\n        { fileCount: hiddenCount }\r\n    );\r\n\r\n    return (\r\n        <div className={classes.infoContainer}>\r\n            <Typography className={classes.infoText} variant=\"body1\">\r\n                {fileCountString}\r\n                {(selectedString || hiddenString) && (\r\n                    <span className={classes.extraInfoSpan}>\r\n                        (\r\n                        <span className={classes.selectionSizeText}>\r\n                            {selectedString}\r\n                        </span>\r\n                        {selectedString && hiddenString && ', '}\r\n                        <span className={classes.hiddenCountText}>{hiddenString}</span>)\r\n                    </span>\r\n                )}\r\n            </Typography>\r\n        </div>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    infoContainer: {\r\n        height: theme.toolbar.size,\r\n        display: 'flex',\r\n    },\r\n    infoText: {\r\n        lineHeight: important(theme.toolbar.lineHeight),\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        marginLeft: important(12),\r\n        height: theme.toolbar.size,\r\n    },\r\n    extraInfoSpan: {\r\n        marginRight: important(8),\r\n        marginLeft: important(8),\r\n        opacity: 0.8,\r\n    },\r\n    selectionSizeText: {\r\n        color: theme.colors.textActive,\r\n    },\r\n    hiddenCountText: {},\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useCallback, useContext, useEffect, useRef, useState } from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport TextField from '@mui/material/TextField';\r\n\r\nimport { reduxActions } from '../../redux/reducers';\r\nimport { selectSearchString } from '../../redux/selectors';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { useDebounce } from '../../util/hooks-helpers';\r\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface ToolbarSearchProps {}\r\n\r\nexport const ToolbarSearch: React.FC<ToolbarSearchProps> = React.memo(() => {\r\n    const intl = useIntl();\r\n    const searchPlaceholderString = intl.formatMessage({\r\n        id: getI18nId(I18nNamespace.Toolbar, 'searchPlaceholder'),\r\n        defaultMessage: 'Search',\r\n    });\r\n\r\n    const classes = useStyles();\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n\r\n    const searchInputRef = useRef<HTMLInputElement>();\r\n\r\n    const dispatch = useDispatch();\r\n    const reduxSearchString = useSelector(selectSearchString);\r\n\r\n    const [localSearchString, setLocalSearchString] = useState(reduxSearchString);\r\n    const [debouncedLocalSearchString] = useDebounce(localSearchString, 300);\r\n    const [showLoadingIndicator, setShowLoadingIndicator] = useState(false);\r\n\r\n    useEffect(() => {\r\n        dispatch(\r\n            reduxActions.setFocusSearchInput(() => {\r\n                if (searchInputRef.current) searchInputRef.current.focus();\r\n            })\r\n        );\r\n        return () => {\r\n            dispatch(reduxActions.setFocusSearchInput(null));\r\n        };\r\n    }, [dispatch]);\r\n\r\n    useEffect(() => {\r\n        setShowLoadingIndicator(false);\r\n        dispatch(reduxActions.setSearchString(debouncedLocalSearchString));\r\n    }, [debouncedLocalSearchString, dispatch]);\r\n\r\n    const handleChange = useCallback((event: React.FormEvent<HTMLInputElement>) => {\r\n        setShowLoadingIndicator(true);\r\n        setLocalSearchString(event.currentTarget.value);\r\n    }, []);\r\n    const handleKeyUp = useCallback(\r\n        (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n            // Remove focus from the search input field when user presses escape.\r\n            // Note: We use KeyUp instead of KeyPress because some browser plugins can\r\n            //       intercept KeyPress events with Escape key.\r\n            //       @see https://stackoverflow.com/a/37461974\r\n            if (event.key === 'Escape') {\r\n                setLocalSearchString('');\r\n                dispatch(reduxActions.setSearchString(''));\r\n                if (searchInputRef.current) searchInputRef.current.blur();\r\n            }\r\n        },\r\n        [dispatch]\r\n    );\r\n\r\n    return (\r\n        <TextField\r\n            className={classes.searchFieldContainer}\r\n            size=\"small\"\r\n            variant=\"outlined\"\r\n            value={localSearchString}\r\n            placeholder={searchPlaceholderString}\r\n            onChange={handleChange as any}\r\n            inputRef={searchInputRef}\r\n            InputProps={{\r\n                onKeyUp: handleKeyUp,\r\n                startAdornment: (\r\n                    <InputAdornment className={classes.searchIcon} position=\"start\">\r\n                        <ChonkyIcon\r\n                            icon={showLoadingIndicator ? ChonkyIconName.loading : ChonkyIconName.search}\r\n                            spin={showLoadingIndicator}\r\n                        />\r\n                    </InputAdornment>\r\n                ),\r\n                className: classes.searchFieldInput,\r\n            }}\r\n            inputProps={{ className: classes.searchFieldInputInner }}\r\n        />\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    searchFieldContainer: {\r\n        height: theme.toolbar.size,\r\n        width: 150,\r\n    },\r\n    searchIcon: {\r\n        fontSize: '0.9em',\r\n        opacity: 0.75,\r\n    },\r\n    searchFieldInput: {\r\n        lineHeight: important(0),\r\n        padding: important(0),\r\n        margin: important(0),\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        borderRadius: theme.toolbar.buttonRadius,\r\n        height: theme.toolbar.size - 4,\r\n        paddingLeft: important(8),\r\n        marginTop: 2,\r\n    },\r\n    searchFieldInputInner: {\r\n        lineHeight: important(`${theme.toolbar.size - 4}px`),\r\n        fontSize: important(theme.toolbar.fontSize),\r\n        height: important(theme.toolbar.size - 4),\r\n        padding: important([0, 8, 0, 0]),\r\n        margin: important(0),\r\n        '-webkit-appearance': 'none',\r\n    },\r\n}));\r\n","import React, { ReactElement, useMemo } from 'react';\r\nimport { useSelector } from 'react-redux';\r\n\r\nimport { selectToolbarItems } from '../../redux/selectors';\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { SmartToolbarButton } from './ToolbarButton';\r\nimport { ToolbarDropdown } from './ToolbarDropdown';\r\nimport { ToolbarInfo } from './ToolbarInfo';\r\nimport { ToolbarSearch } from './ToolbarSearch';\r\n\r\nexport interface FileToolbarProps {}\r\n\r\nexport const FileToolbar: React.FC<FileToolbarProps> = React.memo(() => {\r\n    const classes = useStyles();\r\n    const toolbarItems = useSelector(selectToolbarItems);\r\n\r\n    const toolbarItemComponents = useMemo(() => {\r\n        const components: ReactElement[] = [];\r\n        for (let i = 0; i < toolbarItems.length; ++i) {\r\n            const item = toolbarItems[i];\r\n\r\n            const key = `toolbar-item-${typeof item === 'string' ? item : item.name}`;\r\n            const component =\r\n                typeof item === 'string' ? (\r\n                    <SmartToolbarButton key={key} fileActionId={item} />\r\n                ) : (\r\n                    <ToolbarDropdown\r\n                        key={key}\r\n                        name={item.name}\r\n                        fileActionIds={item.fileActionIds}\r\n                    />\r\n                );\r\n            components.push(component);\r\n        }\r\n        return components;\r\n    }, [toolbarItems]);\r\n\r\n    return (\r\n        <div className={classes.toolbarWrapper}>\r\n            <div className={classes.toolbarContainer}>\r\n                <div className={classes.toolbarLeft}>\r\n                    <ToolbarSearch />\r\n                    <ToolbarInfo />\r\n                </div>\r\n                <div className={classes.toolbarRight}>{toolbarItemComponents}</div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    toolbarWrapper: {},\r\n    toolbarContainer: {\r\n        flexWrap: 'wrap-reverse',\r\n        display: 'flex',\r\n    },\r\n    toolbarLeft: {\r\n        paddingBottom: theme.margins.rootLayoutMargin,\r\n        flexWrap: 'nowrap',\r\n        flexGrow: 10000,\r\n        display: 'flex',\r\n    },\r\n    toolbarLeftFiller: {\r\n        flexGrow: 10000,\r\n    },\r\n    toolbarRight: {\r\n        paddingBottom: theme.margins.rootLayoutMargin,\r\n        flexWrap: 'nowrap',\r\n        display: 'flex',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { CSSProperties, useContext } from 'react';\r\nimport { useIntl } from 'react-intl';\r\n\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface FileListEmptyProps {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport const FileListEmpty: React.FC<FileListEmptyProps> = props => {\r\n    const { width, height } = props;\r\n    const classes = useStyles();\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n    const style: CSSProperties = {\r\n        width,\r\n        height,\r\n    };\r\n\r\n    const intl = useIntl();\r\n    const emptyString = intl.formatMessage({\r\n        id: getI18nId(I18nNamespace.FileList, 'nothingToShow'),\r\n        defaultMessage: 'Nothing to show',\r\n    });\r\n\r\n    return (\r\n        <div className={classes.fileListEmpty} style={style}>\r\n            <div className={classes.fileListEmptyContent}>\r\n                <ChonkyIcon icon={ChonkyIconName.folderOpen} />\r\n                &nbsp; {emptyString}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst useStyles = makeGlobalChonkyStyles(theme => ({\r\n    fileListEmpty: {\r\n        color: theme.palette.text.disabled,\r\n        position: 'relative',\r\n        textAlign: 'center',\r\n        fontSize: '1.2em',\r\n    },\r\n    fileListEmptyContent: {\r\n        transform: 'translateX(-50%) translateY(-50%)',\r\n        position: 'absolute',\r\n        left: '50%',\r\n        top: '50%',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useCallback, useRef } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Nilable, Nullable } from 'tsdef';\r\n\r\nimport { selectDoubleClickDelay } from '../../redux/selectors';\r\nimport {\r\n    KeyboardClickEvent,\r\n    KeyboardClickEventHandler,\r\n    MouseClickEvent,\r\n    MouseClickEventHandler,\r\n} from './ClickableWrapper';\r\n\r\nexport const useClickHandler = (\r\n    onSingleClick: Nilable<MouseClickEventHandler>,\r\n    onDoubleClick: Nilable<MouseClickEventHandler>\r\n) => {\r\n    const doubleClickDelay = useSelector(selectDoubleClickDelay);\r\n\r\n    const counter = useRef({\r\n        clickCount: 0,\r\n        clickTimeout: null as Nullable<number>,\r\n    });\r\n\r\n    return useCallback(\r\n        (event: React.MouseEvent) => {\r\n            const mouseClickEvent: MouseClickEvent = {\r\n                altKey: event.altKey,\r\n                ctrlKey: event.ctrlKey || event.metaKey,\r\n                shiftKey: event.shiftKey,\r\n\r\n            };\r\n\r\n            counter.current.clickCount++;\r\n            if (counter.current.clickCount === 1) {\r\n                if (onSingleClick) {\r\n                    event.preventDefault();\r\n                    onSingleClick(mouseClickEvent);\r\n                }\r\n                counter.current.clickCount = 1;\r\n                // @ts-ignore\r\n                counter.current.clickTimeout = setTimeout(\r\n                    () => (counter.current.clickCount = 0),\r\n                    doubleClickDelay\r\n                );\r\n            } else if (counter.current.clickCount === 2) {\r\n                if (onDoubleClick) {\r\n                    event.preventDefault();\r\n                    onDoubleClick(mouseClickEvent);\r\n                }\r\n                if (typeof counter.current.clickTimeout === 'number') {\r\n                    clearTimeout(counter.current.clickTimeout);\r\n                    counter.current.clickTimeout = null;\r\n                    counter.current.clickCount = 0;\r\n                }\r\n            }\r\n        },\r\n        [doubleClickDelay, onSingleClick, onDoubleClick, counter]\r\n    );\r\n};\r\n\r\nexport const useKeyDownHandler = (onKeyboardClick?: KeyboardClickEventHandler) => {\r\n    return useCallback(\r\n        (event: React.KeyboardEvent) => {\r\n            if (!onKeyboardClick) return;\r\n\r\n            const keyboardClickEvent: KeyboardClickEvent = {\r\n                enterKey: event.nativeEvent.code === 'Enter',\r\n                spaceKey: event.nativeEvent.code === 'Space',\r\n                altKey: event.altKey,\r\n                ctrlKey: event.ctrlKey,\r\n                shiftKey: event.shiftKey,\r\n            };\r\n\r\n            if (keyboardClickEvent.spaceKey || keyboardClickEvent.enterKey) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                onKeyboardClick(keyboardClickEvent);\r\n            }\r\n        },\r\n        [onKeyboardClick]\r\n    );\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useCallback } from 'react';\r\nimport { AnyObjectWithStringKeys } from 'tsdef';\r\n\r\nimport { useClickHandler, useKeyDownHandler } from './ClickableWrapper-hooks';\r\n\r\nexport interface MouseClickEvent {\r\n    altKey: boolean;\r\n    ctrlKey: boolean;\r\n    shiftKey: boolean;\r\n}\r\nexport type MouseClickEventHandler = (event: MouseClickEvent) => void;\r\n\r\nexport interface KeyboardClickEvent {\r\n    enterKey: boolean;\r\n    spaceKey: boolean;\r\n    altKey: boolean;\r\n    ctrlKey: boolean;\r\n    shiftKey: boolean;\r\n}\r\nexport type KeyboardClickEventHandler = (event: KeyboardClickEvent) => void;\r\n\r\nexport interface ClickableWrapperProps {\r\n    wrapperTag: any;\r\n    passthroughProps?: any;\r\n\r\n    onSingleClick?: MouseClickEventHandler;\r\n    onDoubleClick?: MouseClickEventHandler;\r\n    onKeyboardClick?: KeyboardClickEventHandler;\r\n    setFocused?: (focused: boolean) => void;\r\n}\r\n\r\nexport const ClickableWrapper: React.FC<ClickableWrapperProps> = props => {\r\n    const {\r\n        children,\r\n        wrapperTag: WrapperTag,\r\n        passthroughProps,\r\n        onSingleClick,\r\n        onDoubleClick,\r\n        onKeyboardClick,\r\n        setFocused,\r\n    } = props;\r\n\r\n    const handleClick = useClickHandler(onSingleClick, onDoubleClick);\r\n    const handleKeyDown = useKeyDownHandler(onKeyboardClick);\r\n\r\n    const compProps: AnyObjectWithStringKeys = {\r\n        onFocus: useCallback(() => setFocused && setFocused(true), [setFocused]),\r\n        onBlur: useCallback(() => setFocused && setFocused(false), [setFocused]),\r\n    };\r\n\r\n    if (onSingleClick || onDoubleClick || onKeyboardClick) {\r\n        compProps.onClick = handleClick;\r\n        compProps.onKeyDown = handleKeyDown;\r\n        compProps.tabIndex = 0;\r\n    }\r\n\r\n    const mergedProps = { ...compProps, ...passthroughProps };\r\n    return <WrapperTag {...mergedProps}>{children}</WrapperTag>;\r\n};\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { FileData } from '../../types/file.types';\r\nimport { makeLocalChonkyStyles } from '../../util/styles';\r\nimport { useFileNameComponent, useModifierIconComponents } from './FileEntry-hooks';\r\n\r\nexport interface FileEntryNameProps {\r\n    file: Nullable<FileData>;\r\n    className?: string;\r\n}\r\n\r\nexport const FileEntryName: React.FC<FileEntryNameProps> = React.memo(({ file, className }) => {\r\n    const modifierIconComponents = useModifierIconComponents(file);\r\n    const fileNameComponent = useFileNameComponent(file);\r\n\r\n    const classes = useStyles();\r\n    return (\r\n        <span className={className} title={file ? file.name : undefined}>\r\n            {modifierIconComponents.length > 0 && (\r\n                <span className={classes.modifierIcons}>{modifierIconComponents}</span>\r\n            )}\r\n            {fileNameComponent}\r\n        </span>\r\n    );\r\n});\r\nFileEntryName.displayName = 'FileEntryName';\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    modifierIcons: {\r\n        color: theme.palette.text.disabled,\r\n        position: 'relative',\r\n        fontSize: '0.775em',\r\n        paddingRight: 5,\r\n    },\r\n}));\r\n","import React, { useContext } from 'react';\r\n\r\nimport { FileEntryProps } from '../../types/file-list.types';\r\nimport { useLocalizedFileEntryStrings } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { makeLocalChonkyStyles } from '../../util/styles';\r\nimport { TextPlaceholder } from '../external/TextPlaceholder';\r\nimport { useFileEntryHtmlProps, useFileEntryState } from './FileEntry-hooks';\r\nimport { FileEntryName } from './FileEntryName';\r\nimport { FileEntryState } from './GridEntryPreview';\r\n\r\nexport const CompactEntry: React.FC<FileEntryProps> = React.memo(\r\n    // @ts-ignore\r\n    ({ file, selected, focused, dndState }) => {\r\n        const entryState: FileEntryState = useFileEntryState(file, selected, focused);\r\n\r\n        const { fileModDateString, fileSizeString } = useLocalizedFileEntryStrings(\r\n            file\r\n        );\r\n\r\n        const classes = useStyles(entryState);\r\n        const ChonkyIcon = useContext(ChonkyIconContext);\r\n        const fileEntryHtmlProps = useFileEntryHtmlProps(file);\r\n        return (\r\n            <div className={classes.listFileEntry} {...fileEntryHtmlProps}>\r\n                <div className={classes.listFileEntryIcon}>\r\n                    <ChonkyIcon\r\n                        icon={entryState.icon}\r\n                        spin={entryState.iconSpin}\r\n                        fixedWidth={true}\r\n                    />\r\n                </div>\r\n                <div className={classes.listFileEntryDescription}>\r\n                    <div\r\n                        className={classes.listFileEntryName}\r\n                        title={file ? file.name : undefined}\r\n                    >\r\n                        <FileEntryName file={file} />\r\n                    </div>\r\n                    <div className={classes.listFileEntryProperties}>\r\n                        <div className={classes.listFileEntryProperty}>\r\n                            {file ? (\r\n                                fileModDateString ?? <span></span>\r\n                            ) : (\r\n                                <TextPlaceholder minLength={5} maxLength={15} />\r\n                            )}\r\n                        </div>\r\n                        <div className={classes.listFileEntryProperty}>\r\n                            {file ? (\r\n                                fileSizeString ?? <span></span>\r\n                            ) : (\r\n                                <TextPlaceholder minLength={10} maxLength={20} />\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"chonky-file-entry-outline\"></div>\r\n                <div className=\"chonky-file-entry-selection\"></div>\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    listFileEntry: {\r\n        fontSize: theme.listFileEntry.fontSize,\r\n        alignItems: 'center',\r\n        position: 'relative',\r\n        display: 'flex',\r\n        height: '100%',\r\n    },\r\n    listFileEntryIcon: {\r\n        backgroundColor: (state: FileEntryState) => state.color,\r\n        boxShadow: 'inset rgba(255, 255, 255, 0.5) 0 0 0 999px',\r\n        borderRadius: theme.listFileEntry.iconBorderRadius,\r\n        fontSize: theme.listFileEntry.iconFontSize,\r\n        color: '#fff',\r\n        padding: 8,\r\n    },\r\n    listFileEntryDescription: {\r\n        flexDirection: 'column',\r\n        display: 'flex',\r\n        flexGrow: 1,\r\n    },\r\n    listFileEntryName: {\r\n        padding: [0, 8, 4, 8],\r\n    },\r\n    listFileEntryProperties: {\r\n        fontSize: theme.listFileEntry.propertyFontSize,\r\n        flexDirection: 'row',\r\n        display: 'flex',\r\n    },\r\n    listFileEntryProperty: {\r\n        padding: [0, 8],\r\n        opacity: 0.4,\r\n    },\r\n}));\r\n","import React from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { DndEntryState } from '../../types/file-list.types';\r\nimport { FileData } from '../../types/file.types';\r\nimport { useDndHoverOpen, useFileEntryDnD } from '../../util/dnd';\r\nimport { FileHelper } from '../../util/file-helper';\r\nimport { makeLocalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface DnDFileEntryProps {\r\n    file: Nullable<FileData>;\r\n    children: (dndState: DndEntryState) => React.ReactElement;\r\n}\r\n\r\nexport const DnDFileEntry = React.memo(({ file, children }: DnDFileEntryProps) => {\r\n    const { drop, drag, dndState } = useFileEntryDnD(file);\r\n\r\n    useDndHoverOpen(file, dndState);\r\n    const classes = useStyles();\r\n    return (\r\n        <div ref={drop} className={classes.fillParent}>\r\n            <div\r\n                ref={FileHelper.isDraggable(file) ? drag : null}\r\n                className={classes.fillParent}\r\n            >\r\n                {children(dndState)}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport const useStyles = makeLocalChonkyStyles(() => ({\r\n    fillParent: {\r\n        height: '100%',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport c from 'classnames';\r\nimport React from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\n\r\nexport interface FileThumbnailProps {\r\n    className: string;\r\n    thumbnailUrl: Nullable<string>;\r\n}\r\n\r\nexport const FileThumbnail: React.FC<FileThumbnailProps> = React.memo(props => {\r\n    const { className, thumbnailUrl } = props;\r\n\r\n    const thumbnailStyle: React.CSSProperties = thumbnailUrl ? { backgroundImage: `url('${thumbnailUrl}')` } : {};\r\n\r\n    const classes = useStyles();\r\n    return <div className={c([className, classes.fileThumbnail])} style={thumbnailStyle} />;\r\n});\r\nFileThumbnail.displayName = 'FileThumbnail';\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    fileThumbnail: {\r\n        backgroundRepeat: 'no-repeat',\r\n        backgroundPosition: 'center',\r\n        backgroundSize: 'contain',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useContext } from 'react';\r\n\r\nimport { DndEntryState } from '../../types/file-list.types';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\r\nimport { useDndIcon } from './FileEntry-hooks';\r\n\r\nexport interface DnDIndicatorProps {\r\n    className: string;\r\n    dndState: DndEntryState;\r\n}\r\n\r\nexport const GridEntryDndIndicator: React.FC<DnDIndicatorProps> = React.memo(props => {\r\n    const { className: externalClassName, dndState } = props;\r\n    const dndIconName = useDndIcon(dndState);\r\n    const classes = useStyles(dndState);\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n    if (!dndIconName) return null;\r\n    const className = c({\r\n        [classes.dndIndicator]: true,\r\n        [externalClassName]: true,\r\n    });\r\n    return (\r\n        <div className={className}>\r\n            <ChonkyIcon icon={dndIconName} />\r\n        </div>\r\n    );\r\n});\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    dndIndicator: {\r\n        color: (dndState: DndEntryState) =>\r\n            dndState.dndIsOver\r\n                ? dndState.dndCanDrop\r\n                    ? theme.dnd.canDropColor\r\n                    : theme.dnd.cannotDropColor\r\n                : '#000',\r\n        boxSizing: 'border-box',\r\n        position: 'absolute',\r\n        fontSize: '1.2em',\r\n        opacity: 0.6,\r\n        padding: 6,\r\n        '&:before': {\r\n            borderBottom: '50px solid transparent',\r\n            borderLeft: '50px solid #fff',\r\n            position: 'absolute',\r\n            content: '\"\"',\r\n            zIndex: -1,\r\n            left: 0,\r\n            top: 0,\r\n        },\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { useContext, useEffect } from 'react';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { DndEntryState } from '../../types/file-list.types';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, important, makeLocalChonkyStyles } from '../../util/styles';\r\nimport { FileThumbnail } from './FileThumbnail';\r\nimport { GridEntryDndIndicator } from './GridEntryDndIndicator';\r\n\r\nexport type FileEntryState = {\r\n    childrenCount: Nullable<number>;\r\n    color: string;\r\n    icon: ChonkyIconName | string;\r\n    thumbnailUrl: Nullable<string>;\r\n    iconSpin: boolean;\r\n    selected: boolean;\r\n    focused: boolean;\r\n};\r\n\r\nexport interface FileEntryPreviewProps {\r\n    className?: string;\r\n    entryState: FileEntryState;\r\n    dndState: DndEntryState;\r\n}\r\n\r\nexport const GridEntryPreviewFolder: React.FC<FileEntryPreviewProps> = React.memo(props => {\r\n    const { className: externalClassName, entryState, dndState } = props;\r\n\r\n    const folderClasses = useFolderStyles(entryState);\r\n    const fileClasses = useFileStyles(entryState);\r\n    const commonClasses = useCommonEntryStyles(entryState);\r\n    const className = c({\r\n        [folderClasses.previewFile]: true,\r\n        [externalClassName || '']: !!externalClassName,\r\n    });\r\n    return (\r\n        <div className={className}>\r\n            <div className={folderClasses.folderBackSideMid}>\r\n                <div className={folderClasses.folderBackSideTop} />\r\n                <div className={folderClasses.folderFrontSide}>\r\n                    <GridEntryDndIndicator className={fileClasses.dndIndicator} dndState={dndState} />\r\n                    <div className={c([fileClasses.fileIcon, folderClasses.fileIcon])}>{entryState.childrenCount}</div>\r\n                    <div className={commonClasses.selectionIndicator}></div>\r\n                    <FileThumbnail className={fileClasses.thumbnail} thumbnailUrl={entryState.thumbnailUrl} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\nGridEntryPreviewFolder.displayName = 'GridEntryPreviewFolder';\r\n\r\nconst useFolderStyles = makeLocalChonkyStyles(theme => ({\r\n    previewFile: {\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n    },\r\n    folderBackSideTop: {\r\n        backgroundColor: (state: FileEntryState) => state.color,\r\n        boxShadow: (state: FileEntryState) => {\r\n            let color = theme.gridFileEntry.folderBackColorTint;\r\n            if (state.focused) color = 'rgba(0, 0, 0, 0.3)';\r\n            else if (state.selected) color = 'rgba(0, 153, 255, .4)';\r\n            return `inset ${color} 0 0 0 999px`;\r\n        },\r\n        borderTopLeftRadius: theme.gridFileEntry.borderRadius,\r\n        borderTopRightRadius: 10,\r\n        position: 'absolute',\r\n        right: '60%',\r\n        height: 13,\r\n        top: -10,\r\n        left: 0,\r\n        '&:after': {\r\n            borderRightColor: theme.palette.background.paper,\r\n            borderTopColor: theme.palette.background.paper,\r\n            borderBottomColor: 'transparent',\r\n            borderLeftColor: 'transparent',\r\n            borderWidth: [0, 15, 10, 0],\r\n            borderStyle: 'solid',\r\n            position: 'absolute',\r\n            display: 'block',\r\n            content: '\"\"',\r\n            right: 0,\r\n            top: 0,\r\n        },\r\n    },\r\n    folderBackSideMid: {\r\n        backgroundColor: (state: FileEntryState) => state.color,\r\n        boxShadow: (state: FileEntryState) => {\r\n            let color = theme.gridFileEntry.folderBackColorTint;\r\n            if (state.focused) color = 'rgba(0, 0, 0, 0.3)';\r\n            else if (state.selected) color = 'rgba(0, 153, 255, .4)';\r\n            return `inset ${color} 0 0 0 999px`;\r\n        },\r\n        borderTopRightRadius: theme.gridFileEntry.borderRadius,\r\n        position: 'absolute',\r\n        bottom: 0,\r\n        right: 0,\r\n        left: 0,\r\n        top: 10,\r\n    },\r\n    folderFrontSide: {\r\n        boxShadow: (state: FileEntryState) => {\r\n            const shadows: string[] = [];\r\n            if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\r\n            if (state.selected) shadows.push('inset rgba(0, 153, 255, .65) 0 0 0 3px');\r\n            shadows.push(`inset ${theme.gridFileEntry.folderFrontColorTint} 0 0 0 999px`);\r\n            return shadows.join(', ');\r\n        },\r\n        backgroundColor: (state: FileEntryState) => state.color,\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        position: 'absolute',\r\n        overflow: 'hidden',\r\n        bottom: 0,\r\n        right: 0,\r\n        left: 0,\r\n        top: 10,\r\n    },\r\n    fileIcon: {\r\n        fontSize: important(theme.gridFileEntry.childrenCountSize),\r\n    },\r\n}));\r\n\r\nexport const GridEntryPreviewFile: React.FC<FileEntryPreviewProps> = React.memo(props => {\r\n    const { className: externalClassName, entryState, dndState } = props;\r\n\r\n    const fileClasses = useFileStyles(entryState);\r\n    const commonClasses = useCommonEntryStyles(entryState);\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n    const className = c({\r\n        [fileClasses.previewFile]: true,\r\n        [externalClassName || '']: !!externalClassName,\r\n    });\r\n    return (\r\n        <div className={className}>\r\n            <GridEntryDndIndicator className={fileClasses.dndIndicator} dndState={dndState} />\r\n            <div className={fileClasses.fileIcon}>\r\n                <ChonkyIcon icon={entryState.icon} spin={entryState.iconSpin} />\r\n            </div>\r\n            <div className={commonClasses.selectionIndicator}></div>\r\n            <FileThumbnail className={fileClasses.thumbnail} thumbnailUrl={entryState.thumbnailUrl} />\r\n        </div>\r\n    );\r\n});\r\nGridEntryPreviewFile.displayName = 'GridEntryPreviewFile';\r\n\r\nconst useFileStyles = makeLocalChonkyStyles(theme => ({\r\n    previewFile: {\r\n        boxShadow: (state: FileEntryState) => {\r\n            const shadows: string[] = [];\r\n            if (state.selected) shadows.push('inset rgba(0,153,255, .65) 0 0 0 3px');\r\n            if (state.focused) shadows.push('inset rgba(0, 0, 0, 1) 0 0 0 3px');\r\n            shadows.push(`inset ${theme.gridFileEntry.fileColorTint} 0 0 0 999px`);\r\n            return shadows.join(', ');\r\n        },\r\n        backgroundColor: (state: FileEntryState) => state.color,\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        position: 'relative',\r\n        overflow: 'hidden',\r\n    },\r\n    dndIndicator: {\r\n        zIndex: 14,\r\n    },\r\n    fileIcon: {\r\n        transform: 'translateX(-50%) translateY(-50%)',\r\n        fontSize: theme.gridFileEntry.iconSize,\r\n        opacity: (state: FileEntryState) => (state.thumbnailUrl && !state.focused ? 0 : 1),\r\n        color: (state: FileEntryState) =>\r\n            state.focused ? theme.gridFileEntry.iconColorFocused : theme.gridFileEntry.iconColor,\r\n        position: 'absolute',\r\n        left: '50%',\r\n        zIndex: 12,\r\n        top: '50%',\r\n    },\r\n    thumbnail: {\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        position: 'absolute',\r\n        zIndex: 6,\r\n        bottom: 5,\r\n        right: 5,\r\n        left: 5,\r\n        top: 5,\r\n    },\r\n}));\r\n\r\nexport const useCommonEntryStyles = makeLocalChonkyStyles(() => ({\r\n    selectionIndicator: {\r\n        display: (state: FileEntryState) => (state.selected ? 'block' : 'none'),\r\n        background:\r\n            'repeating-linear-gradient(' +\r\n            '45deg,' +\r\n            'rgba(0,153,255,.14),' +\r\n            'rgba(0,153,255,.14) 10px,' +\r\n            'rgba(0,153,255,.25) 0,' +\r\n            'rgba(0,153,255,.25) 20px' +\r\n            ')',\r\n        backgroundColor: 'rgba(0, 153, 255, .14)',\r\n        position: 'absolute',\r\n        height: '100%',\r\n        width: '100%',\r\n        zIndex: 10,\r\n    },\r\n    focusIndicator: {\r\n        display: (state: FileEntryState) => (state.focused ? 'block' : 'none'),\r\n        boxShadow: 'inset rgba(0, 0, 0, 1) 0 0 0 2px',\r\n        position: 'absolute',\r\n        height: '100%',\r\n        width: '100%',\r\n        zIndex: 11,\r\n    },\r\n}));\r\n","import React from 'react';\r\n\r\nimport { FileEntryProps } from '../../types/file-list.types';\r\nimport { FileHelper } from '../../util/file-helper';\r\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\r\nimport { useFileEntryHtmlProps, useFileEntryState } from './FileEntry-hooks';\r\nimport { FileEntryName } from './FileEntryName';\r\nimport { FileEntryState, GridEntryPreviewFile, GridEntryPreviewFolder } from './GridEntryPreview';\r\n\r\nexport const GridEntry: React.FC<FileEntryProps> = React.memo(({ file, selected, focused, dndState }) => {\r\n    const isDirectory = FileHelper.isDirectory(file);\r\n    const entryState = useFileEntryState(file, selected, focused);\r\n\r\n    const classes = useFileEntryStyles(entryState);\r\n    const fileEntryHtmlProps = useFileEntryHtmlProps(file);\r\n    const entryClassName = c({\r\n        [classes.gridFileEntry]: true,\r\n    });\r\n    return (\r\n        <div className={entryClassName} {...fileEntryHtmlProps}>\r\n            {isDirectory ? (\r\n                <GridEntryPreviewFolder\r\n                    className={classes.gridFileEntryPreview}\r\n                    entryState={entryState}\r\n                    dndState={dndState}\r\n                />\r\n            ) : (\r\n                <GridEntryPreviewFile\r\n                    className={classes.gridFileEntryPreview}\r\n                    entryState={entryState}\r\n                    dndState={dndState}\r\n                />\r\n            )}\r\n            <div className={classes.gridFileEntryNameContainer}>\r\n                <FileEntryName className={classes.gridFileEntryName} file={file} />\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\nGridEntry.displayName = 'GridEntry';\r\n\r\nconst useFileEntryStyles = makeLocalChonkyStyles(theme => ({\r\n    gridFileEntry: {\r\n        flexDirection: 'column',\r\n        display: 'flex',\r\n        height: '100%',\r\n    },\r\n    gridFileEntryPreview: {\r\n        flexGrow: 1,\r\n    },\r\n    gridFileEntryNameContainer: {\r\n        fontSize: theme.gridFileEntry.fontSize,\r\n        wordBreak: 'break-word',\r\n        textAlign: 'center',\r\n        paddingTop: 5,\r\n    },\r\n    gridFileEntryName: {\r\n        backgroundColor: (state: FileEntryState) => (state.selected ? 'rgba(0,153,255, .25)' : 'transparent'),\r\n        textDecoration: (state: FileEntryState) => (state.focused ? 'underline' : 'none'),\r\n        borderRadius: 3,\r\n        padding: [2, 4],\r\n    },\r\n}));\r\n","import React, { useContext, useMemo } from 'react';\r\n\r\nimport { DndEntryState, FileEntryProps } from '../../types/file-list.types';\r\nimport { useLocalizedFileEntryStrings } from '../../util/i18n';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport { c, makeLocalChonkyStyles } from '../../util/styles';\r\nimport { TextPlaceholder } from '../external/TextPlaceholder';\r\nimport {\r\n    useDndIcon,\r\n    useFileEntryHtmlProps,\r\n    useFileEntryState,\r\n} from './FileEntry-hooks';\r\nimport { FileEntryName } from './FileEntryName';\r\nimport { FileEntryState, useCommonEntryStyles } from './GridEntryPreview';\r\n\r\ninterface StyleState {\r\n    entryState: FileEntryState;\r\n    dndState: DndEntryState;\r\n}\r\n\r\nexport const ListEntry: React.FC<FileEntryProps> = React.memo(\r\n    ({ file, selected, focused, dndState }) => {\r\n        const entryState: FileEntryState = useFileEntryState(file, selected, focused);\r\n        const dndIconName = useDndIcon(dndState);\r\n\r\n        const { fileModDateString, fileSizeString } = useLocalizedFileEntryStrings(\r\n            file\r\n        );\r\n        const styleState = useMemo<StyleState>(\r\n            () => ({\r\n                entryState,\r\n                dndState,\r\n            }),\r\n            [dndState, entryState]\r\n        );\r\n        const classes = useStyles(styleState);\r\n        const commonClasses = useCommonEntryStyles(entryState);\r\n        const ChonkyIcon = useContext(ChonkyIconContext);\r\n        const fileEntryHtmlProps = useFileEntryHtmlProps(file);\r\n        return (\r\n            <div className={classes.listFileEntry} {...fileEntryHtmlProps}>\r\n                <div className={commonClasses.focusIndicator}></div>\r\n                <div\r\n                    className={c([\r\n                        commonClasses.selectionIndicator,\r\n                        classes.listFileEntrySelection,\r\n                    ])}\r\n                ></div>\r\n                <div className={classes.listFileEntryIcon}>\r\n                    <ChonkyIcon\r\n                        icon={dndIconName ?? entryState.icon}\r\n                        spin={dndIconName ? false : entryState.iconSpin}\r\n                        fixedWidth={true}\r\n                    />\r\n                </div>\r\n                <div\r\n                    className={classes.listFileEntryName}\r\n                    title={file ? file.name : undefined}\r\n                >\r\n                    <FileEntryName file={file} />\r\n                </div>\r\n                <div className={classes.listFileEntryProperty}>\r\n                    {file ? (\r\n                        fileModDateString ?? <span></span>\r\n                    ) : (\r\n                        <TextPlaceholder minLength={5} maxLength={15} />\r\n                    )}\r\n                </div>\r\n                <div className={classes.listFileEntryProperty}>\r\n                    {file ? (\r\n                        fileSizeString ?? <span></span>\r\n                    ) : (\r\n                        <TextPlaceholder minLength={10} maxLength={20} />\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n);\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    listFileEntry: {\r\n        boxShadow: `inset ${theme.palette.divider} 0 -1px 0`,\r\n        fontSize: theme.listFileEntry.fontSize,\r\n        color: ({ dndState }: StyleState) =>\r\n            dndState.dndIsOver\r\n                ? dndState.dndCanDrop\r\n                    ? theme.dnd.canDropColor\r\n                    : theme.dnd.cannotDropColor\r\n                : 'inherit',\r\n        alignItems: 'center',\r\n        position: 'relative',\r\n        display: 'flex',\r\n        height: '100%',\r\n    },\r\n    listFileEntrySelection: {\r\n        opacity: 0.6,\r\n    },\r\n    listFileEntryIcon: {\r\n        color: ({ entryState, dndState }: StyleState) =>\r\n            dndState.dndIsOver\r\n                ? dndState.dndCanDrop\r\n                    ? theme.dnd.canDropColor\r\n                    : theme.dnd.cannotDropColor\r\n                : entryState.color,\r\n        fontSize: theme.listFileEntry.iconFontSize,\r\n        boxSizing: 'border-box',\r\n        padding: [2, 4],\r\n        zIndex: 20,\r\n    },\r\n    listFileEntryName: {\r\n        textOverflow: 'ellipsis',\r\n        boxSizing: 'border-box',\r\n        whiteSpace: 'nowrap',\r\n        overflow: 'hidden',\r\n        flex: '1 1 300px',\r\n        paddingLeft: 8,\r\n        zIndex: 20,\r\n    },\r\n    listFileEntryProperty: {\r\n        fontSize: theme.listFileEntry.propertyFontSize,\r\n        boxSizing: 'border-box',\r\n        whiteSpace: 'nowrap',\r\n        overflow: 'hidden',\r\n        flex: '0 1 150px',\r\n        padding: [2, 8],\r\n        zIndex: 20,\r\n    },\r\n}));\r\n","import React, { useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Nullable } from 'tsdef';\r\n\r\nimport { selectFileData, selectIsDnDDisabled, selectIsFileSelected } from '../../redux/selectors';\r\nimport { useParamSelector } from '../../redux/store';\r\nimport { DndEntryState, FileEntryProps } from '../../types/file-list.types';\r\nimport { FileViewMode } from '../../types/file-view.types';\r\nimport { FileHelper } from '../../util/file-helper';\r\nimport { makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { ClickableWrapper, ClickableWrapperProps } from '../internal/ClickableWrapper';\r\nimport { CompactEntry } from './CompactEntry';\r\nimport { DnDFileEntry } from './DnDFileEntry';\r\nimport { useFileClickHandlers } from './FileEntry-hooks';\r\nimport { GridEntry } from './GridEntry';\r\nimport { ListEntry } from './ListEntry';\r\n\r\nexport interface SmartFileEntryProps {\r\n    fileId: Nullable<string>;\r\n    displayIndex: number;\r\n    fileViewMode: FileViewMode;\r\n}\r\n\r\nconst disabledDndState: DndEntryState = {\r\n    dndIsDragging: false,\r\n    dndIsOver: false,\r\n    dndCanDrop: false,\r\n};\r\n\r\nexport const SmartFileEntry: React.FC<SmartFileEntryProps> = React.memo(({ fileId, displayIndex, fileViewMode }) => {\r\n    const classes = useStyles();\r\n\r\n    // Basic properties\r\n    const file = useParamSelector(selectFileData, fileId);\r\n    const selected = useParamSelector(selectIsFileSelected, fileId);\r\n    const dndDisabled = useSelector(selectIsDnDDisabled);\r\n\r\n    // Clickable wrapper properties\r\n    const fileClickHandlers = useFileClickHandlers(file, displayIndex);\r\n    const [focused, setFocused] = useState(false);\r\n    const clickableWrapperProps: ClickableWrapperProps = {\r\n        wrapperTag: 'div',\r\n        passthroughProps: { className: classes.fileEntryClickableWrapper },\r\n        ...(FileHelper.isClickable(file) ? fileClickHandlers : undefined),\r\n        setFocused,\r\n    };\r\n\r\n    // File entry properties\r\n    const fileEntryProps: Omit<FileEntryProps, 'dndState'> = {\r\n        file,\r\n        selected,\r\n        focused,\r\n    };\r\n\r\n    let EntryComponent: React.FC<FileEntryProps>;\r\n    if (fileViewMode === FileViewMode.List) EntryComponent = ListEntry;\r\n    else if (fileViewMode === FileViewMode.Compact) EntryComponent = CompactEntry;\r\n    else EntryComponent = GridEntry;\r\n\r\n    return dndDisabled ? (\r\n        <ClickableWrapper {...clickableWrapperProps}>\r\n            <EntryComponent {...fileEntryProps} dndState={disabledDndState} />\r\n        </ClickableWrapper>\r\n    ) : (\r\n        <DnDFileEntry file={file}>\r\n            {dndState => (\r\n                <ClickableWrapper {...clickableWrapperProps}>\r\n                    <EntryComponent {...fileEntryProps} dndState={dndState} />\r\n                </ClickableWrapper>\r\n            )}\r\n        </DnDFileEntry>\r\n    );\r\n});\r\nSmartFileEntry.displayName = 'SmartFileEntry';\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    fileEntryClickableWrapper: {\r\n        // We disable default browser outline because Chonky provides its own outline\r\n        // (which doesn't compromise accessibility, hopefully)\r\n        outline: 'none !important',\r\n        position: 'relative',\r\n        height: '100%',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { CSSProperties, useCallback, useEffect, useMemo, useRef, useState } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { VariableSizeGrid } from 'react-window';\r\n\r\nimport { ChonkyActions } from '../../action-definitions';\r\nimport { selectFileViewConfig, selectors } from '../../redux/selectors';\r\nimport { FileViewConfigGrid } from '../../types/file-view.types';\r\nimport { RootState } from '../../types/redux.types';\r\nimport { useInstanceVariable } from '../../util/hooks-helpers';\r\nimport { makeGlobalChonkyStyles, useIsMobileBreakpoint } from '../../util/styles';\r\nimport { SmartFileEntry } from './FileEntry';\r\n\r\nexport interface FileListGridProps {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\ninterface GridConfig {\r\n    rowCount: number;\r\n    columnCount: number;\r\n    gutter: number;\r\n    rowHeight: number;\r\n    columnWidth: number;\r\n}\r\n\r\nexport const isMobileDevice = () => {\r\n    // noinspection JSDeprecatedSymbols\r\n    return typeof window.orientation !== 'undefined' || navigator.userAgent.indexOf('IEMobile') !== -1;\r\n};\r\n\r\nexport const getGridConfig = (\r\n    width: number,\r\n    fileCount: number,\r\n    viewConfig: FileViewConfigGrid,\r\n    isMobileBreakpoint: boolean\r\n): GridConfig => {\r\n    const gutter = isMobileBreakpoint ? 5 : 8;\r\n    const scrollbar = isMobileDevice() ? 0 : 18;\r\n\r\n    let columnCount: number;\r\n    let columnWidth: number;\r\n    if (isMobileBreakpoint) {\r\n        columnCount = 2;\r\n        columnWidth = (width - gutter - scrollbar) / columnCount;\r\n    } else {\r\n        columnWidth = viewConfig.entryWidth;\r\n        columnCount = Math.max(1, Math.floor((width - scrollbar) / (columnWidth + gutter)));\r\n    }\r\n\r\n    const rowCount = Math.ceil(fileCount / columnCount);\r\n\r\n    return {\r\n        rowCount,\r\n        columnCount,\r\n        gutter,\r\n        rowHeight: viewConfig.entryHeight,\r\n        columnWidth,\r\n    };\r\n};\r\n\r\nexport const GridContainer: React.FC<FileListGridProps> = React.memo(props => {\r\n    const { width, height } = props;\r\n\r\n    const viewConfig = useSelector(selectFileViewConfig) as FileViewConfigGrid;\r\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\r\n    const fileCount = useMemo(() => displayFileIds.length, [displayFileIds]);\r\n\r\n    const gridRef = useRef<VariableSizeGrid>();\r\n    const isMobileBreakpoint = useIsMobileBreakpoint();\r\n\r\n    // Whenever the grid config changes at runtime, we call a method on the\r\n    // `VariableSizeGrid` handle to reset column width/row height cache.\r\n    // !!! Note that we deliberately update the `gridRef` firsts and update the React\r\n    //     state AFTER that. This is needed to avoid file entries jumping up/down.\r\n    const [gridConfig, setGridConfig] = useState(getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint));\r\n    const gridConfigRef = useRef(gridConfig);\r\n    useEffect(() => {\r\n        const oldConf = gridConfigRef.current;\r\n        const newConf = getGridConfig(width, fileCount, viewConfig, isMobileBreakpoint);\r\n\r\n        gridConfigRef.current = newConf;\r\n        if (gridRef.current) {\r\n            if (oldConf.rowCount !== newConf.rowCount) {\r\n                gridRef.current.resetAfterRowIndex(Math.min(oldConf.rowCount, newConf.rowCount) - 1);\r\n            }\r\n            if (oldConf.columnCount !== newConf.columnCount) {\r\n                gridRef.current.resetAfterColumnIndex(Math.min(oldConf.columnCount, newConf.rowCount) - 1);\r\n            }\r\n            if (oldConf.columnWidth !== newConf.columnWidth) {\r\n                gridRef.current.resetAfterIndices({ columnIndex: 0, rowIndex: 0 });\r\n            }\r\n        }\r\n\r\n        setGridConfig(newConf);\r\n    }, [setGridConfig, gridConfigRef, isMobileBreakpoint, width, viewConfig, fileCount]);\r\n\r\n    const sizers = useMemo(() => {\r\n        const gc = gridConfigRef;\r\n        return {\r\n            getColumnWidth: (index: number) =>\r\n                gc.current.columnWidth! + (index === gc.current.columnCount - 1 ? 0 : gc.current.gutter),\r\n            getRowHeight: (index: number) =>\r\n                gc.current.rowHeight + (index === gc.current.rowCount - 1 ? 0 : gc.current.gutter),\r\n        };\r\n    }, [gridConfigRef]);\r\n\r\n    const displayFileIdsRef = useInstanceVariable(useSelector(selectors.getDisplayFileIds));\r\n    const getItemKey = useCallback(\r\n        (data: { columnIndex: number; rowIndex: number; data: any }) => {\r\n            const index = data.rowIndex * gridConfigRef.current.columnCount + data.columnIndex;\r\n\r\n            return displayFileIdsRef.current[index] ?? `loading-file-${index}`;\r\n        },\r\n        [gridConfigRef, displayFileIdsRef]\r\n    );\r\n\r\n    const cellRenderer = useCallback(\r\n        (data: { rowIndex: number; columnIndex: number; style: CSSProperties }) => {\r\n            const gc = gridConfigRef;\r\n            const index = data.rowIndex * gc.current.columnCount + data.columnIndex;\r\n            const fileId = displayFileIds[index];\r\n            if (displayFileIds[index] === undefined) return null;\r\n\r\n            const styleWithGutter: CSSProperties = {\r\n                ...data.style,\r\n                paddingRight: data.columnIndex === gc.current.columnCount - 1 ? 0 : gc.current.gutter,\r\n                paddingBottom: data.rowIndex === gc.current.rowCount - 1 ? 0 : gc.current.gutter,\r\n                boxSizing: 'border-box',\r\n            };\r\n\r\n            return (\r\n                <div style={styleWithGutter}>\r\n                    <SmartFileEntry fileId={fileId ?? null} displayIndex={index} fileViewMode={viewConfig.mode} />\r\n                </div>\r\n            );\r\n        },\r\n        [displayFileIds, viewConfig.mode]\r\n    );\r\n\r\n    const classes = useStyles();\r\n    const gridComponent = useMemo(() => {\r\n        return (\r\n            <VariableSizeGrid\r\n                ref={gridRef as any}\r\n                className={classes.gridContainer}\r\n                estimatedRowHeight={gridConfig.rowHeight + gridConfig.gutter}\r\n                rowHeight={sizers.getRowHeight}\r\n                estimatedColumnWidth={gridConfig.columnWidth + gridConfig.gutter}\r\n                columnWidth={sizers.getColumnWidth}\r\n                columnCount={gridConfig.columnCount}\r\n                height={height}\r\n                rowCount={gridConfig.rowCount}\r\n                width={width}\r\n                itemKey={getItemKey}\r\n            >\r\n                {cellRenderer}\r\n            </VariableSizeGrid>\r\n        );\r\n    }, [\r\n        classes.gridContainer,\r\n        gridConfig.rowHeight,\r\n        gridConfig.gutter,\r\n        gridConfig.columnWidth,\r\n        gridConfig.columnCount,\r\n        gridConfig.rowCount,\r\n        sizers.getRowHeight,\r\n        sizers.getColumnWidth,\r\n        height,\r\n        width,\r\n        getItemKey,\r\n        cellRenderer,\r\n    ]);\r\n\r\n    return gridComponent;\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    gridContainer: {},\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { CSSProperties, useCallback, useMemo, useRef } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { FixedSizeList } from 'react-window';\r\n\r\nimport { selectFileViewConfig, selectors } from '../../redux/selectors';\r\nimport { FileViewMode } from '../../types/file-view.types';\r\nimport { useInstanceVariable } from '../../util/hooks-helpers';\r\nimport { makeLocalChonkyStyles } from '../../util/styles';\r\nimport { SmartFileEntry } from './FileEntry';\r\n\r\nexport interface FileListListProps {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport const ListContainer: React.FC<FileListListProps> = React.memo(props => {\r\n    const { width, height } = props;\r\n\r\n    const viewConfig = useSelector(selectFileViewConfig);\r\n\r\n    const listRef = useRef<FixedSizeList>();\r\n\r\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\r\n    const displayFileIdsRef = useInstanceVariable(displayFileIds);\r\n    const getItemKey = useCallback(\r\n        (index: number) => displayFileIdsRef.current[index] ?? `loading-file-${index}`,\r\n        [displayFileIdsRef]\r\n    );\r\n\r\n    const classes = useStyles();\r\n    const listComponent = useMemo(() => {\r\n        // When entry size is null, we use List view\r\n        const rowRenderer = (data: { index: number; style: CSSProperties }) => {\r\n            return (\r\n                <div style={data.style}>\r\n                    <SmartFileEntry\r\n                        fileId={displayFileIds[data.index] ?? null}\r\n                        displayIndex={data.index}\r\n                        fileViewMode={FileViewMode.List}\r\n                    />\r\n                </div>\r\n            );\r\n        };\r\n\r\n        return (\r\n            <FixedSizeList\r\n                ref={listRef as any}\r\n                className={classes.listContainer}\r\n                itemSize={viewConfig.entryHeight}\r\n                height={height}\r\n                itemCount={displayFileIds.length}\r\n                width={width}\r\n                itemKey={getItemKey}\r\n            >\r\n                {rowRenderer}\r\n            </FixedSizeList>\r\n        );\r\n    }, [\r\n        classes.listContainer,\r\n        viewConfig.entryHeight,\r\n        height,\r\n        displayFileIds,\r\n        width,\r\n        getItemKey,\r\n    ]);\r\n\r\n    return listComponent;\r\n});\r\n\r\nconst useStyles = makeLocalChonkyStyles(theme => ({\r\n    listContainer: {\r\n        borderTop: `solid 1px ${theme.palette.divider}`,\r\n    },\r\n}));\r\n","import React, { UIEvent, useCallback, useContext, useMemo } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport AutoSizer from 'react-virtualized-auto-sizer';\r\n\r\nimport { ChonkyActions } from '../../action-definitions/index';\r\nimport { selectCurrentFolder, selectFileViewConfig, selectors } from '../../redux/selectors';\r\nimport { FileViewMode } from '../../types/file-view.types';\r\nimport { ChonkyIconName } from '../../types/icons.types';\r\nimport { useFileDrop } from '../../util/dnd';\r\nimport { ChonkyIconContext } from '../../util/icon-helper';\r\nimport {\r\n    c, getStripeGradient, makeGlobalChonkyStyles, makeLocalChonkyStyles\r\n} from '../../util/styles';\r\nimport { FileListEmpty } from './FileListEmpty';\r\nimport { GridContainer } from './GridContainer';\r\nimport { ListContainer } from './ListContainer';\r\n\r\nexport interface FileListProps {\r\n    onScroll?: (e: UIEvent<HTMLDivElement>) => void;\r\n}\r\n\r\ninterface StyleState {\r\n    dndCanDrop: boolean;\r\n    dndIsOverCurrent: boolean;\r\n}\r\n\r\nexport const FileList: React.FC<FileListProps> = React.memo((props: FileListProps) => {\r\n    const displayFileIds = useSelector(selectors.getDisplayFileIds);\r\n    const viewConfig = useSelector(selectFileViewConfig);\r\n\r\n    const currentFolder = useSelector(selectCurrentFolder);\r\n    const { drop, dndCanDrop, dndIsOverCurrent } = useFileDrop({ file: currentFolder });\r\n    const styleState = useMemo<StyleState>(() => ({ dndCanDrop, dndIsOverCurrent }), [dndCanDrop, dndIsOverCurrent]);\r\n\r\n    const localClasses = useLocalStyles(styleState);\r\n    const classes = useStyles(viewConfig);\r\n    const { onScroll } = props;\r\n\r\n    // In Chonky v0.x, this field was user-configurable. In Chonky v1.x+, we hardcode\r\n    // this to `true` to simplify configuration. Users can just wrap Chonky in their\r\n    // own `div` if they want to have finer control over the height.\r\n    const fillParentContainer = true;\r\n\r\n    const listRenderer = useCallback(\r\n        ({ width, height }: { width: number; height: number }) => {\r\n            if (displayFileIds.length === 0) {\r\n                return <FileListEmpty width={width} height={viewConfig.entryHeight} />;\r\n            } else if (viewConfig.mode === FileViewMode.List) {\r\n                return <ListContainer width={width} height={height} />;\r\n            } else {\r\n                return <GridContainer width={width} height={height} />;\r\n            }\r\n        },\r\n        [displayFileIds, viewConfig]\r\n    );\r\n\r\n    const ChonkyIcon = useContext(ChonkyIconContext);\r\n    return (\r\n        <div onScroll={onScroll} ref={drop} className={c([classes.fileListWrapper, localClasses.fileListWrapper])} role=\"list\">\r\n            <div className={localClasses.dndDropZone}>\r\n                <div className={localClasses.dndDropZoneIcon}>\r\n                    <ChonkyIcon icon={dndCanDrop ? ChonkyIconName.dndCanDrop : ChonkyIconName.dndCannotDrop} />\r\n                </div>\r\n            </div>\r\n            <AutoSizer disableHeight={!fillParentContainer}>{listRenderer}</AutoSizer>\r\n        </div>\r\n    );\r\n});\r\nFileList.displayName = 'FileList';\r\n\r\nconst useLocalStyles = makeLocalChonkyStyles(theme => ({\r\n    fileListWrapper: {\r\n        minHeight: ChonkyActions.EnableGridView.fileViewConfig.entryHeight + 2,\r\n        background: (state: StyleState) =>\r\n            state.dndIsOverCurrent && state.dndCanDrop\r\n                ? state.dndCanDrop\r\n                    ? getStripeGradient(theme.dnd.fileListCanDropMaskOne, theme.dnd.fileListCanDropMaskTwo)\r\n                    : getStripeGradient(theme.dnd.fileListCannotDropMaskOne, theme.dnd.fileListCannotDropMaskTwo)\r\n                : 'none',\r\n    },\r\n    dndDropZone: {\r\n        display: (state: StyleState) =>\r\n            // When we cannot drop, we don't show an indicator at all\r\n            state.dndIsOverCurrent && state.dndCanDrop ? 'block' : 'none',\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        pointerEvents: 'none',\r\n        position: 'absolute',\r\n        height: '100%',\r\n        width: '100%',\r\n        zIndex: 2,\r\n    },\r\n    dndDropZoneIcon: {\r\n        backgroundColor: (state: StyleState) => (state.dndCanDrop ? theme.dnd.canDropMask : theme.dnd.cannotDropMask),\r\n        color: (state: StyleState) => (state.dndCanDrop ? theme.dnd.canDropColor : theme.dnd.cannotDropColor),\r\n        borderRadius: theme.gridFileEntry.borderRadius,\r\n        transform: 'translateX(-50%) translateY(-50%)',\r\n        position: 'absolute',\r\n        textAlign: 'center',\r\n        lineHeight: '60px',\r\n        fontSize: '2em',\r\n        left: '50%',\r\n        height: 60,\r\n        top: '50%',\r\n        width: 60,\r\n    },\r\n}));\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    fileListWrapper: {\r\n        height: '100%',\r\n        maxHeight: '100%',\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React, { ReactElement, useEffect, useMemo } from 'react';\r\nimport { useIntl } from 'react-intl';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport ListSubheader from '@mui/material/ListSubheader';\r\nimport Menu from '@mui/material/Menu';\r\n\r\nimport { reduxActions } from '../../redux/reducers';\r\nimport { selectContextMenuConfig, selectContextMenuItems } from '../../redux/selectors';\r\nimport { getI18nId, I18nNamespace } from '../../util/i18n';\r\nimport { important, makeGlobalChonkyStyles } from '../../util/styles';\r\nimport { useContextMenuDismisser } from './FileContextMenu-hooks';\r\nimport { SmartToolbarDropdownButton } from './ToolbarDropdownButton';\r\n\r\nexport interface FileContextMenuProps {}\r\n\r\nexport const FileContextMenu: React.FC<FileContextMenuProps> = React.memo(() => {\r\n    const dispatch = useDispatch();\r\n    useEffect(() => {\r\n        dispatch(reduxActions.setContextMenuMounted(true));\r\n        return () => {\r\n            dispatch(reduxActions.setContextMenuMounted(false));\r\n        };\r\n    }, [dispatch]);\r\n\r\n    const intl = useIntl();\r\n    const browserMenuShortcutString = intl.formatMessage(\r\n        {\r\n            id: getI18nId(I18nNamespace.FileContextMenu, 'browserMenuShortcut'),\r\n            defaultMessage: 'Browser menu: {shortcut}',\r\n        },\r\n        { shortcut: <strong>Alt + Right Click</strong> }\r\n    );\r\n\r\n    const contextMenuConfig = useSelector(selectContextMenuConfig);\r\n    const contextMenuItems = useSelector(selectContextMenuItems);\r\n\r\n    const hideContextMenu = useContextMenuDismisser();\r\n    const contextMenuItemComponents = useMemo(() => {\r\n        const components: ReactElement[] = [];\r\n        for (let i = 0; i < contextMenuItems.length; ++i) {\r\n            const item = contextMenuItems[i];\r\n\r\n            if (typeof item === 'string') {\r\n                components.push(\r\n                    <SmartToolbarDropdownButton\r\n                        key={`context-menu-item-${item}`}\r\n                        fileActionId={item}\r\n                        onClickFollowUp={hideContextMenu}\r\n                    />\r\n                );\r\n            } else {\r\n                item.fileActionIds.map(id =>\r\n                    components.push(\r\n                        <SmartToolbarDropdownButton\r\n                            key={`context-menu-item-${item.name}-${id}`}\r\n                            fileActionId={id}\r\n                            onClickFollowUp={hideContextMenu}\r\n                        />\r\n                    )\r\n                );\r\n            }\r\n        }\r\n        return components;\r\n    }, [contextMenuItems, hideContextMenu]);\r\n\r\n    const anchorPosition = useMemo(\r\n        () => (contextMenuConfig ? { top: contextMenuConfig.mouseY, left: contextMenuConfig.mouseX } : undefined),\r\n        [contextMenuConfig]\r\n    );\r\n\r\n    const classes = useStyles();\r\n    return (\r\n        <Menu\r\n            elevation={2}\r\n            disablePortal\r\n            onClose={hideContextMenu}\r\n            transitionDuration={150}\r\n            open={!!contextMenuConfig}\r\n            anchorPosition={anchorPosition}\r\n            anchorReference=\"anchorPosition\"\r\n            classes={{ list: classes.contextMenuList }}\r\n        >\r\n            {contextMenuItemComponents}\r\n            <ListSubheader component=\"div\" className={classes.browserMenuTooltip}>\r\n                {browserMenuShortcutString}\r\n            </ListSubheader>\r\n        </Menu>\r\n    );\r\n});\r\n\r\nconst useStyles = makeGlobalChonkyStyles(() => ({\r\n    contextMenuList: {\r\n        paddingBottom: important(0),\r\n        paddingTop: important(0),\r\n    },\r\n    browserMenuTooltip: {\r\n        lineHeight: important('30px'),\r\n        fontSize: important('0.7em'),\r\n    },\r\n}));\r\n","/**\r\n * @author Timur Kuzhagaliyev <tim.kuzh@gmail.com>\r\n * @copyright 2020\r\n * @license MIT\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport { FileBrowserHandle, FileBrowserProps } from '../../types/file-browser.types';\r\nimport { FileList } from '../file-list/FileList';\r\nimport { FileBrowser } from './FileBrowser';\r\nimport { FileContextMenu } from './FileContextMenu';\r\nimport { FileNavbar } from './FileNavbar';\r\nimport { FileToolbar } from './FileToolbar';\r\n\r\nexport const FullFileBrowser = React.memo(\r\n    React.forwardRef<FileBrowserHandle, FileBrowserProps>((props, ref) => {\r\n        const { onScroll } = props\r\n        return (\r\n            <FileBrowser ref={ref} {...props}>\r\n                <FileNavbar />\r\n                <FileToolbar />\r\n                <FileList onScroll={onScroll}/>\r\n                <FileContextMenu/>\r\n            </FileBrowser>\r\n        );\r\n    })\r\n);\r\nFullFileBrowser.displayName = 'FullFileBrowser';\r\n","/**\r\n *\r\n */\r\n\r\nimport { useCallback, useMemo, useState } from 'react';\r\n\r\nimport { ChonkyActions } from '../action-definitions';\r\nimport { FileActionData } from '../types/action-handler.types';\r\nimport { FileAction } from '../types/action.types';\r\nimport { FileArray, FileData } from '../types/file.types';\r\nimport { FileHelper } from '../util/file-helper';\r\n\r\nexport interface CustomFileData extends FileData {\r\n    parentId?: string;\r\n    childrenIds?: string[];\r\n}\r\nexport interface CustomFileMap<FT extends CustomFileData> {\r\n    [fileId: string]: FT;\r\n}\r\nexport interface FileMapParams<FT extends CustomFileData> {\r\n    baseFileMap: CustomFileMap<FT>;\r\n    initialFolderId: string;\r\n}\r\n\r\nexport const useFolderChain = <FT extends CustomFileData>(\r\n    fileMap: CustomFileMap<FT>,\r\n    currentFolderId: string\r\n): FileArray<FT> => {\r\n    return useMemo(() => {\r\n        const currentFolder = fileMap[currentFolderId];\r\n\r\n        const folderChain = [currentFolder];\r\n\r\n        let parentId = currentFolder.parentId;\r\n        while (parentId) {\r\n            const parentFile = fileMap[parentId];\r\n            if (parentFile) {\r\n                folderChain.unshift(parentFile);\r\n                parentId = parentFile.parentId;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return folderChain;\r\n    }, [currentFolderId, fileMap]);\r\n};\r\n\r\nexport const useFiles = <FT extends CustomFileData>(\r\n    fileMap: CustomFileMap<FT>,\r\n    currentFolderId: string\r\n): FileArray<FT> => {\r\n    return useMemo(() => {\r\n        const currentFolder = fileMap[currentFolderId];\r\n        const childrenIds = currentFolder.childrenIds!;\r\n        const files = childrenIds.map((fileId: string) => fileMap[fileId]);\r\n        return files;\r\n    }, [currentFolderId, fileMap]);\r\n};\r\n\r\nexport const useFileMapMethods = <FT extends CustomFileData>(\r\n    baseFileMap: CustomFileMap<FT>,\r\n    initialFolderId: string\r\n) => {\r\n    const [fileMap, setFileMap] = useState(baseFileMap);\r\n    const [currentFolderId, setCurrentFolderId] = useState(initialFolderId);\r\n    const resetFileMap = useCallback(() => {\r\n        setFileMap(baseFileMap);\r\n        setCurrentFolderId(initialFolderId);\r\n    }, [baseFileMap, initialFolderId]);\r\n    const moveFiles = useCallback(\r\n        (files: FT[], source: FT, destination: FT) =>\r\n            setFileMap(currentFileMap => {\r\n                const newFileMap = { ...currentFileMap };\r\n                const moveFileIds = new Set(files.map(f => f.id));\r\n\r\n                // Delete files from their source folder.\r\n                const newSourceChildrenIds = source.childrenIds!.filter(id => !moveFileIds.has(id));\r\n                newFileMap[source.id] = {\r\n                    ...source,\r\n                    childrenIds: newSourceChildrenIds,\r\n                    childrenCount: newSourceChildrenIds.length,\r\n                };\r\n\r\n                // Add the files to their destination folder.\r\n                const newDestinationChildrenIds = [...destination.childrenIds!, ...files.map(f => f.id)];\r\n                newFileMap[destination.id] = {\r\n                    ...destination,\r\n                    childrenIds: newDestinationChildrenIds,\r\n                    childrenCount: newDestinationChildrenIds.length,\r\n                };\r\n\r\n                // Finally, update the parent folder ID on the files from source folder\r\n                // ID to the destination folder ID.\r\n                files.forEach(file => {\r\n                    newFileMap[file.id] = {\r\n                        ...file,\r\n                        parentId: destination.id,\r\n                    };\r\n                });\r\n\r\n                return newFileMap;\r\n            }),\r\n        []\r\n    );\r\n\r\n    const methods = useMemo(\r\n        () => ({\r\n            setFileMap,\r\n            setCurrentFolderId,\r\n            resetFileMap,\r\n            moveFiles,\r\n        }),\r\n        [setFileMap, setCurrentFolderId, resetFileMap, moveFiles]\r\n    );\r\n    return {\r\n        fileMap,\r\n        currentFolderId,\r\n        methods,\r\n    };\r\n};\r\nexport type FileMethods = ReturnType<typeof useFileMapMethods>['methods'];\r\n\r\nexport const useFileActionHandler = (methods: FileMethods) => {\r\n    return useCallback(\r\n        (data: FileActionData<FileAction>) => {\r\n            if (data.id === ChonkyActions.OpenFiles.id) {\r\n                const { targetFile, files } = data.payload;\r\n                const fileToOpen = targetFile ?? files[0];\r\n                if (fileToOpen && FileHelper.isDirectory(fileToOpen)) {\r\n                    methods.setCurrentFolderId(fileToOpen.id);\r\n                }\r\n            } else if (data.id === ChonkyActions.MoveFiles.id) {\r\n                methods.moveFiles(data.payload.files, data.payload.source!, data.payload.destination);\r\n            }\r\n        },\r\n        [methods]\r\n    );\r\n};\r\n\r\nexport const useFileMap = <FT extends CustomFileData = CustomFileData>({\r\n    baseFileMap,\r\n    initialFolderId,\r\n}: FileMapParams<FT>) => {\r\n    const { fileMap, currentFolderId, methods } = useFileMapMethods(baseFileMap, initialFolderId);\r\n    const folderChain = useFolderChain(fileMap, currentFolderId);\r\n    const files = useFiles(fileMap, currentFolderId);\r\n    const fileActionHandler = useFileActionHandler(methods as FileMethods);\r\n\r\n    const data = {\r\n        fileMap,\r\n        currentFolderId,\r\n        folderChain,\r\n        files,\r\n    };\r\n    return { data, methods, fileActionHandler };\r\n};\r\n"],"names":["useDebounce","value","delay","useState","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","UNINITIALIZED_SENTINEL","useStaticValue","factory","valueRef","useRef","current","useInstanceVariable","ref","Logger","error","args","console","warn","debug","formatBullets","bullets","join","FileHelper","isDirectory","file","isDir","isHidden","isSymlink","isEncrypted","isClickable","isOpenable","openable","isSelectable","selectable","isDraggable","draggable","isDroppable","droppable","isDndOpenable","dndOpenable","getModDate","modDate","undefined","parseDate","maybeDate","Date","message","isNaN","getTime","getChildrenCount","childrenCount","sanitizeInputArray","mode","rawArray","sanitizedFiles","errorMessages","Array","isArray","push","nonObjectFileCount","missingFieldFileCount","seenIds","Set","duplicateIds","i","length","item","id","name","has","add","size","repeatedIdsString","from","errorMessageString","arrayString","itemString","sanitizedArray","OptionIds","ShowHiddenFiles","ShowFoldersFirst","DarkMode","SortOrder","selectInstanceId","state","instanceId","selectExternalFileActionHandler","externalFileActionHandler","selectFileActionMap","fileActionMap","selectFileActionIds","fileActionIds","selectFileActionData","fileActionId","selectToolbarItems","toolbarItems","selectContextMenuItems","contextMenuItems","selectFolderChain","folderChain","selectCurrentFolder","currentFolder","selectParentFolder","parentFolder","selectRawFiles","rawFiles","selectFileMap","fileMap","selectCleanFileIds","cleanFileIds","selectFileData","fileId","selectHiddenFileIdMap","hiddenFileIdMap","selectHiddenFileCount","Object","keys","selectFocusSearchInput","focusSearchInput","selectSearchString","searchString","selectSelectionMap","selectionMap","selectSelectedFileIds","selectSelectionSize","selectIsFileSelected","selectSelectedFiles","map","selectSelectedFilesForAction","action","requiresSelection","getSelectedFiles","fileFilter","selectSelectedFilesForActionCount","getSelectedFilesForAction","selectDisableSelection","disableSelection","selectFileViewConfig","fileViewConfig","selectSortActionId","sortActionId","selectSortOrder","sortOrder","selectOptionMap","optionMap","selectOptionValue","optionId","selectThumbnailGenerator","thumbnailGenerator","selectDoubleClickDelay","doubleClickDelay","selectIsDnDDisabled","disableDragAndDrop","selectClearSelectionOnOutsideClick","clearSelectionOnOutsideClick","selectContextMenuMounted","contextMenuMounted","selectContextMenuConfig","contextMenuConfig","selectContextMenuTriggerFile","config","triggerFileId","getFileActionMap","getOptionMap","getFileMap","getFileIds","fileIds","getCleanFileIds","getSortActionId","getSortOrder","getSearchString","_getLastClick","lastClick","makeGetAction","fileActionSelector","createSelector","makeGetOptionValue","defaultValue","makeGetFiles","fileIdsSelector","getSortedFileIds","files","sortAction","showFolderFirst","prepareSortKeySelector","selector","sortFunctions","desc","sortKeySelector","configKeyName","ASC","sortedFileIds","sort","by","getSearcher","cleanFiles","FuzzySearch","caseSensitive","getSearchFilteredFileIds","searcher","search","f","getHiddenFileIdMap","searchFilteredFileIds","showHiddenFiles","searchFilteredFileIdsSet","forEach","getDisplayFileIds","filter","getLastClickIndex","displayFileIds","index","selectors","getFileData","getIsFileSelected","selectedFiles","filters","filteredSelectedFiles","reduce","prevFiles","mergeFileActionsArrays","seenActionIds","addToSeen","a","wasNotSeen","fileActionArrays","duplicateFreeArrays","arr","duplicateFreeArray","concat","thunkUpdateRawFileActions","rawFileActions","disableDefaultFileActions","dispatch","defaultActionsToAdd","disabledActionIds","DefaultFileActions","fileActions","EssentialFileActions","optionDefaults","option","reduxActions","setRawFileActions","setFileActionsErrorMessages","setFileActions","setOptionDefaults","thunkUpdateToolbarNContextMenuItems","excludedToolbarFileActionIds","ChonkyActions","OpenParentFolder","seenToolbarGroups","seenContextMenuGroups","getGroup","itemArray","seenMap","groupName","group","button","toolbar","contextMenu","updateFileActionMenuItems","thunkUpdateDefaultFileViewActionId","getState","setFileViewConfig","thunkActivateSortAction","oldActionId","oldOrder","order","DESC","setSort","actionId","thunkApplySelectionTransform","selectionTransform","prevSelection","hiddenFileIds","newSelection","clearSelection","selectFiles","reset","thunkDispatchFileAction","data","_dispatch","Promise","resolve","thunkRequestFileAction","payload","selectedFilesForAction","contextMenuTriggerFile","actionState","toggleOption","effect","maybeEffectPromise","reduxDispatch","getReduxState","then","effectResult","triggerDispatchAfterEffect","preventDispatch","FileViewMode","ChonkyIconName","defineFileAction","__payloadType","hotkeys","errorMessage","Error","findElementAmongAncestors","maybeElement","predicate","parentElement","elementIsInsideButton","buttonCandidate","element","tagName","toLowerCase","getValueOrFallback","fallback","desiredType","reduxThunks","selectRange","params","fileIdsToSelect","slice","rangeStart","rangeEnd","EssentialActions","MouseClickFile","clickType","OpenFiles","targetFile","ctrlKey","toggleSelection","exclusive","setLastClickIndex","fileDisplayIndex","shiftKey","lastClickIndex","KeyboardClickFile","enterKey","spaceKey","StartDragNDrop","draggedFile","EndDragNDrop","destination","droppedFiles","MoveFiles","ChangeSelection","icon","openParentFolder","iconOnly","OpenFileContextMenu","triggerFile","fileSelected","showContextMenu","mouseX","clientX","mouseY","clientY","DefaultActions","OpenSelection","openFiles","SelectAllFiles","selectAllFiles","ClearSelection","EnableListView","List","entryHeight","list","EnableCompactView","Compact","entryWidth","compact","EnableGridView","Grid","smallThumbnail","SortFilesByName","SortFilesBySize","SortFilesByDate","ToggleHiddenFiles","ToggleShowFoldersFirst","FocusSearchInput","ToggleDarkMode","ExtraActions","CopyFiles","copy","CreateFolder","tooltip","folderCreate","UploadFiles","upload","DownloadFiles","download","DeleteFiles","trash","initialRootState","fileActionsErrorMessages","rawFolderChain","folderChainErrorMessages","filesErrorMessages","searchMode","reducers","setExternalFileActionHandler","setRawFolderChain","setRawFiles","selectedFileId","setSortedFileIds","setHiddenFileIds","setFocusSearchInput","setSearchString","oldValue","setSelectionDisabled","setThumbnailGenerator","setDoubleClickDelay","setDisableDragAndDrop","setClearSelectionOnOutsideClick","setContextMenuMounted","hideContextMenu","createSlice","initialState","actions","rootReducer","reducer","useStoreWatchers","store","selectionWatcher","watch","onSelectionChange","oldSelection","selectedFilesIds","selection","unsubscribeCallbacks","subscribe","unsubscribe","useChonkyStore","chonkyInstanceId","preloadedState","configureStore","middleware","getDefaultMiddleware","serializableCheck","devTools","useParamSelector","parametrizedSelector","selectorParams","useCallback","useSelector","useDTE","actionCreator","useDispatch","usePropReduxUpdate","ChonkyIconPlaceholder","title","React","defaultConfig","onFileAction","disableDragAndDropProvider","defaultSortActionId","defaultFileViewActionId","iconComponent","darkMode","i18n","setChonkyDefaults","key","I18nNamespace","getI18nId","namespace","stringId","getActionI18nId","FileActions","useLocalizedFileActionGroup","intl","useIntl","useMemo","formatMessage","FileActionGroups","defaultMessage","useLocalizedFileActionStrings","buttonName","buttonTooltip","useLocalizedFileEntryStrings","formatters","useContext","ChonkyFormattersContext","fileModDateString","formatFileModDate","fileSizeString","formatFileSize","defaultFormatters","safeModDate","formatDate","dateStyle","timeStyle","_intl","sizeData","filesize","bits","output","symbol","Math","round","createContext","ChonkyIconContext","VideoExtensions","ImageExtensions","AudioExtensions","ColorsLight","ColorsDark","getIconTrie","colourIndex","step","IconsToExtensions","license","model","database","text","archive","image","video","code","info","lock","music","terminal","users","linux","ubuntu","windows","rust","python","nodejs","php","git","adobe","pdf","excel","word","flash","exactTrie","ExactTrie","ignoreCase","pair","extensions","colorCode","iconData","put","iconTrie","useIconData","loading","folder","match","getWithCheckpoints","lightTheme","colors","debugRed","debugBlue","debugGreen","debugPurple","debugYellow","textActive","fontSizes","rootPrimary","margins","rootLayoutMargin","lineHeight","fontSize","buttonRadius","dnd","canDropColor","cannotDropColor","canDropMask","cannotDropMask","fileListCanDropMaskOne","fileListCanDropMaskTwo","fileListCannotDropMaskOne","fileListCannotDropMaskTwo","dragLayer","border","padding","borderRadius","fileList","desktopGridGutter","mobileGridGutter","gridFileEntry","childrenCountSize","iconColorFocused","iconSize","iconColor","fileColorTint","folderBackColorTint","folderFrontColorTint","listFileEntry","propertyFontSize","iconFontSize","iconBorderRadius","darkThemeOverride","mobileThemeOverride","useIsMobileBreakpoint","useMediaQuery","getStripeGradient","colorOne","colorTwo","makeLocalChonkyStyles","styles","createUseStyles","makeGlobalChonkyStyles","makeStyles","selectorMapping","makeGlobalStyles","theme","localStyles","globalStyles","localSelectors","localSelector","globalSelector","jssSelector","useStyles","classes","important","c","classnames","useFileBrowserHandle","useStore","useImperativeHandle","getFileSelection","selectionSet","setFileSelection","requestFileAction","ChonkyBusinessLogicInner","memo","forwardRef","props","displayName","ChonkyBusinessLogic","useDndContextAvailable","dndContext","DndContext","dragDropManager","useDragIfAvailable","dndContextAvailable","mockHook","useHook","useDrag","useDropIfAvailable","useDrop","findClosestChonkyFileId","fileEntryWrapperDiv","dataset","chonkyFileId","useContextMenuTrigger","contextMenuMountedRef","event","altKey","preventDefault","target","useContextMenuDismisser","ChonkyDndFileEntryType","layerStyles","position","pointerEvents","zIndex","left","top","width","height","getItemStyles","initialCursorOffset","initialFileOffset","currentFileOffset","display","x","y","transform","WebkitTransform","DnDFileListDragLayer","useDragLayer","monitor","getItem","itemType","getItemType","getInitialClientOffset","getInitialSourceClientOffset","getSourceClientOffset","isDragging","selectionSize","style","className","fileDragPreview","boxShadow","palette","divider","backgroundColor","background","color","primary","HotkeyListener","fileAction","hotkeysStr","hotkeyCallback","unbind","ChonkyPresentationLayer","children","dndDisabled","handleClickAway","hotkeyListenerComponents","ClickAwayListener","onClickAway","Box","chonkyRoot","onContextMenu","paper","touchAction","fontFamily","flexDirection","boxSizing","textAlign","webkitTouchCallout","webkitUserSelect","mozUserSelect","msUserSelect","userSelect","FileBrowser","shortid","generate","isMobileBreakpoint","muiTheme","createTheme","combinedTheme","merge","chonkyComps","IntlProvider","locale","defaultLocale","Provider","ReduxProvider","ThemeProvider","StyledEngineProvider","injectFirst","MuiThemeProvider","DndProvider","backend","HTML5Backend","useFolderChainItems","folderChainItems","items","disabled","onClick","useFileDrag","fileRef","getDndStartPayload","reduxState","sourceInstanceId","source","canDrag","onDragStart","type","onDragEnd","dropResult","getDropResult","dropTarget","dropEffect","collect","begin","end","dndIsDragging","drag","preview","getEmptyImage","captureDraggingState","useFileDrop","forceDisableDrop","includeChildrenDrops","folderChainRef","onDrop","_item","canDrop","customDropResult","isOver","shallow","prohibitedFileIds","movedFiles","currFile","isOverCurrent","accept","drop","dndIsOver","dndIsOverCurrent","dndCanDrop","useFileEntryDnD","dndState","useDndHoverOpen","currentFolderRef","timeout","getRandomInt","min","max","floor","random","TextPlaceholder","minLength","maxLength","placeholderLength","whitespace","repeat","textPlaceholder","dangerouslySetInnerHTML","__html","opacity","animationName","animationIterationCount","animationTimingFunction","animationDuration","whiteSpace","overflow","maxWidth","minWidth","useFileEntryHtmlProps","dataProps","role","useFileEntryState","selected","focused","useThumbnailUrl","thumbnailUrl","thumbnailLoading","fileColor","iconSpin","useDndIcon","dndIconName","showDropIcon","dndCannotDrop","dndDragging","useModifierIconComponents","modifierIcons","hidden","symlink","ChonkyIcon","modifierIconComponents","_extname","fileName","parts","split","useFileNameComponent","extension","ext","substr","setThumbnailUrl","setThumbnailLoading","loadingAttempts","loadingCancelled","useFileClickHandlers","displayIndex","onMouseClick","onKeyboardClick","onSingleClick","onDoubleClick","CustomVisibilityState","useFileActionTrigger","useFileActionProps","optionValue","actionSelectionSize","actionSelectionEmpty","active","sortAsc","sortDesc","placeholder","toggleOn","toggleOff","isSortButtonAndCurrentSort","isFileViewButtonAndCurrentView","isOptionAndEnabled","customDisabled","customActive","customVisibility","Disabled","Active","ToolbarButton","externalClassName","dropdown","iconWithText","fallbackIcon","fixedWidth","baseButton","iconOnlyButton","activeButton","Button","iconDropdown","textTransform","letterSpacing","paddingBottom","paddingTop","marginRight","marginLeft","marginTop","SmartToolbarButton","triggerAction","Hidden","FolderChainButton","first","baseBreadcrumb","disabledBreadcrumb","currentBreadcrumb","folderChainIcon","buttonContainer","dndIndicator","textDecoration","FileNavbar","folderChainComponents","components","component","navbarWrapper","navbarContainer","Breadcrumbs","navbarBreadcrumbs","separator","upDirectoryButton","flexGrow","ToolbarDropdownButton","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","minHeight","SmartToolbarDropdownButton","onClickFollowUp","handleClick","ToolbarDropdown","anchor","setAnchor","currentTarget","handleClose","menuItemComponents","localizedName","Menu","autoFocus","keepMounted","elevation","anchorEl","onClose","open","Boolean","transitionDuration","dropdownList","ToolbarInfo","hiddenCount","fileCountString","Toolbar","fileCount","selectedString","hiddenString","infoContainer","Typography","infoText","variant","extraInfoSpan","selectionSizeText","hiddenCountText","ToolbarSearch","searchPlaceholderString","searchInputRef","reduxSearchString","localSearchString","setLocalSearchString","debouncedLocalSearchString","showLoadingIndicator","setShowLoadingIndicator","focus","handleChange","handleKeyUp","blur","TextField","searchFieldContainer","onChange","inputRef","InputProps","onKeyUp","startAdornment","InputAdornment","searchIcon","spin","searchFieldInput","inputProps","searchFieldInputInner","margin","paddingLeft","FileToolbar","toolbarItemComponents","toolbarWrapper","toolbarContainer","toolbarLeft","toolbarRight","flexWrap","toolbarLeftFiller","FileListEmpty","emptyString","FileList","fileListEmpty","fileListEmptyContent","folderOpen","useClickHandler","counter","clickCount","clickTimeout","mouseClickEvent","metaKey","useKeyDownHandler","keyboardClickEvent","nativeEvent","stopPropagation","ClickableWrapper","WrapperTag","wrapperTag","passthroughProps","setFocused","handleKeyDown","compProps","onFocus","onBlur","onKeyDown","tabIndex","mergedProps","FileEntryName","fileNameComponent","paddingRight","CompactEntry","entryState","fileEntryHtmlProps","listFileEntryIcon","listFileEntryDescription","listFileEntryName","listFileEntryProperties","listFileEntryProperty","alignItems","DnDFileEntry","fillParent","FileThumbnail","thumbnailStyle","backgroundImage","fileThumbnail","backgroundRepeat","backgroundPosition","backgroundSize","GridEntryDndIndicator","borderBottom","borderLeft","content","GridEntryPreviewFolder","folderClasses","useFolderStyles","fileClasses","useFileStyles","commonClasses","useCommonEntryStyles","previewFile","folderBackSideMid","folderBackSideTop","folderFrontSide","fileIcon","selectionIndicator","thumbnail","borderTopLeftRadius","borderTopRightRadius","right","borderRightColor","borderTopColor","borderBottomColor","borderLeftColor","borderWidth","borderStyle","bottom","shadows","GridEntryPreviewFile","focusIndicator","GridEntry","useFileEntryStyles","entryClassName","gridFileEntryPreview","gridFileEntryNameContainer","gridFileEntryName","wordBreak","ListEntry","styleState","listFileEntrySelection","textOverflow","flex","disabledDndState","SmartFileEntry","fileViewMode","fileClickHandlers","clickableWrapperProps","fileEntryClickableWrapper","fileEntryProps","EntryComponent","outline","isMobileDevice","window","orientation","navigator","userAgent","indexOf","getGridConfig","viewConfig","gutter","scrollbar","columnCount","columnWidth","rowCount","ceil","rowHeight","GridContainer","gridRef","gridConfig","setGridConfig","gridConfigRef","oldConf","newConf","resetAfterRowIndex","resetAfterColumnIndex","resetAfterIndices","columnIndex","rowIndex","sizers","gc","getColumnWidth","getRowHeight","displayFileIdsRef","getItemKey","cellRenderer","styleWithGutter","gridComponent","VariableSizeGrid","gridContainer","estimatedRowHeight","estimatedColumnWidth","itemKey","ListContainer","listRef","listComponent","rowRenderer","FixedSizeList","listContainer","itemSize","itemCount","borderTop","localClasses","useLocalStyles","onScroll","fillParentContainer","listRenderer","fileListWrapper","dndDropZone","dndDropZoneIcon","AutoSizer","disableHeight","maxHeight","FileContextMenu","browserMenuShortcutString","shortcut","contextMenuItemComponents","anchorPosition","disablePortal","anchorReference","contextMenuList","ListSubheader","browserMenuTooltip","FullFileBrowser","useFolderChain","currentFolderId","parentId","parentFile","unshift","useFiles","childrenIds","useFileMapMethods","baseFileMap","initialFolderId","setFileMap","setCurrentFolderId","resetFileMap","moveFiles","currentFileMap","newFileMap","moveFileIds","newSourceChildrenIds","newDestinationChildrenIds","methods","useFileActionHandler","fileToOpen","useFileMap","fileActionHandler"],"mappings":"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"}